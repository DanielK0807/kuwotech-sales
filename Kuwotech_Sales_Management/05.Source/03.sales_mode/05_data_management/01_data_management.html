<!DOCTYPE html>
<html lang="ko" data-mode="sales">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>데이터 관리 - KUWOTECH 영업관리 시스템</title>
    
    <!-- 스타일시트 -->
    <link rel="stylesheet" href="../../07.styles/01_variables.css">
    <link rel="stylesheet" href="../../07.styles/02_common.css">
    <link rel="stylesheet" href="../../07.styles/03_glassmorphism.css">
    <link rel="stylesheet" href="../../07.styles/06_mode_themes.css">
    <link rel="stylesheet" href="../../07.styles/07_theme_colors.css">
    
    <!-- 강화된 3D 글래스모피즘 스타일 -->
    <style>
        /* 3D 뷰포트 설정 */
        body {
            perspective: 1500px;
            perspective-origin: 50% 50%;
            transform-style: preserve-3d;
            background: linear-gradient(135deg, #0F2A1D 0%, #375534 100%);
            min-height: 100vh;
            padding: 20px;
        }
    </style>
    
    <!-- 파비콘 -->
    <link rel="icon" type="image/png" href="../../../02.Fonts_Logos/logo.png">
</head>
<body class="theme-sales">
    <!-- 메인 컨테이너 -->
    <div class="main-container data-main-container">

        <!-- 페이지 헤더 -->
        <div class="page-header data-page-header">
            <h2 class="page-title data-page-title">💾 데이터 관리</h2>
            <p class="page-description data-page-description">내 거래처, 보고서, KPI 데이터를 다운로드하고 백업합니다.</p>
        </div>
        
        <!-- 다운로드 섹션 -->
        <div class="download-section data-section">
            <h3 class="section-title data-section-title">📥 데이터 다운로드</h3>

            <div class="download-grid data-download-grid">
                <!-- 내 거래처 다운로드 -->
                <div class="download-card data-download-card">
                    <!-- 홀로그래픽 효과 -->
                    <div class="data-holographic-effect"></div>
                    <div class="card-icon data-card-icon">🏢</div>
                    <h4 class="card-title data-card-title">내 거래처</h4>
                    <p class="card-description data-card-description">
                        담당 거래처 정보를 엑셀 파일로 다운로드합니다.
                    </p>
                    <div class="card-info data-card-info">
                        <div class="info-item data-info-item">
                            <span class="info-label data-info-label">거래처 수:</span>
                            <span class="info-value data-info-value" id="companyCount">0개</span>
                        </div>
                        <div class="info-item data-info-item">
                            <span class="info-label data-info-label">최근 업데이트:</span>
                            <span class="info-value data-info-value" id="companyUpdate">-</span>
                        </div>
                    </div>
                    <button onclick="downloadCompanies()" class="data-download-btn">
                        <span>📥 다운로드</span>
                    </button>
                </div>
                
                <!-- 보고서 다운로드 -->
                <div class="download-card data-download-card">
                    <!-- 홀로그래픽 효과 -->
                    <div class="data-holographic-effect" style="animation-delay: 0.5s;"></div>
                    <div class="card-icon data-card-icon">📋</div>
                    <h4 class="card-title data-card-title">실적보고서</h4>
                    <p class="card-description data-card-description">
                        작성한 실적보고서를 엑셀 파일로 다운로드합니다.
                    </p>
                    <div class="card-info data-card-info">
                        <div class="info-item data-info-item">
                            <span class="info-label data-info-label">보고서 수:</span>
                            <span class="info-value data-info-value" id="reportCount">0개</span>
                        </div>
                        <div class="info-item data-info-item">
                            <span class="info-label data-info-label">기간:</span>
                            <select id="reportPeriod" class="data-period-select">
                                <option value="1">최근 1개월</option>
                                <option value="3">최근 3개월</option>
                                <option value="6">최근 6개월</option>
                                <option value="12">최근 1년</option>
                                <option value="all">전체</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="downloadReports()" class="data-download-btn">
                        <span>📥 다운로드</span>
                    </button>
                </div>
                
                <!-- KPI 다운로드 -->
                <div class="download-card data-download-card" style="transform: translateZ(40px) rotateX(1deg) rotateY(1deg);">
                    <!-- 홀로그래픽 효과 -->
                    <div class="data-holographic-effect" style="animation-delay: 1s;"></div>
                    <div class="card-icon data-card-icon">📊</div>
                    <h4 class="card-title data-card-title">KPI 현황</h4>
                    <p class="card-description data-card-description">
                        개인 KPI 현황을 엑셀 파일로 다운로드합니다.
                    </p>
                    <div class="card-info data-card-info">
                        <div class="info-item data-info-item">
                            <span class="info-label data-info-label">KPI 지표:</span>
                            <span class="info-value data-info-value">14개</span>
                        </div>
                        <div class="info-item data-info-item">
                            <span class="info-label data-info-label">계산 기준:</span>
                            <span class="info-value data-info-value" id="kpiDate">-</span>
                        </div>
                    </div>
                    <button onclick="downloadKPI()" class="data-download-btn">
                        <span>📥 다운로드</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 백업 섹션 -->
        <div class="backup-section data-section">
            <h3 class="section-title data-section-title">💼 데이터 백업</h3>

            <div class="data-backup-container">
                <div class="backup-info data-backup-info">
                    <h4 class="data-backup-title">전체 데이터 백업</h4>
                    <p class="data-backup-description">
                        모든 거래처, 보고서, KPI 데이터를 하나의 엑셀 파일로 백업합니다.
                    </p>
                    <div class="data-backup-stats">
                        <div class="data-backup-stat-box">
                            <span class="data-backup-stat-label">마지막 백업:</span>
                            <span id="lastBackup" class="data-backup-stat-value">없음</span>
                        </div>
                        <div class="data-backup-stat-box">
                            <span class="data-backup-stat-label">백업 크기:</span>
                            <span id="backupSize" class="data-backup-stat-value">-</span>
                        </div>
                    </div>
                    <button onclick="createBackup()" class="data-backup-btn">
                        <span>💾 전체 백업 생성</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 다운로드 이력 -->
        <div class="history-section">
            <h3 class="section-title data-section-title">📜 다운로드 이력</h3>

            <div class="data-history-container">
                <table class="data-history-table">
                    <thead>
                        <tr class="data-history-header-row">
                            <th class="data-history-th">일시</th>
                            <th class="data-history-th">파일명</th>
                            <th class="data-history-th">유형</th>
                            <th class="data-history-th">크기</th>
                            <th class="data-history-th">상태</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <!-- 동적 생성 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- JavaScript 모듈 -->
    <script type="module" src="./02_data_management.js"></script>
    
    <style>
        /* Shimmer Animation */
        @keyframes shimmer-3d {
            0% { transform: translateX(-100%) translateZ(1px); }
            100% { transform: translateX(100%) translateZ(1px); }
        }
        
        /* Card Hover Effects */
        .download-card:hover {
            transform: translateY(-8px) translateZ(60px) rotateX(2deg) rotateY(-2deg) scale(1.02) !important;
            box-shadow:
                0 40px 80px -20px rgba(0, 0, 0, 0.5),
                0 25px 50px -15px rgba(0, 0, 0, 0.4),
                0 15px 30px -10px rgba(0, 0, 0, 0.3),
                0 5px 15px -5px rgba(0, 0, 0, 0.2),
                inset 0 3px 10px rgba(255, 255, 255, 0.4),
                inset 0 -3px 10px rgba(0, 0, 0, 0.2) !important;
        }
        
        /* Button Hover Effects */
        button:hover {
            transform: translateY(-4px) translateZ(30px) scale(1.05) !important;
            box-shadow:
                0 30px 60px -15px rgba(107, 144, 113, 0.6),
                0 15px 30px -10px rgba(107, 144, 113, 0.4),
                inset 0 2px 6px rgba(255, 255, 255, 0.4) !important;
        }
        
        button:active {
            transform: translateY(0) translateZ(10px) scale(0.98) !important;
        }
        
        /* Select Option Styling */
        select option {
            background: #375534;
            color: white;
        }
        
        /* Table Row Hover */
        tbody tr {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        tbody tr:hover {
            background: linear-gradient(
                90deg,
                rgba(107, 144, 113, 0.08),
                rgba(107, 144, 113, 0.05)
            );
            transform: translateX(4px) scale(1.005);
        }
        
        tbody td {
            padding: 10px 12px;
            color: rgba(255, 255, 255, 0.8);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</body>
</html>