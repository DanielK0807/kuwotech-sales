<!-- ========================= [NAVIGATION] ========================= -->
<!-- [SECTIONS] 1. 개발 원칙 | 2. 시스템 구조 | 3. 권한 | 4. KPI | 5. 데이터/보고/동기화 | 6. 화면/형식 | 7. 코드/문서 원칙 -->
<!-- ========================= [END NAVIGATION] ========================= -->

---

# 쿠보텍 영업관리시스템 프로그램 개발기초
<!-- ========================= [NAVIGATION] ========================= -->
<!-- [SECTIONS] 1. 작성 원칙 | 2. 시스템/데이터 구조 | 3. 권한 | 4. KPI/지표 | 5. 동기화/업데이트/백업 | 6. 보고서/실적관리/플로우 | 7. UI/기술/성능/보안 | 8. 운영/업무/주의/최적화 | 9. 문서/코드 원칙 | 10. 시스템 사양서/작성자 정보 -->
<!-- ========================= [END NAVIGATION] ========================= -->

---

<!-- [SECTION] 1. 작성 원칙 -->
## 1. 프로그램/문서 작성 원칙

- 단순/심플, 동일 대시보드, 주요제품 우선순위, 부가세 처리, 무결성, 백업/복구, 에러/로깅, 접근성, 테스트/배포/버전 관리 등
- 네비게이션 주석 규약, 변수명 규칙, 한글 표기, 시각화 원칙

---

<!-- [SECTION] 2. 시스템/데이터 구조 -->
## 2. 시스템/데이터 구조

...existing code...

---

<!-- [SECTION] 3. 권한 -->
## 3. 권한 체계 및 매트릭스

...existing code...

---

<!-- [SECTION] 4. KPI/지표 -->
## 4. KPI/지표/계산/표시 규칙

...existing code...

---

<!-- [SECTION] 5. 동기화/업데이트/백업 -->
## 5. 데이터 동기화/업데이트/백업/복구

...existing code...

---

<!-- [SECTION] 6. 보고서/실적관리/플로우 -->
## 6. 보고서/실적관리/플로우/예시

...existing code...

---

<!-- [SECTION] 7. UI/기술/성능/보안 -->
## 7. UI/기술 구현/성능/보안

...existing code...

---

<!-- [SECTION] 8. 운영/업무/주의/최적화 -->
## 8. 시스템 운영/업무/주의/최적화

...existing code...

---

<!-- [SECTION] 9. 문서/코드 원칙 -->
## 9. 문서/코드 작성 원칙

...existing code...

---

<!-- [SECTION] 10. 시스템 사양서/작성자 정보 -->
## 10. 시스템 사양서/작성자 정보/버전

...existing code...

---

<!-- [SECTION] 2. 시스템 구조 및 데이터 흐름 -->

## 2. 시스템 구조 및 데이터 흐름

- 폴더/파일 구조, DB 구조(IndexedDB), 엑셀 시트(기본정보/입사일자/제품코드/거래처등급)
- 모드 구분(영업담당/관리자), 권한 매트릭스, 주요 컬럼/권한 표

---

<!-- [SECTION] 3. 권한 체계 -->

## 3. 권한 체계

- 관리자/영업담당 권한 상세, 접근/수정/승인/업로드/다운로드/통계 범위
- 권한별 데이터 접근 매트릭스

---

<!-- [SECTION] 4. KPI 및 실적관리 -->

## 4. KPI 및 실적관리

- KPI 지표(영업담당/관리자), 계산식/표시 예시, 3단계 우선순위, 현재월수 계산
- 실적관리 테이블(영업/관리자), 보고서 플로우 다이어그램

---

<!-- [SECTION] 5. 데이터 동기화/보고서/자동업데이트 -->

## 5. 데이터 동기화/보고서/자동업데이트

- 엑셀↔DB 동기화, 업로드/파싱/충돌/업데이트 전략, 자동 계산 트리거
- 보고서 작성/확인/실적 반영, 금주보고서 폼/확인 폼/상세 모달/실적관리 목록
- 자동업데이트 컬럼/로직, 잔액 관리, 데이터 무결성/검증/에러 처리

---

<!-- [SECTION] 6. 화면/표시/UX 설계 -->

## 6. 화면/표시/UX 설계

- UI/UX(글래스모피즘, 반응형), 네비게이션/사이드바/대시보드/모달
- 숫자/음수/달성률 표시 규칙, 입력 자동 포맷팅, 용어집/약어

---

<!-- [SECTION] 7. 코드/문서 작성 원칙 -->

## 7. 코드/문서 작성 원칙

- 변수/상수/클래스/파일명 규칙, 함수/로직/에러/보안 주석
- 문서 구조화/상호참조/시각화, 품질 게이트/릴리스 체크, 검증/테스트/보안/성능

---

<!-- [SECTION] 8. 개선된 금주보고서 시스템 설계 -->

## 8. 개선된 금주보고서 시스템 설계

- 폼/입력/확인/실적관리/상세 모달/파일 구조/데이터 구조/검증/권한/보안/성능

---

<!-- [SECTION] 9. 작성자 정보 및 버전 -->

## 9. 작성자 정보 및 버전

- 작성일, 버전, 작성자, 문서 위치, 최종 수정 내역

---

### [적용 방법 안내]

- 각 섹션의 중복 표/코드/예시/설명은 하나로 통합(예: KPI 표, 권한 표, 보고서 폼 등)
- 네비게이션 주석(`<!-- [SECTION] ... -->`)을 각 주요 섹션 시작에 추가
- 마크다운 문법(헤딩, 표, 코드블록, 리스트, 빈줄 등) 준수
- 삭제는 "완전 중복"만, 내용 손실 없이 통합/정리
- 실제 적용 시, 위 목차대로 파일을 재구성하고, 각 섹션의 대표 내용만 남기세요

---

이 구조대로 파일을 재작성하면, 중복 없이 논리적 순서와 네비게이션 주석, 문법까지 모두 만족합니다.
❌ 거래처명(ERP), 매출채권잔액 수정 불가
❌ 전사 통계 접근 불가

```text

---

### 기본정보 시트 컬럼 정의 및 권한 (19개)

| 순번 | 컬럼명 | 내부 필드명 | 관리자 | 영업담당 | 자동업데이트 | 설명 |
|------|--------|-------------|--------|----------|--------------|------|
| 1 | NO | no | ❌ | ❌ | - | 순번 (시스템 표시 안함) |
| 2 | **KEY VALUE** | keyValue | ❌ | ❌ | - | 고유 식별자 (변경 불가) |
| 4 | 최종거래처명 | finalCompanyName | ✅ | ✅ | - | 모두 수정 가능 |
| 5 | 폐업여부 | isClosed | ✅ | ✅ | - | Y/N, 모두 수정 가능 |
| 6 | 대표이사 또는 치과의사 | ceoOrDentist | ✅ | ✅ | - | 모두 수정 가능 |
| 7 | 고객사 지역 | customerRegion | ✅ | ✅ | - | 모두 수정 가능 |
| 8 | 거래상태 | businessStatus | ✅ | ✅ | - | 활성/비활성/불용/추가확인 |
| 9 | 담당부서 | department | ✅ | ✅ | - | 모두 수정 가능 |
| 10 | **판매제품** | salesProduct | - | - | ✅ | 보고서 확인 시 자동 추가 |
| 11 | 내부담당자 | internalManager | ✅ | ✅ | - | 모두 수정 가능 |
| 12 | 정철웅기여(상.중.하) | jcwContribution | ✅ | ✅ | - | 모두 수정 가능 |
| 13 | 회사기여(상.중.하) | companyContribution | ✅ | ✅ | - | 모두 수정 가능 |
| 14 | **마지막결제일** | lastPaymentDate | - | - | ✅ | 보고서 확인 시 자동 갱신 |
| 15 | **마지막총결재금액** | lastPaymentAmount | - | - | ✅ | 보고서 확인 시 자동 갱신 |
| 16 | 매출채권잔액 | accountsReceivable | ✅ | ❌ | - | 관리자만 수정 (월말 일괄) |
| 17 | **누적수금금액** | accumulatedCollection | - | - | ✅ | 보고서 확인 시 자동 합산 |
| 18 | **누적매출금액** | accumulatedSales | - | - | ✅ | 보고서 확인 시 자동 합산 |
| 19 | **영업활동(특이사항)** | businessActivity | - | ✅ | ✅ | 보고서 작성/확인 시 추가 |

<!-- ===== [SECTION] 📊 KPI 지표 시스템 ===== -->
## 📊 KPI 지표 시스템

### 영업담당 모드 KPI (14개)

#### 거래처 관리 지표 (4개)

1. **담당거래처**: COUNT WHERE 내부담당자=본인 AND 거래상태≠'불용'
2. **활성거래처**: COUNT WHERE 거래상태='활성'>0
3. **활성화율**: (활성거래처/담당거래처) × 100
4. **주요제품판매거래처**: 3단계 우선순위 계산 (임플란트→지르코니아→Abutment)

#### 목표 달성 지표 (2개)

1. **회사배정기준대비 달성율**: ((담당거래처/80) - 1) × 100
2. **주요고객처목표달성율**: ((주요제품거래처/40)-1) × 100

#### 매출 성과 지표 (3개)

1. **누적매출금액**: SUM(누적매출금액) WHERE 내부담당자=본인
2. **주요제품매출액**: SUM(누적매출금액) WHERE 주요제품
3. **매출집중도**: (누적매출/담당거래처)/현재월수

#### 재무 및 기여도 지표 (5개)

1. **누적수금금액**: SUM(누적수금금액) WHERE 내부담당자=본인
2. **매출채권잔액**: SUM(매출채권잔액) WHERE 내부담당자=본인
3. **주요제품매출비율**: (주요제품매출/누적매출) × 100
4. **전체매출기여도**: (개인 누적매출/전사 누적매출) × 100
5. **주요제품매출기여도**: (개인 주요제품매출/전사 주요제품매출) × 100

### 관리자 모드 KPI (14개)

#### 전사 거래처 지표 (4개)

1. **전체거래처**: COUNT WHERE 거래상태≠'불용'
2. **활성거래처**: COUNT WHERE 거래상태='활성'>0
3. **활성화율**: (활성거래처/전체거래처) × 100
4. **주요제품판매거래처**: 3단계 우선순위 계산 (중복제거)

#### 전사 목표 달성 (2개)

1. **회사배정기준대비 달성율**: ((전체거래처/(80×영업담당인원수)) - 1) × 100
2. **주요고객처목표달성율**: ((주요제품거래처/(40×영업담당인원수))-1) × 100

#### 전사 매출 지표 (5개)

1. **누적매출금액**: SUM(누적매출금액) 전체
2. **누적수금금액**: SUM(누적수금금액) 전체
3. **매출채권잔액**: SUM(매출채권잔액) 전체
4. **주요제품매출액**: SUM(누적매출금액) WHERE 주요제품
5. **매출집중도**: (누적매출/전체거래처)/현재월수

#### 전사 기여도 지표 (3개)

1. **주요제품 매출비율**: (전사 주요제품매출/전사 누적매출) × 100
2. **전체매출기여도**: 클릭시 별도창에서 상세내역을 확인할 수 있습니다. (영업사원별 순위)
3. **주요제품매출기여도**: 클릭시 별도창에서 상세내역을 확인할 수 있습니다. (영업사원별 순위)

### 📌 현재월수 계산 규칙

- **1년 이상 근무자**: 올해 1월 1일 ~ 현재까지 개월 수
- **1년 미만 근무자**: 입사일 ~ 현재까지 개월 수
- **관리자**: 전사 기준 현재월수 (1-12월)

### 📌 주요제품 3단계 우선순위 계산

1. **1단계**: 임플란트 취급 거래처 우선
2. **2단계**: 1단계 제외 후 지르코니아 취급 거래처
3. **3단계**: 1,2단계 제외 후 Abutment만 취급 거래처

※ 중복 제거: 한 거래처가 여러 제품 취급해도 1회만 카운트

---

<!-- ===== [SECTION] 🔄 데이터 플로우 ===== -->
## 🔄 데이터 플로우

### 1. 엑셀 ↔ IndexedDB 동기화

```text
초기 로딩: 엑셀 → IndexedDB (시스템 시작시)
일상 업무: IndexedDB에서 직접 CRUD
월말 정리: IndexedDB → 엑셀 다운로드
ERP 연동: 엑셀 수정 → 재업로드 (강정환만)
```text

#### 엑셀 업로드 프로세스 상세

1. **파일 검증**

   - 파일 형식: .xlsx, .xls만 허용
   - 파일 크기: 최대 10MB
   - 시트 존재 확인: '기본정보', '입사일자' 필수

1. **데이터 파싱**

   - KEY VALUE 무결성 체크
   - 필수 필드 존재 확인
   - 데이터 타입 검증

1. **충돌 해결**

   - KEY VALUE 기준 매칭
   - 타임스탬프 비교
   - 관리자 우선순위 적용

1. **업데이트 전략**

   - 신규: INSERT
   - 변경: UPDATE (변경 이력 저장)
   - 삭제: 소프트 삭제 (deleted_at 플래그)

### 2. 실시간 자동 계산 트리거

- 엑셀 업로드 시점
- 보고서 확인 시점
- 데이터 수정 시점
- 영업활동 입력 시점

### 3. 자동 업데이트되는 19개 컬럼 상세 규칙

보고서 확인시 자동 업데이트:

- **판매제품**:
  - 기존 제품 + 새 제품 (콤마로 구분)
  - 중복 제품명 제거
  - 최대 10개 제품까지 표시

- **마지막결제일**:
  - 보고서 승인 날짜로 자동 갱신
  - 형식: YYYY-MM-DD

- **마지막총결재금액**:
  - 관리자가 입력한 최종 매출금액
  - 부가세 포함 금액 기준

- **누적수금금액**:
  - 기존값 + 최종수금금액
  - 음수 불허 (검증 필요)

- **누적매출금액**:
  - 부가세 포함 선택: 기존값 + (입력값 ÷ 1.1)
  - 부가세 제외 선택: 기존값 + 입력값

- **영업활동(특이사항)**:
  - 기존 내용 + "[날짜] " + 새 활동 내용
  - 최대 1000자 제한
  - 15자 이상 필수 (관리자 확인시)

### 4. 부가세 처리 규칙

- **포함 선택**: 누적매출 = 입력값 ÷ 1.1
- **제외 선택**: 누적매출 = 입력값
- **수금금액**: 부가세 무관 입력값 그대로

---

## 🔄 엑셀-데이터베이스 동기화 체계

### 1. 데이터 흐름 순서도

```mermaid
graph TD
    A[엑셀 업로드<br/>담당: 강정환] -->|파일 검증| B[데이터 파싱]
    B -->|KEY VALUE 기준| C[IndexedDB 저장]
    
    C --> D[영업담당 작업]
    C --> E[관리자 작업]
    
    D -->|본인 거래처만| F[데이터 수정<br/>영업활동 입력]
    E -->|전체 거래처| G[데이터 수정<br/>매출채권 관리]
    
    F --> H[보고서 작성]
    G --> H
    
    H --> I[보고서 확인<br/>담당: 관리자]
    I -->|자동 업데이트| J[6개 컬럼 갱신]
    
    J --> K[변경이력 저장]
    K --> L[엑셀 다운로드]
    
    L -->|영업담당| M[본인 데이터만]
    L -->|관리자| N[전체 데이터]
    
    N -->|월 1회| O[ERP 대조<br/>담당: 강정환]
    O -->|수정 후| A
```text

### 2. 권한별 데이터 접근 매트릭스

| 작업 | 강정환 | 관리자 | 영업담당 | 자동시스템 |
|------|--------|--------|----------|------------|
| **엑셀 업로드** | ✅ | ❌ | ❌ | - |
| **거래처명(ERP) 수정** | ✅ | ✅ | ❌ | - |
| **매출채권잔액 수정** | ✅ | ✅ | ❌ | - |
| **영업활동 수정** | ❌ | ❌ | ✅ | ✅ |
| **보고서 승인** | ✅ | ✅ | ❌ | - |
| **판매제품 갱신** | - | - | - | ✅ |
| **누적금액 합산** | - | - | - | ✅ |
| **전체 다운로드** | ✅ | ✅ | ❌ | - |
| **본인 다운로드** | - | - | ✅ | - |

### 3. 데이터 동기화 시나리오

#### 시나리오 1: 초기 업로드

```text
1. 강정환: 엑셀 파일 준비 (기본정보 + 입사일자 시트)
2. 시스템: 파일 검증 → KEY VALUE 무결성 체크
3. IndexedDB: 초기 데이터 저장
4. 결과: 영업담당/관리자 모두 접근 가능

```text


#### 시나리오 2: 일상 업무 (영업담당)

```text

1. 영업담당: 로그인 → 본인 거래처만 조회
2. 데이터 수정: 영업활동(특이사항) 입력
3. 보고서 작성: 목표수금/매출/활동 입력
4. IndexedDB: 실시간 저장
5. 변경이력: 자동 기록 (누가, 언제, 무엇을)

[보고서 확인 화면]
```text

#### 시나리오 3: 보고서 확인 (관리자)

```text

1. 관리자: 미확인 보고서 조회
2. 최종값 입력: 수금/매출 금액 확인
3. 자동 업데이트:
   - 판매제품 추가
   - 마지막결제일/금액 갱신
   - 누적금액 합산
   - 영업활동 상태 기록
4. IndexedDB: 6개 컬럼 자동 갱신

[보고서 확인 화면]
```text

#### 시나리오 4: 월말 정산 (강정환)

```text
1. 전체 데이터 다운로드 (4개 시트)
   - 기본정보 (수정된 데이터)
   - 입사일자 (원본)
   - 변경내역 (신규)
   - 보고서 (신규)
2. ERP 시스템과 대조
3. 불일치 수정:
   - 매출채권잔액 갱신
   - 거래처명(ERP) 수정
4. 수정 파일 재업로드
5. 충돌 해결: KEY VALUE 기준 병합
[보고서 확인 화면]
```text

### 4. 데이터 충돌 해결 전략

```javascript
// 재업로드 시 충돌 해결 로직
function resolveConflict(excelData, dbData) {
  // ERP 필드: 엑셀 우선 (덮어쓰기)
  if (field === '거래처명(ERP)' || field === '매출채권잔액') {
    return excelData[field];
  }
  
  // 사용자 입력 필드: DB 우선 (보존)
  if (field === '영업활동(특이사항)') {
    return dbData[field];
  }
  
  // 자동 업데이트 필드: DB 우선 (보존)
  if (autoUpdateFields.includes(field)) {
    return dbData[field];
  }
  
  // 타임스탬프 비교
  return excelData.timestamp > dbData.timestamp ? 
         excelData[field] : dbData[field];
}
```text

### 5. 백업 및 복구 체계

#### 자동 백업

```text
일일 백업:
- 시간: 매일 새벽 02:00
- 대상: IndexedDB 전체
- 형식: JSON + 엑셀
- 보관: 30일
- 위치: backup/YYYY-MM-DD/
```text

#### 수동 백업

```text
즉시 백업:
- 권한: 관리자
- 시점: 중요 변경 전
- 내용: 전체 스냅샷
- 복구: 1-Click 복원
```text

#### 변경 이력 추적

```javascript
changeHistory: {
  id: 'CH_20250918_001',
  timestamp: '2025-09-18T10:30:00',
  userId: 'sales01',
  userName: '김영업',
  action: 'UPDATE',
  tableName: 'companies',
  recordId: 'KEY001',
  fieldName: '영업활동(특이사항)',
  oldValue: '기존 내용',
  newValue: '기존 내용\n[2025-09-18] 신규 활동',
  ipAddress: '192.168.1.100',
  userAgent: 'Chrome/128.0'
}
```text

### 6. 데이터 무결성 보장

#### 트랜잭션 처리

```javascript
// IndexedDB 트랜잭션
async function updateCompanyData(keyValue, updates) {
  const tx = db.transaction(['companies', 'changeHistory'], 'readwrite');
  
  try {
    // 1. 기존 데이터 조회
    const company = await tx.objectStore('companies').get(keyValue);
    
    // 2. 권한 체크
    if (!checkPermission(currentUser, company, updates)) {
      throw new Error('권한 없음');
    }
    
    // 3. 데이터 업데이트
    const updated = { ...company, ...updates, updatedAt: new Date() };
    await tx.objectStore('companies').put(updated);
    
    // 4. 변경 이력 저장
    await tx.objectStore('changeHistory').add({
      ...createChangeLog(company, updated)
    });
    
    // 5. 커밋
    await tx.complete;
    
  } catch (error) {
    // 6. 롤백 (자동)
    console.error('트랜잭션 실패:', error);
    throw error;
  }
}
```text

#### 데이터 검증 규칙

```javascript
const validationRules = {
  // KEY VALUE: 불변
  keyValue: {
    editable: false,
    unique: true,
    required: true,
    pattern: /^KEY\d{3,}$/
  },
  
  // 거래처명(ERP): 관리자만
  companyNameERP: {
    editable: ['admin'],
    required: true,
    maxLength: 100
  },
  
  // 영업활동: 영업담당만
  businessActivity: {
    editable: ['sales'],
    maxLength: 5000,
    autoAppend: true
  },
  
  // 금액: 숫자만
  accountReceivable: {
    editable: ['admin'],
    type: 'number',
    min: 0,
    format: 'integer'
  }
};
```text

### 7. 성능 최적화 전략

#### 인덱싱 전략

```javascript
// IndexedDB 인덱스 설정
db.version(1).stores({
  companies: '&keyValue, internalManager, businessStatus, *salesProduct',
  reports: '++id, keyValue, status, createdDate, internalManager',
  changeHistory: '++id, timestamp, userId, tableName, recordId'
});
```text

#### 캐싱 전략

```javascript
const cache = {
  // KPI 캐시: 5분
  kpi: new Map(),
  kpiTTL: 5 * 60 * 1000,
  
  // 거래처 목록: 변경 시까지
  companies: null,
  companiesVersion: 0,
  
  // 직원 목록: 세션 유지
  employees: sessionStorage.getItem('employees'),
  
  invalidate(type) {
    if (type === 'kpi') this.kpi.clear();
    if (type === 'companies') this.companiesVersion++;
  }
};
```text

### 8. 오류 처리 및 복구

#### 업로드 실패 처리

```javascript
function handleUploadError(error, file) {
  const recovery = {
    'FILE_TOO_LARGE': '파일 크기를 10MB 이하로 줄여주세요',
    'INVALID_FORMAT': '엑셀 파일(.xlsx, .xls)만 가능합니다',
    'MISSING_SHEET': '기본정보, 입사일자 시트를 확인하세요',
    'DUPLICATE_KEY': `중복 KEY VALUE: ${error.duplicates.join(', ')}`,
    'PERMISSION_DENIED': '강정환 관리자만 업로드 가능합니다'
  };
  
  return recovery[error.code] || '알 수 없는 오류';
}
```text

#### 동기화 충돌 알림

```javascript
function notifyConflict(conflicts) {
  const message = `
    동기화 충돌 발생 (${conflicts.length}건)
    
    충돌 항목:
    ${conflicts.map(c => `- ${c.companyName}: ${c.field}`).join('\n')}
    
    해결 방법:
    - 엑셀 우선: ERP 데이터 덮어쓰기
    - DB 우선: 사용자 입력 보존
    - 수동 선택: 개별 확인 필요
  `;
  
  return confirm(message) ? 'auto' : 'manual';
}
```text

---

## 3️⃣ 거래처별 보고서 확인 프로세스

### 📋 거래처별 확인 항목 처리


#### **1. 거래처별 목표수금금액 확인**

```text
[보고서 확인 화면]
목표수금금액: 1,000,000원
최종수금금액: [____________] 원 (입력)
[확인] 버튼

처리 로직:
- 누적수금금액 = 기존 누적수금금액 + 최종수금금액
- 부가세 여부와 무관하게 입력값 그대로 합산
- 잔액 = 목표수금금액 - 최종수금금액

결과:
- 잔액 > 0: 다음 보고서 확인에 계속 표시
- 잔액 = 0: 완료 처리
```text


#### **2. 거래처별 목표매출금액 확인**

```text
[보고서 확인 화면]
목표매출금액: 1,100,000원 (부가세 포함 표시)
최종매출금액: [____________] 원 (입력)
[확인] 버튼

처리 로직:
if (부가세 포함) {
  누적매출금액 += (최종매출금액 ÷ 1.1)
} else {
  누적매출금액 += 최종매출금액
}

자동 업데이트:
- 판매제품 컬럼: 기존 + "," + 신규제품
- 마지막결제일: 보고서 확인 날짜
- 마지막총결재금액: 최종매출금액
```text


#### **3. 거래처별 영업활동(특이사항) 확인 ⭐**

```text
[보고서 확인 화면]
원본 내용: "신제품 소개 예정" (금주보고서 작성 시 자유 입력한 내용)
추가 내용: [________________________] (15자 이상 필수)
상태 선택: [실행] [미실행]

처리 규칙:
- 실행 선택 시: 추가 내용 15자 이상 필수
  → 15자 미만이면 실행 버튼 비활성화 또는 경고
- 미실행 선택 시: 추가 내용 길이 무관
- 관리자: 의견 추가 작성 가능

최종 저장:
영업활동(특이사항) = 기존 내용 + "\n" + 추가 내용 + "\n[상태: 실행/미실행]"
[보고서 플로우]
```text

---

## 4️⃣ 실적관리 메뉴(영업/관리자)

### 영업담당모드 실적관리 테이블

```

필터: [전체] [미확인]

테이블 구성:
┌──────────┬─────────────┬─────────────────────┬──────────┐
│   날짜    │ 최종거래처명 │        내용         │   상태    │
├──────────┼─────────────┼─────────────────────┼──────────┤
│2024-12-17│   A치과     │ 목표수금: 1,000,000원│  미확인   │
│2024-12-17│   B치과     │ 목표매출: 2,000,000원│   확인    │
│2024-12-17│   C치과     │ 영업활동: 신제품소개 │  미확인   │
└──────────┴─────────────┴─────────────────────┴──────────┘

```

### 관리자모드 실적관리 테이블

```

필터: [전체] [미확인]

테이블 구성:
┌──────────┬─────────────┬──────────┬───────┬─────────────────────┬──────────┐
│   날짜    │ 최종거래처명 │ 영업담당자│  부서  │        내용         │   상태    │
├──────────┼─────────────┼──────────┼───────┼─────────────────────┼──────────┤
│2024-12-17│   A치과     │  김영업   │ 영업1팀│ 목표수금: 1,000,000원│  미확인   │
│2024-12-17│   B치과     │  박영업   │ 영업2팀│ 목표매출: 2,000,000원│   확인    │
└──────────┴─────────────┴──────────┴───────┴─────────────────────┴──────────┘

```

---

## 5️⃣ 보고서 플로우 다이어그램(전체)

```text
[금주보고서 작성]
    ↓
거래처별 자유 입력
- 목표수금금액 (선택)
- 목표매출금액 (선택, 복수 제품 가능)
- 영업활동(특이사항) (선택, 글자수 제한 없음) ⭐
    ↓
[저장 - 미확인 상태]
    ↓
(시간 경과 - 꼭 다음주가 아니어도 됨)
    ↓
[보고서 확인]
    ↓
각 항목별 최종값 입력 및 조건 확인
- 최종수금: 금액 입력 → 확인 → 누적수금 합산
- 최종매출: 금액 입력 → 확인 → 누적매출 합산 (부가세 처리)
- 영업활동: 
  * 실행: 15자 이상 추가 내용 필수 ⭐
  * 미실행: 추가 내용 자유
    ↓
[확인 완료]
    ↓
자동 업데이트
- 판매제품 추가
- 마지막결제일/금액 갱신
- 누적금액 합산
- 영업활동 내용 추가
```

---

<!-- ===== [SECTION] 💻 로그인 프로세스 ===== -->
## 💻 로그인 프로세스

### 개발 단계 (현재)

```text
1단계: 개발자 로그인 (kjh/1234)
   ↓
2단계: 시스템 접근 (엑셀 업로드 or 기존 데이터)
   ↓
3단계: 사용자 인증 (직원 목록에서 선택)
   ↓
4단계: 대시보드 진입 (admin.html or sales.html)
```

### 웹 배포 단계 (향후)

```text
1단계: 역할 선택 (관리자/영업담당)
   ↓
2단계: 사용자 인증 (이름/비밀번호 1234)
   ↓
3단계: 대시보드 진입
※ 엑셀 업로드는 강정환 관리자만
```

---

<!-- ===== [SECTION] 🎨 UI/UX 설계 ===== -->
## 🎨 UI/UX 설계

### 글래스모피즘 디자인 요소

```css
background: rgba(255, 255, 255, 0.1);
backdrop-filter: blur(10px);
border: 1px solid rgba(255, 255, 255, 0.2);
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
```

### 화면 구성

1. **네비게이션 바**: 로고, 시스템명, 사용자 정보
2. **사이드바 메뉴**: 역할별 차별화 메뉴
3. **메인 콘텐츠**: KPI 대시보드, 데이터 테이블
4. **모달 시스템**: 상세정보, 수정 폼, 기여도 순위

### 반응형 브레이크포인트

- **데스크톱**: 1200px+ (모든 컬럼)
- **태블릿**: 768px-1199px (중요 컬럼)
- **모바일**: ~767px (카드 레이아웃)

---

<!-- ===== [SECTION] 📘 용어집/약어 ===== -->
## 📘 용어집/약어

- KEY VALUE: 데이터 전역 고유 식별자(불변)
- 현재월수(currentMonth): KPI 계산 기준 개월 수
- 주요제품: 임플란트, 지르코니아, Abutment 3단계 우선순위 대상 제품군
- RBAC: 역할 기반 접근 제어(admin/sales)
- DoD: Definition of Done, 완료 기준

---

<!-- ===== [SECTION] 🔒 권한 매트릭스 ===== -->
## 🔒 권한 매트릭스

| 기능 | 관리자(admin) | 영업담당(sales) |
|------|----------------|-----------------|
| 로그인/세션 | 가능 | 가능 |
| 거래처 조회 | 전체 | 본인 담당만 |
| 거래처명(ERP) 수정 | 가능 | 불가 |
| 매출채권잔액 수정 | 가능 | 불가 |
| 영업활동(특이사항) 수정 | 불가 | 가능 |
| 보고서 승인/반려 | 가능 | 불가 |
| 엑셀 업로드 | 강정환 전용 | 불가 |
| 엑셀 다운로드 | 가능 | 가능(개인 범위) |

---

<!-- ===== [SECTION] 🧮 계산 예제 ===== -->
## 🧮 계산 예제

### 현재월수 예제

- 1년 이상 근무자: 2025-01-01 ~ 2025-09-18 → 9개월
- 1년 미만 근무자(입사 2025-07-01): 2025-07-01 ~ 2025-09-18 → 3개월
- 관리자: 전사 기준 현재월수 → 9개월(1-9월)

### 주요제품 3단계 우선순위 예제

1) 임플란트 취급 거래처 우선 선별 → 120개
2) 잔여 중 지르코니아 취급 → +40개(중복 제거)
3) 잔여 중 Abutment만 취급 → +25개(최종 합계 185개)

---

<!-- ===== [SECTION] ✅ 품질 게이트/릴리스 체크 ===== -->
## ✅ 품질 게이트/릴리스 체크

- 빌드/정적 검사: 스크립트 구문 오류 0, 린트 경고는 승인 시 해소 계획 명시
- 성능: 핵심 시나리오 예산 충족(로딩/검색/KPI/업·다운로드)
- 보안/권한: 권한 경계, 세션 타임아웃, 감사 로그 확인
- 접근성: 키보드/명암비/라이브영역 통과
- 문서: 01/02/03 최신화, 체인지로그 작성, 롤백 계획 점검

---

<!-- ===== [SECTION] 📈 표시 형식 규칙 ===== -->
## 📈 표시 형식 규칙

### 숫자 처리

- **양수**: `1,234,567 원` 또는 `개` / `12.34 %` (표시값은 엑셀 및 사전 계산 결과 사용)
- **음수**: `(1,234,567)` 빨간색 / `(12.34)%` 빨간색 (표시값은 엑셀 및 사전 계산 결과 사용)
- **달성률**:
  - 회사배정기준대비 달설율 초과: `XX.XX% 초과배정입니다` ()
  - 회사배정기준대비 달설율 미만: `(XX.XX)%(빨간색) 미만배정입니다` ()
  - 주요고객목표 달성율  초과: `XX.XX% 목표 초과달성입니다` (초록색)
  - 주요고객목표 달성율  미달: `XX.XX%(빨간색) 목표 미달입니다.` (빨간색)

---

<!-- ===== [SECTION] 🔧 기술 구현 ===== -->
## 🔧 기술 구현

### 파일 구조

```text
F:\7.VScode\Running VS Code\KUWOTECH\Kuwotech_management\
├── images/
│   ├── logo.png (회사 로고)
│   └── metal_glass_mono_emojis.html (아이콘)
├── data/ (엑셀 파일 저장)
├── backup/ (자동 백업)
├── index.html (로그인 페이지)
├── admin.html (관리자 대시보드)
├── sales.html (영업담당 대시보드)
├── js/ (JavaScript 파일)
├── css/ (스타일시트)
└── docs/ (문서)
```

### 데이터베이스 구조 (IndexedDB)

```text
KuwotechSalesDB
├── companies (거래처 정보)
├── users (사용자 정보)
├── reports (실적 보고서)
├── changeHistory (변경 이력)
├── kpiCache (KPI 캐시)
└── systemSettings (시스템 설정)
```

### 성능 요구사항

- **페이지 로딩**: 2초 이내
- **데이터 검색/필터링**: 1초 이내
- **KPI 계산**: 500ms 이내
- **엑셀 업로드/다운로드**: 5초 이내 (1000건 기준)
- **동시 사용자**: 30명 지원

### 보안 정책

- **역할 기반 접근 제어 (RBAC)**
- **세션 관리 및 자동 로그아웃**
- **데이터 변경 추적 및 감사 로그**
- **민감정보 암호화 저장**

---

<!-- ===== [SECTION] 📅 실적보고 프로세스 ===== -->
## 📅 실적보고 프로세스

### 1. 금주보고서 작성 (영업담당)

```text
├── 목표수금금액 (선택적)
├── 목표매출액 (복수 제품 가능)
└── 영업활동(특이사항) (자유 입력)
```

### 2. 보고서 확인 (관리자)

```text
├── 최종수금금액 입력
├── 최종매출금액 입력 (부가세 처리)
└── 영업활동 확인 (실행시 15자 이상 필수)
```

### 3. 자동 업데이트

```text
├── 누적 금액 합산
├── 마지막 결제 정보 갱신
└── 판매제품 목록 업데이트
```

---

<!-- ===== [SECTION] ⚙️ 시스템 운영 ===== -->
## ⚙️ 시스템 운영

### 백업 정책

- **자동 백업**: 매일 새벽 2시
- **백업 보관**: 최근 30일분
- **수동 백업**: 중요 변경 전 필수

### 월말 작업 체크리스트 (관리자)

1. 데이터 백업
2. IndexedDB → 엑셀 다운로드
3. ERP 시스템 대조
4. 불일치 사항 수정 (강정환)
5. 수정 파일 재업로드
6. 무결성 검증

### 영업담당 일상 업무

1. 시스템 로그인
2. 담당 거래처 확인
3. 영업활동 입력
4. KPI 모니터링
5. 보고서 작성

---

<!-- ===== [SECTION] 🚨 주의사항 및 핵심 규칙 ===== -->
## 🚨 주의사항 및 핵심 규칙

### 절대 규칙 (위반시 시스템 오류)

1. **KEY VALUE는 절대 수정 불가**
   - 시스템 고유 식별자
   - 수정 시도시 에러 발생
   - 삭제/재생성도 불가

2. **권한별 수정 제한**
   - 거래처명(ERP), 매출채권잔액: 관리자만 수정 가능
   - 영업활동(특이사항): 영업담당만 수정 가능
   - 엑셀 업로드: 강정환 관리자만 가능
   - 보고서 승인: 관리자만 가능

3. **계산 규칙 준수**
   - 현재월수: 입사일 기준 정확히 계산
   - 부가세: 포함(÷1.1), 제외(원값) 명확히 구분
   - 주요제품: 3단계 우선순위 엄격 적용

### 데이터 무결성 규칙

1. **중복 방지**
   - KEY VALUE 중복 불가
   - 직원명 중복시 부서로 구분
   - 거래처명 중복시 지역으로 구분

2. **필수 필드**
   - NO, KEY VALUE, 거래처명(ERP): 필수
   - 내부담당자: 영업담당 필수 지정
   - 거래상태: 기본값 '대기'

3. **데이터 형식**
   - 날짜: YYYY-MM-DD
   - 금액: 숫자만 (콤마 자동 삽입)
   - 백분율: 소수점 2자리까지

### 성능 최적화 규칙

1. **캐싱 전략**
   - KPI 계산: 5분간 캐시
   - 직원 목록: 세션 유지
   - 거래처 목록: 변경시만 갱신

2. **배치 처리**
   - 엑셀 업로드: 100건 단위 처리
   - KPI 재계산: 비동기 처리
   - 백업: 새벽 2시 자동 실행

---

<!-- ===== [SECTION] 📝 문서 작성 및 코드 작성 원칙 ===== -->
## 📝 문서 작성 및 코드 작성 원칙

### 문서 작성 원칙

1. **한글자도 놓치지 않기**
   - 모든 항목 완전히 기록
   - 한글 표기 정확히 유지
   - 숫자/날짜 정확히 표기

2. **구조화 원칙**
   - 네비게이션 주석 필수
   - 섹션별 명확한 구분
   - 상호 참조 명시

3. **시각화 원칙**
   - 복잡한 로직은 다이어그램
   - 데이터 플로우는 도표
   - UI는 목업/스크린샷

### 코드 작성 원칙

1. **명명 규칙**
   - 변수: camelCase
   - 상수: UPPER_SNAKE_CASE
   - 클래스: PascalCase
   - 파일명: kebab-case

2. **주석 규칙**
   - 모든 함수에 JSDoc 주석
   - 복잡한 로직에 설명 주석
   - TODO, FIXME 명확히 표시

3. **에러 처리**
   - try-catch 필수
   - 에러 로깅 상세히
   - 사용자 친화적 메시지

4. **보안 원칙**
   - 입력값 검증 필수
   - SQL 인젝션 방지
   - XSS 방지 처리

---

## 📋 KUWOTECH 시스템 사양서

## 🎯 시스템 개요

치과 영업 데이터를 관리하는 웹 기반 시스템으로, **엑셀 파일을 중심 데이터 소스**로 사용하며, **영업담당모드**와 **관리자모드**로 구분하여 운영됩니다.

- **버전**: 3.1.0
- **개발 언어**: JavaScript (Vanilla JS)
- **데이터베이스**: IndexedDB (브라우저 내장)
- **엑셀 처리**: SheetJS (XLSX)

---

## 1️⃣ 데이터 구조

### 엑셀 파일 구성

```text
원본데이터.xlsx
├── 📄 기본정보 시트 (19개 컬럼)
└── 📄 입사일자 시트 (영업담당자 정보)
```text

### 19개 컬럼 정의

| 순번 | 컬럼명 | 권한 | 자동업데이트 | 설명 |
|------|--------|------|--------------|------|
| 1 | NO | ❌ | - | 순번 (시스템 표시 안함) |
| 2 | **KEY VALUE** | ❌ | - | 고유 식별자 |
| 3 | 거래처명(ERP) | 관리자 | - | ERP 시스템 거래처명 |
| 4 | 최종거래처명 | 모두 | - | 실제 표시용 거래처명 |
| 5 | 폐업여부 | 모두 | - | Y/N |
| 6 | 대표이사/치과의사 | 모두 | - | 대표자 정보 |
| 7 | 고객사 지역 | 모두 | - | 지역 정보 |
| 8 | 거래상태 | 모두 | - | 활성/비활성/불용/추가확인 |
| 9 | 담당부서 | 모두 | - | 내부 담당부서 |
| 10 | **판매제품** | - | ✅ | 보고서 확인 시 자동 추가 |
| 11 | 내부담당자 | 모두 | - | 영업사원 정보 |
| 12 | 정철웅기여 | 모두 | - | 상/중/하 |
| 13 | 회사기여 | 모두 | - | 상/중/하 |
| 14 | **마지막결제일** | - | ✅ | 보고서 확인 시 자동 갱신 |
| 15 | **마지막총결재금액** | - | ✅ | 보고서 확인 시 자동 갱신 |
| 16 | 매출채권잔액 | 관리자 | - | 미수금 잔액 |
| 17 | **누적수금금액** | - | ✅ | 보고서 확인 시 자동 합산 |
| 18 | **누적매출금액** | - | ✅ | 보고서 확인 시 자동 합산 |
| 19 | **영업활동(특이사항)** | 영업담당 | ✅ | 보고서 작성/확인 시 추가 |

---

## 2️⃣ 실적보고 시스템

### 금주보고서 작성

#### 보고서 구성 (거래처별)

```text
거래처: A치과 (KEY001)
├── 목표수금금액 (선택적)
├── 목표매출액 (선택적) - 여러 제품 가능
│   ├── 제품1: 판매제품 / 목표금액 / 부가세
│   └── 제품2: 판매제품 / 목표금액 / 부가세
└── 영업활동(특이사항) (선택적)
```text

### 보고서 확인 프로세스

#### 목표수금금액 확인

```text
목표수금금액: 1,000,000원
최종수금금액: [입력] 원
[확인] 버튼

처리: 누적수금금액 += 최종수금금액
```text

#### 목표매출금액 확인  

```text
목표매출금액: 1,100,000원 (부가세 포함)
최종매출금액: [입력] 원
[확인] 버튼

처리:
if (부가세포함) {
  누적매출금액 += (최종매출금액 ÷ 1.1)
} else {
  누적매출금액 += 최종매출금액
}
```text

#### 영업활동 확인

```text
원본 내용: "신제품 소개 예정"
추가 내용: [입력] (실행 시 15자 이상 필수)
상태: [실행] [미실행]

저장: 기존 + "\n" + 추가 + "\n[상태]"
```text

---

## 3️⃣ 표시 형식 규칙

### 숫자 포맷팅

| 타입 | 엑셀 값 | 처리 과정 | 최종 표시 |
|------|---------|-----------|-----------|
| **개수** | 123456 | 123,456 | `123,456개` |
| **금액** | 1234567 | 1,234,567 | `1,234,567원` |
| **비율** | 12.34 | 12.34 | `12.34%` |

### 음수 표시 (빨간색)

| 타입 | 엑셀 값 | 처리 과정 | 최종 표시 |
|------|---------|-----------|-----------|
| **개수** | -123 | (123) | `(123)개` 빨간색 |
| **금액** | -1234 | (1,234) | `(1,234)원` 빨간색 |
| **비율** | -12.34 | (12.34) | `(12.34)%` 빨간색 |

### 특별 표시 (달성율)

| 상태 | 엑셀 값 | 최종 표시 |
|------|---------|-----------|
| **초과** | 12.34 | `12.34% 초과달성 상태입니다` 파란색 |
| **미달** | -12.34 | `(12.34)% 미만달성 상태입니다` 빨간색 |

---

## 4️⃣ KPI 계산 지표

### 영업담당모드 (14개 지표)

| 지표명 | 계산식 | 표시 예시 |
|--------|--------|-----------|
| 담당거래처 | COUNT(내부담당자=본인 AND 거래상태≠'불용') | `82개` |
| 활성거래처 | COUNT(거래상태='활성' or 누적매출>0) | `65개` |
| 활성화율 | (활성거래처/담당거래처) × 100 | `79.27%` |
| 주요제품판매거래처 | 3단계 우선순위 계산 | `35개` |
| 회사배정기준 달성율 | ((담당거래처/80) - 1) × 100 | `2.50% 초과` |
| 주요고객처 목표달성율 | ((주요제품거래처/40)-1) × 100 | `87.50%` |
| 누적매출금액 | SUM(누적매출금액) | `280,000,000원` |
| 주요제품매출액 | SUM(주요제품 매출) | `210,000,000원` |
| 주요제품매출비율 | (주요제품매출/누적매출) × 100 | `75.00%` |
| 매출집중도 | (누적매출/담당거래처)/현재월수 | `2,845,528원` |
| 누적수금금액 | SUM(누적수금금액) | `270,000,000원` |
| 매출채권잔액 | SUM(매출채권잔액) | `10,000,000원` |
| 전체매출기여도 | (개인/전사) × 100 | `32.94%` |
| 주요매출기여도 | (개인주요/전사주요) × 100 | `32.31%` |

### 관리자모드 (11개 지표)

| 지표명 | 계산식 | 표시 예시 |
|--------|--------|-----------|
| 전체거래처 | COUNT(거래상태≠'불용') | `245개` |
| 활성거래처 | COUNT(거래상태='활성' or 누적매출>0) | `189개` |
| 활성화율 | (활성거래처/전체거래처) × 100 | `77.14%` |
| 주요제품판매거래처 | 3단계 우선순위 계산 | `95개` |
| 회사배정기준 달성율 | ((전체/(80×영업담당자수)) - 1) × 100 | `2.08% 초과` |
| 주요고객처 목표달성율 | (주요제품/(40×영업담당자수)-1) × 100 | `79.17%` |
| 누적매출금액 | SUM(전체 누적매출) | `850,000,000원` |
| 주요제품매출액 | SUM(주요제품 매출) | `650,000,000원` |
| 주요제품매출비율 | (주요제품매출/누적매출) × 100 | `76.47%` |
| 매출집중도 | (누적매출/전체거래처)/현재월수 | `2,894,068원` |
| 누적수금금액 | SUM(전체 누적수금) | `820,000,000원` |

### 주요제품 계산 로직

**주요제품 정의:**

- 임플란트 (IMPLANT)
- 지르코니아 (ZIRCONIA)
- Abutment

**3단계 우선순위 계산:**

```text
1단계: 임플란트 포함 거래처
2단계: 지르코니아만 포함 (1단계 제외)
3단계: Abutment만 포함 (1,2단계 제외)
최종합계 = 1단계 + 2단계 + 3단계
```text

---

## 5️⃣ 권한별 차이점

| 구분 | 영업담당모드 | 관리자모드 |
|------|------------|-----------|
| 데이터 범위 | 본인 담당만 | 전체 |
| 수정 권한 | 본인 담당만 | 전체 |
| 통계 범위 | 개인 실적 | 전사 + 개인별 |
| 기여도 확인 | 본인만 | 전체 순위표 |
| 목표 기준 | 개인 (80/40) | 전사 (80×n/40×n) |
| 매출집중도 | 입사일 기반 | 전월 기준 |
| 엑셀 다운로드 | 본인 데이터 | 전체 데이터 |
| 보고서 확인 | 본인 작성만 | 전체 |
| 매출채권잔액 | 수정 불가 | 수정 가능 |

---

## 6️⃣ 자동 업데이트 메커니즘

| 컬럼명 | 업데이트 시점 | 방법 |
|--------|--------------|------|
| 판매제품 | 보고서 확인 시 | 기존 + "," + 신규 |
| 마지막결제일 | 보고서 확인 시 | 확인 날짜로 갱신 |
| 마지막총결재금액 | 보고서 확인 시 | 최종매출금액 |
| 누적수금금액 | 보고서 확인 시 | 기존 + 최종수금 |
| 누적매출금액 | 보고서 확인 시 | 기존 + (부가세 처리) |
| 매출채권잔액 | 월말 일괄 | 엑셀 업로드 |
| 영업활동 | 보고서 작성/확인 | 기존 + 신규 + 상태 |

---

## 7️⃣ 시스템 특징 요약

1. **데이터와 표시의 분리** - 엑셀은 숫자만, 프로그램이 포맷팅
2. **일관된 숫자 처리** - 음수는 괄호, 양수는 그대로
3. **KEY VALUE 중심** - 모든 데이터의 고유 식별자
4. **실시간 반영** - 수정사항 즉시 적용
5. **이력 관리** - 모든 변경사항 추적
6. **권한 분리** - 역할별 접근 범위 제한
7. **자동 계산** - 복잡한 비즈니스 로직 자동화
8. **유연한 보고서** - 선택적 작성, 시차 허용
9. **영업활동 검증** - 작성은 자유, 확인 시 조건
10. **살아있는 엑셀** - 프로그램과 엑셀 양방향 동기화

---

**📝 시스템 사양서 v1.2.0**  
*데이터의 정확성과 표시의 일관성을 보장하는 통합 솔루션*

## 📋 KUWOTECH 영업관리 시스템 - 시스템 사양서

## 🎯 영업관리 시스템 개요

치과 영업 데이터를 관리하는 웹 기반 시스템으로, **엑셀 파일을 중심 데이터 소스**로 사용하며, **영업담당모드**와 **관리자모드**로 구분하여 운영됩니다.

- 버전: 3.0.0
- 최종 업데이트: 2024-12-17
- 개발 언어: JavaScript (Vanilla JS)
- 데이터베이스: IndexedDB (브라우저 내장)
- 엑셀 처리: SheetJS (XLSX)

---

## 1️⃣ 데이터 구조와 흐름

### 초기 엑셀 파일 구성 (2개 시트)

```text
원본데이터.xlsx (초기 업로드)
├── 📄 기본정보 시트
│   ├── 19개 컬럼 (KEY VALUE가 고유 식별자)
│   └── 거래처 마스터 데이터 (숫자만 저장)
│
└── 📄 입사일자 시트
    ├── 영업담당자명 | 입사일자
    └── 매출집중도 계산용 (현재월수 산정)
```text

### 프로그램 사용 후 엑셀 파일 구성 (4개 시트)

```text
원본데이터.xlsx (다운로드 시)
├── 📄 기본정보 시트 (수정사항 반영)
├── 📄 입사일자 시트 (변경 없음)
├── 📄 변경내역 시트 (신규 생성)
│   └── KEY VALUE | 날짜 | 거래처명 | 담당자 | 변경전 | 변경후
└── 📄 보고서 시트 (신규 생성)
    └── KEY VALUE | 날짜 | 거래처명 | 담당자 | 상태(확인/미확인)
```text

### 기본정보 시트 컬럼 및 권한 정의 (19개)

| 순번 | 컬럼명 | 내부 필드명 | 관리자 | 영업담당 | 자동업데이트 | 설명 |
|------|--------|-------------|--------|----------|--------------|------|
| 1 | NO | no | ❌ | ❌ | - | 순번 (시스템 표시 안함) |
| 2 | **KEY VALUE** | keyValue | ❌ | ❌ | - | 고유 식별자 (변경 불가) |
| 3 | 거래처명(ERP) | companyNameERP | ✅ | ❌ | - | 관리자만 수정 가능 |
| 4 | 최종거래처명 | finalCompanyName | ✅ | ✅ | - | 모두 수정 가능 |
| 5 | 폐업여부 | isClosed | ✅ | ✅ | - | Y/N, 모두 수정 가능 |
| 6 | 대표이사 또는 치과의사 | ceoOrDentist | ✅ | ✅ | - | 모두 수정 가능 |
| 7 | 고객사 지역 | customerRegion | ✅ | ✅ | - | 모두 수정 가능 |
| 8 | 거래상태 | businessStatus | ✅ | ✅ | - | 활성/비활성/불용/추가확인 |
| 9 | 담당부서 | department | ✅ | ✅ | - | 모두 수정 가능 |
| 10 | **판매제품** | salesProduct | - | - | ✅ | 보고서 확인 시 자동 추가 |
| 11 | 내부담당자 | internalManager | ✅ | ✅ | - | 모두 수정 가능 |
| 12 | 정철웅기여(상.중.하) | jcwContribution | ✅ | ✅ | - | 모두 수정 가능 |
| 13 | 회사기여(상.중.하) | companyContribution | ✅ | ✅ | - | 모두 수정 가능 |
| 14 | **마지막결제일** | lastPaymentDate | - | - | ✅ | 보고서 확인 시 자동 갱신 |
| 15 | **마지막총결재금액** | lastPaymentAmount | - | - | ✅ | 보고서 확인 시 자동 갱신 |
| 16 | 매출채권잔액 | accountReceivable | ✅ | ❌ | - | 관리자만 수정 (월말 일괄) |
| 17 | **누적수금금액** | accumulatedCollection | - | - | ✅ | 보고서 확인 시 자동 합산 |
| 18 | **누적매출금액** | accumulatedSales | - | - | ✅ | 보고서 확인 시 자동 합산 |
| 19 | **영업활동(특이사항)** | businessActivity | - | ✅ | ✅ | 보고서 작성/확인 시 추가 |

### 데이터 처리 원칙

```text
엑셀: 순수 숫자만 저장 (단위 없음)
  ↓
프로그램: 숫자 읽기 → 음수 처리 → 단위 붙이기
  ↓
화면 표시: 최종 포맷팅된 결과
```

---

## 2️⃣ 금주보고서 시스템

### 📝 금주보고서 작성 프로세스

#### **보고서 구성 (거래처별 작성)**

```text
거래처: A치과 (KEY001)
├── 목표수금금액 (선택적)
│   └── 금액 입력 (자유 입력)
│
├── 목표매출액 (선택적) - 여러 제품 가능
│   ├── 제품1
│   │   ├── 판매제품: [회사 전체 제품 목록에서 선택]
│   │   ├── 목표매출금액: [숫자 입력]
│   │   └── 부가세: [포함/제외 선택]
│   │
│   └── 제품2 (제품추가 버튼으로 추가)
│       ├── 판매제품: [드롭다운 선택]
│       ├── 목표매출금액: [숫자 입력]
│       └── 부가세: [포함/제외 선택]
│
└── 영업활동(특이사항) (선택적)
    └── 텍스트 입력 (자유 입력, 글자수 제한 없음)
```

#### **핵심 규칙**

1. **선택적 작성**: 세 항목(목표수금/목표매출/영업활동) 모두 필수 아님
2. **제품 복수 선택**: "제품추가" 버튼으로 여러 제품 등록 가능
3. **영업활동 작성**: 금주보고서 작성 시 글자수 제한 없이 자유롭게 작성
4. **거래처별 작성**: 각 거래처마다 개별 보고서 작성

---

## 3️⃣ 보고서 확인 프로세스

### 📋 확인 항목별 처리

#### **1. 목표수금금액 확인**

```text
[보고서 확인 화면]
목표수금금액: 1,000,000원
최종수금금액: [____________] 원 (입력)
[확인] 버튼

처리 로직:
- 누적수금금액 = 기존 누적수금금액 + 최종수금금액
- 부가세 여부와 무관하게 입력값 그대로 합산
- 잔액 = 목표수금금액 - 최종수금금액

결과:
- 잔액 > 0: 다음 보고서 확인에 계속 표시
- 잔액 = 0: 완료 처리
```

#### **2. 목표매출금액 확인**

```text
[보고서 확인 화면]
목표매출금액: 1,100,000원 (부가세 포함 표시)
최종매출금액: [____________] 원 (입력)
[확인] 버튼

처리 로직:
if (부가세 포함) {
  누적매출금액 += (최종매출금액 ÷ 1.1)
} else {
  누적매출금액 += 최종매출금액
}

자동 업데이트:
- 판매제품 컬럼: 기존 + "," + 신규제품
- 마지막결제일: 보고서 확인 날짜
- 마지막총결재금액: 최종매출금액
```

#### **3. 영업활동(특이사항) 확인 ⭐**

```text
[보고서 확인 화면]
원본 내용: "신제품 소개 예정" (금주보고서 작성 시 자유 입력한 내용)
추가 내용: [________________________] (15자 이상 필수)
상태 선택: [실행] [미실행]

처리 규칙:
- 실행 선택 시: 추가 내용 15자 이상 필수
  → 15자 미만이면 실행 버튼 비활성화 또는 경고
- 미실행 선택 시: 추가 내용 길이 무관
- 관리자: 의견 추가 작성 가능

최종 저장:
영업활동(특이사항) = 기존 내용 + "\n" + 추가 내용 + "\n[상태: 실행/미실행]"
```

---

## 4️⃣ 실적관리 메뉴

### 영업담당모드 실적관리

```
필터: [전체] [미확인]

테이블 구성:
┌──────────┬─────────────┬─────────────────────┬──────────┐
│   날짜    │ 최종거래처명 │        내용         │   상태    │
├──────────┼─────────────┼─────────────────────┼──────────┤
│2024-12-17│   A치과     │ 목표수금: 1,000,000원│  미확인   │
│2024-12-17│   B치과     │ 목표매출: 2,000,000원│   확인    │
│2024-12-17│   C치과     │ 영업활동: 신제품소개 │  미확인   │
└──────────┴─────────────┴─────────────────────┴──────────┘
```

### 관리자모드 실적관리

```
필터: [전체] [미확인]

테이블 구성:
┌──────────┬─────────────┬──────────┬───────┬─────────────────────┬──────────┐
│   날짜    │ 최종거래처명 │ 영업담당자│  부서  │        내용         │   상태    │
├──────────┼─────────────┼──────────┼───────┼─────────────────────┼──────────┤
│2024-12-17│   A치과     │  김영업   │ 영업1팀│ 목표수금: 1,000,000원│  미확인   │
│2024-12-17│   B치과     │  박영업   │ 영업2팀│ 목표매출: 2,000,000원│   확인    │
└──────────┴─────────────┴──────────┴───────┴─────────────────────┴──────────┘
```

---

## 5️⃣ 보고서 플로우 다이어그램

```
[금주보고서 작성]
    ↓
거래처별 자유 입력
- 목표수금금액 (선택)
- 목표매출금액 (선택, 복수 제품 가능)
- 영업활동(특이사항) (선택, 글자수 제한 없음) ⭐
    ↓
[저장 - 미확인 상태]
    ↓
(시간 경과 - 꼭 다음주가 아니어도 됨)
    ↓
[보고서 확인]
    ↓
각 항목별 최종값 입력 및 조건 확인
- 최종수금: 금액 입력 → 확인 → 누적수금 합산
- 최종매출: 금액 입력 → 확인 → 누적매출 합산 (부가세 처리)
- 영업활동: 
  * 실행: 15자 이상 추가 내용 필수 ⭐
  * 미실행: 추가 내용 자유
    ↓
[확인 완료]
    ↓
자동 업데이트
- 판매제품 추가
- 마지막결제일/금액 갱신
- 누적금액 합산
- 영업활동 내용 추가
```

---

## 6️⃣ 표시 형식 규칙

### 📐 숫자 처리 로직

#### Step 1: 엑셀에서 숫자 가져오기

```javascript
// 엑셀에는 숫자만 저장
예: 123456 (양수)
예: -123 (음수)
예: 12.34 (소수)
```

#### Step 2: 음수 처리

```javascript
// 개수/금액 (정수)
if (value < 0) {
  표시값 = `(${Math.abs(value).toLocaleString()})`  // (123,456)
} else {
  표시값 = value.toLocaleString()  // 123,456
}

// 비율 (소수점 2자리)
if (value < 0) {
  표시값 = `(${Math.abs(value).toFixed(2)})`  // (12.34)
} else {
  표시값 = value.toFixed(2)  // 12.34
}
```

#### Step 3: 단위 붙이기

```javascript
// 최종 표시
개수: 표시값 + "개"     // 123,456개 또는 (123)개
금액: 표시값 + "원"     // 1,234,567원 또는 (1,234)원
비율: 표시값 + "%"      // 12.34% 또는 (12.34)%
```

### ✅ 정상 표시 규칙

| 타입 | 엑셀 값 | 처리 과정 | 최종 표시 |
|------|---------|-----------|-----------|
| **개수** | 123456 | 123456 → 123,456 → 123,456개 | `123,456개` |
| **금액** | 1234567 | 1234567 → 1,234,567 → 1,234,567원 | `1,234,567원` |
| **비율** | 12.34 | 12.34 → 12.34 → 12.34% | `12.34%` |

### ❌ 음수 표시 규칙 (빨간색)

| 타입 | 엑셀 값 | 처리 과정 | 최종 표시 |
|------|---------|-----------|-----------|
| **개수** | -123 | -123 → (123) → (123)개 | `(123)개` 빨간색 |
| **금액** | -1234 | -1234 → (1,234) → (1,234)원 | `(1,234)원` 빨간색 |
| **비율** | -12.34 | -12.34 → (12.34) → (12.34)% | `(12.34)%` 빨간색 |

### 📊 특별 표시 (달성율)

| 상태 | 엑셀 값 | 처리 과정 | 최종 표시 |
|------|---------|-----------|-----------|
| **초과** | 12.34 | 12.34 → 12.34% → 특별 메시지 | `12.34% 초과달성 상태입니다` 파란색 |
| **미달** | -12.34 | -12.34 → (12.34)% → 특별 메시지 | `(12.34)% 미만달성 상태입니다` 빨간색 |

---

## 7️⃣ 영업담당모드 계산 지표

| 지표명 | 계산식 | 엑셀 저장값 예시 | 화면 표시 예시 |
|--------|--------|----------------|--------------|
| **담당거래처** | COUNT WHERE 내부담당자=본인 AND 거래상태≠'불용' | 82 | `82개` |
| **활성거래처** | COUNT WHERE 거래상태='활성'| 65 | `65개` |
| **활성화율** | (활성거래처/담당거래처) × 100 | 79.27 | `79.27%` |
| **주요제품판매거래처** | 3단계 우선순위 계산 (중복제거) | 35 | `35개` |
| **회사배정기준대비 달성율** | ((담당거래처/80) - 1) × 100 | 2.50 또는 -15.00 | `2.50% 초과배정` 또는 `(15.00)% 미만배정` |
| **주요고객처목표달성율** | (주요제품거래처/40) × 100 | 87.50 | `87.50% 달성` |
| **누적매출금액** | SUM(누적매출금액) WHERE 내부담당자=본인 | 280000000 | `280,000,000원` |
| **주요제품매출액** | SUM(누적매출금액) WHERE 주요제품 | 210000000 | `210,000,000원` |
| **주요제품매출비율** | (주요제품매출/누적매출) × 100 | 75.00 | `75.00%` |
| **매출집중도** | (누적매출/담당거래처)/현재월수 | 2845528 | `2,845,528원` |
| **누적수금금액** | SUM(누적수금금액) WHERE 내부담당자=본인 | 270000000 | `270,000,000원` |
| **매출채권잔액** | SUM(매출채권잔액) WHERE 내부담당자=본인 | 10000000 | `10,000,000원` |
| **전체매출기여도** | (개인 누적매출/전사 누적매출) × 100 | 32.94 | `32.94%` |
| **주요매출기여도** | (개인 주요제품매출/전사 주요제품매출) × 100 | 32.31 | `32.31%` |

### 🔑 영업담당모드 현재월수 계산

```javascript
if ((입사일자~현재 경과일수)/365 > 1) {
  // 1년 이상 근무자: 올해 1월 1일부터 계산
  현재월수 = Math.floor((올해1월1일~현재 경과일수)/30)
} else {
  // 1년 미만 근무자: 입사일부터 계산
  현재월수 = Math.floor((입사일자~현재 경과일수)/30)
}
// 담당자명 표시: "김영업(입사일자: 2023-01-15)"
```

---

## 8️⃣ 관리자모드 계산 지표

| 지표명 | 계산식 | 엑셀 저장값 예시 | 화면 표시 예시 |
|--------|--------|----------------|--------------|
| **전체거래처** | COUNT WHERE 거래상태≠'불용' | 245 | `245개` |
| **활성거래처** | COUNT WHERE 거래상태='활성' | 189 | `189개` |
| **활성화율** | (활성거래처/전체거래처) × 100 | 77.14 | `77.14%` |
| **주요제품판매거래처** | 3단계 우선순위 계산 (중복제거) | 95 | `95개` |
| **회사배정기준대비 달성율** | ((전체거래처/(80×영업담당자수)) - 1) × 100 | 2.08 | `2.08% 초과배정` |
| **주요고객처목표달성율** | (주요제품거래처/(40×영업담당자수)) × 100 | 79.17 | `79.17% 달성` |
| **누적매출금액** | SUM(누적매출금액) 전체 | 850000000 | `850,000,000원` |
| **주요제품매출액** | SUM(누적매출금액) WHERE 주요제품 | 650000000 | `650,000,000원` |
| **주요제품매출비율** | (주요제품매출/누적매출) × 100 | 76.47 | `76.47%` |
| **매출집중도** | (누적매출/전체거래처)/현재월수 | 2894068 | `2,894,068원` |
| **누적수금금액** | SUM(누적수금금액) 전체 | 820000000 | `820,000,000원` |
| **매출채권잔액** | SUM(매출채권잔액) 전체 | 30000000 | `30,000,000원` |

### 🔑 관리자모드 현재월수

```javascript
현재월수 = 현재월 - 1  // 전월까지 계산
```

---

## 9️⃣ 주요제품 계산 로직 (중복 제거)

### 주요제품 정의

- 임플란트 (IMPLANT)
- 지르코니아 (ZIRCONIA)
- Abutment

### 계산 예시

```
5개 거래처 예시:
A거래처: 임플란트, 지르코니아
B거래처: 임플란트
C거래처: 지르코니아
D거래처: Abutment
E거래처: 임플란트, 지르코니아, Abutment

계산 과정:
1단계) 임플란트 거래처 → A, B, E (3개)
2단계) 지르코니아 거래처 (1단계 제외) → C (1개)
3단계) Abutment 거래처 (1,2단계 제외) → D (1개)

결과: 3 + 1 + 1 = 5개
```

---

## 🔟 기여도 계산 (관리자모드 전용)

### 영업사원별 기여도 순위표

| 순위 | 영업사원 | 매출금액 | 기여도(%) | 담당거래처 | 활성거래처 |
|------|----------|----------|-----------|------------|------------|
| 1 | 김영업 | `280,000,000원` | `32.94%` | `82개` | `65개` |
| 2 | 박영업 | `250,000,000원` | `29.41%` | `78개` | `60개` |
| 3 | 이영업 | `320,000,000원` | `37.65%` | `85개` | `64개` |
| **합계** | - | `850,000,000원` | `100.00%` | `245개` | `189개` |

---

## 1️⃣1️⃣ 자동 업데이트 메커니즘

| 컬럼명 | 업데이트 시점 | 저장 방식 | 업데이트 방법 |
|--------|--------------|-----------|--------------|
| **판매제품** | 보고서 확인 완료 시 | 텍스트 | 기존 + "," + 신규제품 |
| **마지막결제일** | 보고서 확인 완료 시 | 날짜 | 보고서 확인 날짜로 갱신 |
| **마지막총결재금액** | 보고서 확인 완료 시 | 숫자 | 최종매출금액으로 갱신 |
| **누적수금금액** | 보고서 확인 완료 시 | 숫자 | 기존값 + 최종수금금액 |
| **누적매출금액** | 보고서 확인 완료 시 | 숫자 | 기존값 + (부가세 처리된 최종매출금액) |
| **매출채권잔액** | 관리자 월말 업데이트 | 숫자 | 엑셀 업로드로 일괄 갱신 |
| **영업활동(특이사항)** | 보고서 작성/확인 시 | 텍스트 | 기존 + "\n" + 신규내용 + 상태 |

### 부가세 처리 로직

```javascript
// 누적매출금액 업데이트 시
if (부가세포함) {
  누적매출금액 += (최종매출금액 ÷ 1.1)
} else {
  누적매출금액 += 최종매출금액
}

// 누적수금금액 업데이트 시
누적수금금액 += 최종수금금액  // 부가세 무관
```

---

## 1️⃣2️⃣ 잔액 관리 시스템

### 목표 vs 실제 잔액 추적

```javascript
// 수금 잔액 관리
수금잔액 = 목표수금금액 - 최종수금금액
if (수금잔액 > 0) {
  상태 = "진행중"  // 다음 보고서 확인에 계속 표시
} else {
  상태 = "완료"
}

// 매출 잔액 관리
매출잔액 = 목표매출금액 - 최종매출금액
if (매출잔액 > 0) {
  상태 = "진행중"  // 다음 보고서 확인에 계속 표시
} else {
  상태 = "완료"
}
```

---

## 1️⃣4️⃣ 권한별 차이점

| 구분 | 영업담당모드 | 관리자모드 |
|------|------------|-----------|
| **데이터 범위** | 본인 담당 거래처만 | 전체 거래처 |
| **수정 권한** | 본인 담당만 수정 | 전체 수정 가능 |
| **통계 범위** | 개인 실적 | 전사 + 개인별 실적 |
| **기여도 확인** | 본인 기여도만 (전사 대비 %) | 전체 순위표 + 상세 분석 |
| **목표 기준** | 개인 목표 (80/40) | 전사 목표 (80×n/40×n) |
| **매출집중도** | 입사일 기반 현재월수 | 전월 기준 |
| **엑셀 다운로드** | 본인 데이터만 | 전체 데이터 |
| **보고서 확인** | 본인 작성 보고서만 | 전체 보고서 확인 가능 |
| **매출채권잔액** | 수정 불가 | 수정 가능 |

---

## 1️⃣5️⃣ 시스템 특징 요약

1. **데이터와 표시의 분리** - 엑셀은 숫자만, 프로그램이 포맷팅
2. **일관된 숫자 처리** - 음수는 괄호, 양수는 그대로
3. **단계별 처리** - 숫자 → 음수처리 → 단위추가
4. **"살아있는 엑셀"** - 프로그램과 엑셀 양방향 동기화
5. **KEY VALUE 중심** - 모든 데이터의 고유 식별자 (변경 불가)
6. **실시간 반영** - 수정사항 즉시 적용
7. **이력 관리** - 모든 변경사항 추적 가능
8. **권한 분리** - 역할별 접근 범위 제한
9. **자동 계산** - 복잡한 비즈니스 로직 자동화
10. **유연한 보고서** - 선택적 작성, 시차 허용
11. **영업활동 검증** - 작성은 자유, 확인 시 조건 적용

---

## 📋 개선된 금주보고서 시스템 설계

### 1️⃣ **개선된 실적보고서 작성 폼**

```
┌─────────────────────────────────────────────────────┐
│  📝 [주간/월간/연간]실적보고서 작성                     │
├─────────────────────────────────────────────────────┤
│                                                     │
│  📅 작성일: 2024-12-17 (자동 입력)                 │
│  거래처: [▼ A치과 (KEY001)           ]             │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ ☐ 💰 목표수금금액                          │   │
│  │   └─ 금액: [_______________] 원            │   │
│  │        (자동 천단위 콤마)                  │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ ☐ 📊 목표매출액                            │   │
│  │   ├─ 제품1: [▼임플란트    ]                │   │
│  │   │  금액: [_______________] 원            │   │
│  │   │  부가세: [▼포함]                       │   │
│  │   │                                        │   │
│  │   └─ [+ 매출제품 증가]                     │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ ☐ 📝 영업활동(특이사항)                    │   │
│  │                                             │   │
│  │  활동 유형: [▼ 선택하세요 ]                │   │
│  │    • 전화통화 예정                         │   │
│  │    • 방문예정                              │   │
│  │    • 문서전달                              │   │
│  │    • 기타                                  │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│    [전체 재작성]         [취소]        [저장]      │
└─────────────────────────────────────────────────────┘
```

### 2️⃣ **영업활동 유형별 세부 입력 폼**

#### A. 전화통화 예정

```
┌─────────────────────────────────────────────────────┐
│ 📞 전화통화 예정                                    │
├─────────────────────────────────────────────────────┤
│                                                     │
│  날짜: [2024-12-20 ▼]  시간: [14:00 ▼]           │
│  대상자: [_______________]                         │
│  목적: ┌─────────────────────────────────┐        │
│        │ (자유 입력)                      │        │
│        │                                   │        │
│        └─────────────────────────────────┘        │
│                                                     │
│  실행자: (●) 본인  ( ) 대리 실행                  │
│  └─ 대리 실행자: [딜러/대리점명___________]       │
│     전화번호: [_______________]                   │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### B. 방문예정

```
┌─────────────────────────────────────────────────────┐
│ 🚗 방문예정                                         │
├─────────────────────────────────────────────────────┤
│                                                     │
│  날짜: [2024-12-20 ▼]                             │
│  장소: [_______________]                           │
│  대상자(미팅): [_______________]                   │
│  목적: ┌─────────────────────────────────┐        │
│        │ (자유 입력)                      │        │
│        │                                   │        │
│        └─────────────────────────────────┘        │
│                                                     │
│  실행자: (●) 본인  ( ) 대리 실행                  │
│  └─ 대리 실행자: [딜러/대리점명___________]       │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### C. 문서전달

```
┌─────────────────────────────────────────────────────┐
│ 📄 문서전달                                         │
├─────────────────────────────────────────────────────┤
│                                                     │
│  날짜: [2024-12-20 ▼]                             │
│  전달방법: [▼ 방문 / 이메일]                      │
│  전달문서: [_______________]                       │
│  전달문서 내용:                                    │
│  ┌─────────────────────────────────────┐          │
│  │ (자유 입력)                          │          │
│  │                                       │          │
│  └─────────────────────────────────────┘          │
│                                                     │
│  실행자: (●) 본인  ( ) 대리 실행                  │
│  └─ 대리 실행자: [딜러/대리점명___________]       │
│                                                     │
└─────────────────────────────────────────────────────┘
```

### 3️⃣ **실적관리 모달 뷰 (상세보기)**

```
┌─────────────────────────────────────────────────────┐
│  📊 보고서 상세 보기                    [X] 닫기    │
├─────────────────────────────────────────────────────┤
│                                                     │
│  거래처: A치과 (KEY001)                            │
│  작성일: 2024-12-17 14:30:25                       │
│  담당자: 김영업                                    │
│  상태: 🔴 미확인                                   │
│                                                     │
│  ─────────────────────────────────────────────      │
│                                                     │
│  💰 목표수금금액                                    │
│     목표: 1,000,000원                              │
│     실적: -                                        │
│     잔액: 1,000,000원                              │
│                                                     │
│  📊 목표매출액                                      │
│     제품: 임플란트                                 │
│     목표: 2,000,000원 (부가세 포함)                │
│     실적: -
│     잔액: 2,000,000원                              │                                      │
│                                                     │
│  📝 영업활동                                        │
│     유형: 방문예정                                 │
│     날짜: 2024-12-20                               │
│     장소: A치과 본점                               │
│     대상자: 원장님                                 │
│     목적: 신제품 소개 및 견적 상담                 │
│                                                     │
│                              [확인하러 가기]        │
└─────────────────────────────────────────────────────┘
```

### 4️⃣ **숫자 입력 자동 포맷팅**

```javascript
// 실시간 천단위 콤마 생성
function formatNumberInput(input) {
    let value = input.value.replace(/[^0-9]/g, '');
    
    if (value === '') return;
    
    // 천단위 콤마 추가
    let formatted = Number(value).toLocaleString('ko-KR');
    input.value = formatted;
    
    // 실제 저장값은 숫자로
    input.dataset.rawValue = value;
}

// 입력 이벤트
input.addEventListener('input', function(e) {
    formatNumberInput(e.target);
});
```

### 5️⃣ **데이터 구조 설계**

### 6️⃣ **구현 계획**

#### Phase 1: UI 구조 (1-2일)

- [ ] 금주보고서 작성 페이지 생성
- [ ] 영업활동 유형별 폼 구현
- [ ] 실적관리 리스트 페이지
- [ ] 모달 상세보기 구현

#### Phase 2: 데이터 처리 (2-3일)

- [ ] IndexedDB 테이블 생성
- [ ] 보고서 CRUD 기능
- [ ] 자동 포맷팅 함수
- [ ] 데이터 검증 로직

#### Phase 3: 비즈니스 로직 (2-3일)

- [ ] 목표/실적 계산
- [ ] 부가세 처리
- [ ] 잔액 관리
- [ ] 자동 업데이트 (6개 컬럼)

#### Phase 4: 권한 처리 (1일)

- [ ] 영업담당 권한 체크
- [ ] 관리자 권한 체크
- [ ] 데이터 필터링

#### Phase 5: 통합 테스트 (1일)

- [ ] 전체 플로우 테스트
- [ ] 엑셀 연동 테스트
- [ ] 성능 최적화

### 7️⃣ **파일 구조**

```
/reports/
├── weekly-report.html        (메인 페이지)
├── weekly-report-write.html  (작성 폼)
├── weekly-report-list.html   (실적관리)
├── css/
│   └── weekly-report.css
├── js/
│   ├── weekly-report-core.js    (핵심 로직)
│   ├── weekly-report-write.js   (작성 기능)
│   ├── weekly-report-confirm.js (확인 기능)
│   └── weekly-report-utils.js   (유틸리티)
└── templates/
    ├── activity-phone.html
    ├── activity-visit.html
    └── activity-document.html
```

### 8️⃣ **검증 규칙**

#### 작성 시

- 거래처 선택: 필수
- 세 항목 중 최소 1개 선택
- 금액: 0 이상 숫자만
- 영업활동: 자유 입력

#### 확인 시

- 최종금액: 필수 입력
- 영업활동 실행: 15자 이상
- 부가세: 자동 계산
- 잔액: 자동 표시

### 9️⃣ **보안 및 성능**

#### 보안

- 본인 데이터만 접근
- XSS 방지 처리
- 입력값 검증

#### 성능

- 페이징 처리 (50건씩)
- 인덱스 최적화
- 캐싱 전략

---

## 📝 작성자 정보

- **작성일**: 2025년 9월 21일
- **버전**: 2.0.0
- **작성자**: KUWOTECH 개발팀
- **문서 위치**: `/docs/기초자료/01_프로그램_개발기초.md`
- **최종 수정**: 금주보고서 시스템 상세 설계 추가

이 시스템은 **데이터의 정확성**과 **표시의 일관성**을 보장하여, 영업 데이터를 효율적으로 관리하는 통합 솔루션입니다.

---

## 📋 금주보고서 시스템 종합 정리

### 📊 금주보고서 시스템 구현 계획 분석

#### 1️⃣ 시스템 구조 이해

현재 시스템은 3단계 프로세스로 구성:

- 작성 단계 → 저장(미확인) → 확인 단계 → 실적 반영

#### 2️⃣ 핵심 구현 포인트

**A. 데이터 구조 설계**

weeklyReports 테이블:

- reportId (자동생성)
- companyId (거래처 ID)
- salesPersonId (영업담당자)
- reportDate (작성일)
- status (미확인/확인)
- targetCollection (목표수금)
- targetSales (목표매출 - 배열)
- salesActivity (영업활동)
- confirmation (확인 데이터)

**B. 영업활동 특이사항 처리 로직**

- 작성 시: 글자수 제한 없음 (자유 입력)
- 확인 시:
  - 실행 선택 → 15자 이상 추가 내용 필수
  - 미실행 선택 → 추가 내용 자유
- 저장 형식: 원본 + 추가내용 + 상태 태그

#### 3️⃣ 구현 순서 계획

**Phase 1: UI 구성**

1. 금주보고서 작성 화면 (모달 또는 새 페이지)
2. 보고서 확인 화면 (관리자/영업담당 공통)
3. 실적관리 목록 화면 (권한별 차별화)

**Phase 2: 기능 구현**

1. 작성 기능
   - 거래처 선택 (기존 데이터 활용)
   - 제품 추가/삭제 동적 처리
   - 선택적 입력 검증

2. 확인 기능
   - 미확인 보고서 필터링
   - 각 항목별 확인 프로세스
   - 누적 데이터 자동 계산

3. 실적 반영
   - companies 테이블 업데이트
   - 누적매출/수금 합산
   - 히스토리 관리

#### 4️⃣ 주요 검증 포인트

**부가세 처리**

- 목표수금: 부가세 무관
- 목표매출: 부가세 포함/제외 구분 처리
- 확인 시: 부가세 포함 ? 금액÷1.1 : 금액

**잔액 관리**

- 목표 - 실적 = 잔액
- 잔액 > 0: 다음 보고서에 이월
- 잔액 = 0: 완료 처리

#### 5️⃣ 기존 시스템과의 연동

**활용할 기존 데이터**

- companies 테이블 (거래처 정보)
- employees 테이블 (영업담당자)
- 제품 목록 (회사 전체 제품)

**업데이트할 필드**

- 누적매출금액
- 누적수금금액
- 판매제품 (콤마 구분 추가)
- 마지막결제일
- 마지막총결재금액

#### 6️⃣ 권한별 차이점

**영업담당모드**

- 본인 거래처만 작성/확인
- 실적관리에서 본인 것만 표시

**관리자모드**

- 전체 보고서 조회 가능
- 영업담당자/부서 정보 추가 표시
- 의견 추가 기능

#### 7️⃣ 예상 파일 구조

```
/reports/
  ├── weekly-report-write.html (작성)
  ├── weekly-report-confirm.html (확인)
  ├── weekly-report-list.html (실적관리)
  ├── weekly-report.css (스타일)
  └── weekly-report.js (로직)
```

---

## 📋 금주보고서 폼 시각화

### 1️⃣ 금주보고서 작성 폼

```
┌─────────────────────────────────────────────────────┐
│  📝 주간/월간/연간보고서 작성          [작성일자]        │
├─────────────────────────────────────────────────────┤
│                                                     │
│  거래처: [▼ A치과 (           ]                       │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ ☐ 💰 목표수금금액                          │   │
│  │   └─ 금액: [_______________] 원            │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ ☐ 📊 목표매출액                            │   │
│  │   ├─ 제품1: [▼임플란트    ]                │   │
│  │   │  금액: [_______________] 원            │   │
│  │   │  부가세: [▼포함]                       │   │
│  │   │                                        │   │
│  │   ├─ 제품2: [▼크라운      ]                │   │
│  │   │  금액: [_______________] 원            │   │
│  │   │  부가세: [▼제외]                       │   │
│  │   │                                        │   │
│  │   └─ [+ 제품 추가]                         │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ ☐ 📝 영업활동(특이사항)                    │   │
│  │   ┌───────────────────────────────────┐     │   │
│  │   │ 신제품 소개 예정입니다.            │     │   │
│  │   │ 원장님이 관심을 보이고 계십니다.   │     │   │
│  │   │ 다음주 상세 설명 예정...          │     │   │
│  │   └───────────────────────────────────┘     │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│        [취소]                    [저장]             │
└─────────────────────────────────────────────────────┘
```

### 2️⃣ 보고서 확인 폼 - 목표수금 확인

```
┌─────────────────────────────────────────────────────┐
│  ✅ 보고서 확인 - A치과                             │
├─────────────────────────────────────────────────────┤
│                                                     │
│  📅 작성일: 2024-12-17                             │
│  👤 영업담당: 김영업                               │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ 💰 목표수금금액 확인                        │   │
│  ├─────────────────────────────────────────────┤   │
│  │                                             │   │
│  │  목표수금금액: 1,000,000 원                 │   │
│  │                                             │   │
│  │  최종수금금액: [_______________] 원 (입력)  │   │
│  │                                             │   │
│  │  잔액: 자동계산 표시                        │   │
│  │                                             │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│                          [확인]     [다음항목 →]    │
└─────────────────────────────────────────────────────┘
```

### 3️⃣ 보고서 확인 폼 - 목표매출 확인

```
┌─────────────────────────────────────────────────────┐
│  ✅ 보고서 확인 - A치과                             │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ 📊 목표매출액 확인                          │   │
│  ├─────────────────────────────────────────────┤   │
│  │                                             │   │
│  │  제품: 임플란트                             │   │
│  │  목표매출금액: 1,100,000 원 (부가세 포함)   │   │
│  │                                             │   │
│  │  최종매출금액: [_______________] 원 (입력)  │   │
│  │                                             │   │
│  │  ─────────────────────────────────          │   │
│  │                                             │   │
│  │  제품: 크라운                               │   │
│  │  목표매출금액: 500,000 원 (부가세 제외)     │   │
│  │                                             │   │
│  │  최종매출금액: [_______________] 원 (입력)  │   │
│  │                                             │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│                          [확인]     [다음항목 →]    │
└─────────────────────────────────────────────────────┘
```

### 4️⃣ 보고서 확인 폼 - 영업활동 확인 ⭐

```
┌─────────────────────────────────────────────────────┐
│  ✅ 보고서 확인 - A치과                             │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │ 📝 영업활동(특이사항) 확인                  │   │
│  ├─────────────────────────────────────────────┤   │
│  │                                             │   │
│  │  【원본 내용】                              │   │
│  │  ┌─────────────────────────────────────┐   │   │
│  │  │ 신제품 소개 예정입니다.            │   │   │
│  │  │ 원장님이 관심을 보이고 계십니다.   │   │   │
│  │  └─────────────────────────────────────┘   │   │
│  │                                             │   │
│  │  【추가 내용】                              │   │
│  │  ┌─────────────────────────────────────┐   │   │
│  │  │                                     │   │   │
│  │  │ (15자 이상 입력 필수 - 실행 시)    │   │   │
│  │  │                                     │   │   │
│  │  └─────────────────────────────────────┘   │   │
│  │                                             │   │
│  │  상태: (●) 실행  ( ) 미실행                │   │
│  │                                             │   │
│  │  ⚠️ 실행 선택 시 15자 이상 필수입니다      │   │
│  │                                             │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│                          [확인]     [완료]          │
└─────────────────────────────────────────────────────┘
```

### 5️⃣ 실적관리 목록 (영업담당모드)

```
┌─────────────────────────────────────────────────────┐
│  📊 실적관리                                        │
├─────────────────────────────────────────────────────┤
│                                                     │
│  필터: [●전체] [○미확인]                           │
│                                                     │
│  ┌───────────────────────────────────────────────┐  │
│  │ 날짜      거래처    내용              상태    │  │
│  ├───────────────────────────────────────────────┤  │
│  │ 12-17    A치과    목표수금:1,000,000  🔴미확인│  │
│  │ 12-17    B치과    목표매출:2,000,000  ✅확인  │  │
│  │ 12-17    C치과    영업활동:신제품소개 🔴미확인│  │
│  │ 12-16    D병원    목표수금:500,000   ✅확인  │  │
│  └───────────────────────────────────────────────┘  │
│                                                     │
│  [이전] 1 2 3 4 5 [다음]                          │
└─────────────────────────────────────────────────────┘
```

### 6️⃣ 실적관리 목록 (관리자모드)

```
┌──────────────────────────────────────────────────────────┐
│  📊 실적관리 (관리자)                                    │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  필터: [●전체] [○미확인]   영업담당: [▼전체]           │
│                                                          │
│  ┌────────────────────────────────────────────────────┐  │
│  │날짜   거래처  담당자  부서     내용         상태   │  │
│  ├────────────────────────────────────────────────────┤  │
│  │12-17  A치과  김영업  영업1팀  목표수금:1M  🔴미확인│  │
│  │12-17  B치과  박영업  영업2팀  목표매출:2M  ✅확인  │  │
│  │12-17  C치과  이영업  영업1팀  영업활동:... 🔴미확인│  │
│  │12-16  D병원  최영업  영업3팀  목표수금:5K  ✅확인  │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  💬 관리자 의견 추가:                                    │
│  [_________________________________________________]     │
│                                           [의견 저장]    │
└──────────────────────────────────────────────────────────┘
```

### 📌 주요 특징

- **선택적 입력**: 체크박스로 필요한 항목만 선택
- **동적 제품 추가**: "+ 제품 추가" 버튼으로 확장
- **영업활동 글자수**: 작성 시 무제한, 확인 시 조건부 제한
- **상태 표시**: 🔴미확인 / ✅확인 시각적 구분
- **권한별 차이**: 관리자는 담당자/부서 정보 추가 표시

---

## 📊 실적보고서 시스템 전체 구조

### 🔄 시스템 플로우 개요

```
영업담당 → 실적보고서 작성 (주간/월간/연간)
    ↓
관리자 → 실적보고서 확인 
    ↓
전체 → 보고서 발표 (다양한 필터링)
```

### 1️⃣ **실적보고서 작성 메뉴 구조**

#### A. 영업담당모드 사이드메뉴

```
📁 실적보고서 작성
  ├── 📝 주간 보고서 (매주)
  ├── 📅 월간 보고서 
  └── 📊 연간 보고서 (목표 설정)
```

#### B. 보고서별 작성 항목

```
┌─────────────────────────────────────────────┐
│         보고서 작성 공통 항목                │
├─────────────────────────────────────────────┤
│ 1. 💰 목표수금금액                          │
│ 2. 📊 목표매출금액                          │
│ 3. 📝 영업활동(특이사항)                    │
└─────────────────────────────────────────────┘
```

### 2️⃣ **실적보고서 확인 메뉴**

#### A. 영업담당모드 - 실적보고서 확인

```
┌──────────────────────────────────────────────────┐
│  📋 실적보고서 확인 (영업담당)                   │
├──────────────────────────────────────────────────┤
│                                                  │
│  ┌────────────────────────────────────────┐     │
│  │ 💰 목표수금금액                         │     │
│  │    - 목표: 5,000,000원                  │     │
│  │    - 실적: 3,500,000원                  │     │
│  │    - 달성률: 70%                        │     │
│  └────────────────────────────────────────┘     │
│                                                  │
│  ┌────────────────────────────────────────┐     │
│  │ 📊 목표매출금액                         │     │
│  │    - 목표: 10,000,000원                 │     │
│  │    - 실적: 8,500,000원                  │     │
│  │    - 달성률: 85%                        │     │
│  └────────────────────────────────────────┘     │
│                                                  │
│  ┌────────────────────────────────────────┐     │
│  │ 📝 영업활동(특이사항)                   │     │
│  │    - 신규 거래처 3곳 개척              │     │
│  │    - A치과 신제품 도입 예정            │     │
│  │    - B병원 재계약 협상 중              │     │
│  └────────────────────────────────────────┘     │
└──────────────────────────────────────────────────┘
```

#### B. 관리자모드 - 실적보고서 확인

```
┌──────────────────────────────────────────────────┐
│  📋 실적보고서 확인 (관리자)                     │
├──────────────────────────────────────────────────┤
│                                                  │
│  필터: [▼전체부서] [▼전체담당자] [▼이번주]     │
│                                                  │
│  ┌────────────────────────────────────────┐     │
│  │ 담당자: 김영업 | 부서: 영업1팀          │     │
│  ├────────────────────────────────────────┤     │
│  │ 💰 목표수금금액                         │     │
│  │    - 목표: 5,000,000원                  │     │
│  │    - 실적: 3,500,000원                  │     │
│  │    - 달성률: 70%                        │     │
│  ├────────────────────────────────────────┤     │
│  │ 📊 목표매출금액                         │     │
│  │    - 목표: 10,000,000원                 │     │
│  │    - 실적: 8,500,000원                  │     │
│  │    - 달성률: 85%                        │     │
│  ├────────────────────────────────────────┤     │
│  │ 📝 영업활동(특이사항)                   │     │
│  │    - 신규 거래처 3곳 개척              │     │
│  │    - A치과 신제품 도입 예정            │     │
│  │    - B병원 재계약 협상 중              │     │
│  └────────────────────────────────────────┘     │
│                                                  │
 💬 관리자 의견 추가:                                    │
│  [_________________________________________________]     │
│                                           [의견 저장]    │
└──────────────────────────────────────────────────────────┘
```

### 3️⃣ **보고서 발표 메뉴**

#### A. 보고서 발표 필터 옵션

```
┌──────────────────────────────────────────────────┐
│  🎯 보고서 발표                                   │
├──────────────────────────────────────────────────┤
│                                                  │
│  기간별 필터:                                    │
│  ├── 주간: [●금주] [○전주]                      │
│  ├── 월간: [▼2024년 12월]                       │                            │                            │
│  └── 연간: [▼2024년]                            │
│                                                  │
│  그룹별 필터:                                    │
│  ├── 부서별: [▼전체부서] [▼영업1팀] [▼영업2팀] │
│  └── 담당자별: [▼전체] [▼김영업] [▼박영업]     │
└──────────────────────────────────────────────────┘
```

#### B. 보고서 발표 대시보드

```
┌──────────────────────────────────────────────────┐
│  📊 부서별 실적 발표 (2024년 12월 4주차)         │
├──────────────────────────────────────────────────┤
│                                                  │
│  ┌─────────────────────────────────────┐        │
│  │ 영업1팀 실적                         │        │
│  │ ├── 목표수금: 20,000,000원           │        │
│  │ ├── 실적수금: 18,500,000원 (92.5%)   │        │
│  │ ├── 목표매출: 50,000,000원           │        │
│  │ └── 실적매출: 45,000,000원 (90%)     │        │
│  └─────────────────────────────────────┘        │
│                                                  │
│  ┌─────────────────────────────────────┐        │
│  │ 영업2팀 실적                         │        │
│  │ ├── 목표수금: 15,000,000원           │        │
│  │ ├── 실적수금: 16,000,000원 (106.7%)  │        │
│  │ ├── 목표매출: 40,000,000원           │        │
│  │ └── 실적매출: 42,000,000원 (105%)    │        │
│  └─────────────────────────────────────┘        │
│                                                  │
│  [📈 차트 보기]     │
└──────────────────────────────────────────────────┘
```

### 4️⃣ **보고서 종류별 상세 구조**

#### A. 주간 보고서
```
주간 보고서 (매주 작성)
├── 작성 주기: 매주 금요일
├── 대상 기간: 월~금
├── 주요 항목:
│   ├── 주간 목표수금/실적
│   ├── 주간 목표매출/실적
│   └── 주간 영업활동 내역
└── 확인: 다음주 월요일
```

#### B. 월간 보고서
```
월간 보고서
├── 작성 주기: 매월 말일
├── 대상 기간: 1일~말일
├── 주요 항목:
│   ├── 월간 목표수금/실적 (주간 합산)
│   ├── 월간 목표매출/실적 (주간 합산)
│   └── 월간 주요 성과 요약
└── 확인: 다음달 5일 이내
```

#### C. 연간 보고서
```
연간 보고서 (목표 설정)
├── 작성 주기: 연초 (목표), 연말 (실적)
├── 대상 기간: 1월~12월
├── 주요 항목:
│   ├── 연간 목표수금 설정
│   ├── 연간 목표매출 설정
│   ├── 분기별 목표 배분
│   └── 전략 및 실행 계획
└── 확인: 분기별 점검
```

### 5️⃣ **시스템 권한별 접근 범위**

```
┌────────────────────────────────────────────────┐
│            권한별 메뉴 접근 권한                │
├────────────────────────────────────────────────┤
│                                                │
│ 영업담당:                                      │
│ ✅ 실적보고서 작성 (본인)                     │
│ ✅ 실적보고서 확인 (본인)                     │
│ ✅ 보고서 발표 (조회만)                       │
│                                                │
│ 관리자:                                        │
│ ❌ 실적보고서 작성                            │
│ ✅ 실적보고서 확인 (전체)                     │
│ ✅ 보고서 발표 (조회/편집/승인)               │
└────────────────────────────────────────────────┘
```

### 6️⃣ **데이터 플로우**

```
[영업담당 작성]
    ↓
[자동 저장 (미확인 상태)]
    ↓
[관리자 확인/승인]
    ↓
[실적 데이터 반영]
    ↓
[보고서 발표 자료 생성]
    ↓
[대시보드 표시]
```

### 7️⃣ **보고서 발표 화면 예시**

#### 담당자별 비교 (주간)
```
┌──────────────────────────────────────────────────┐
│  👥 담당자별 실적 비교 (금주 vs 전주)            │
├──────────────────────────────────────────────────┤
│                                                  │
│  담당자    금주수금    전주수금    증감율       │
│  ────────────────────────────────────────        │
│  김영업    5,000,000   4,500,000   +11.1%       │
│  박영업    4,800,000   5,200,000   -7.7%        │
│  이영업    6,200,000   5,800,000   +6.9%        │
│  최영업    3,500,000   3,500,000   0.0%         │
│  ────────────────────────────────────────        │
│  합계     19,500,000  19,000,000   +2.6%        │
│                                                  │
│  [상세보기]                    │
└──────────────────────────────────────────────────┘
```

### 📌 실적보고서 시스템 주요 특징

- **다층적 보고 체계**: 주간 → 월간 → 연간
- **통합 확인 시스템**: 목표수금, 목표매출, 영업활동
- **유연한 발표 도구**: 기간별, 부서별, 담당자별 필터링
- **권한 기반 접근**: 영업담당은 작성, 관리자는 확인/승인
- **실시간 달성률 추적**: 목표 대비 실적 자동 계산
- **다양한 비교 분석**: 전주/전월/전년 대비 성과 분석

---

## 📱 최종 사이드 메뉴 구조

### 🔷 영업담당모드 사이드메뉴 (6개)

```
┌─────────────────────────────────────────┐
│  👤 영업담당 메뉴                       │
├─────────────────────────────────────────┤
│                                         │
│  🏠 대시보드                            │
│    └─ KPI 14개 지표 (개인 실적)        │
│                                         │
│  📊 담당거래처 관리                     │
│    └─ 본인 담당 거래처만               │
│                                         │
│  📝 실적보고서 작성                     │
│    ├─ 주간 보고서                      │
│    ├─ 월간 보고서                      │
│    └─ 연간 보고서                      │
│                                         │
│  ✅ 실적보고서 확인                     │
│    └─ 본인 작성 보고서                 │
│                                         │
│  📥 데이터 관리                         │
│    └─ 엑셀 다운로드 (본인)             │
│                                         │
│  ⚙️ 시스템 설정                         │
│    └─ 개인 설정                        │
│                                         │
└─────────────────────────────────────────┘
```

### 🔶 관리자모드 사이드메뉴 (7개)

```
┌─────────────────────────────────────────┐
│  👨‍💼 관리자 메뉴                         │
├─────────────────────────────────────────┤
│                                         │
│  🏠 대시보드                            │
│    └─ 전사 KPI 11개 지표               │
│                                         │
│  📊 전체거래처 관리                     │
│    └─ 모든 거래처 조회/수정            │
│                                         │
│  ✅ 실적보고서 확인                     │
│    └─ 전체 보고서 확인/승인            │
│                                         │
│  📈 보고서 발표                         │
│    ├─ 부서별 실적                      │
│    ├─ 담당자별 실적                    │
│    └─ 기간별 분석                      │
│                                         │
│  📥 데이터 관리                         │
│    ├─ 엑셀 업로드 (강정환)             │
│    └─ 엑셀 다운로드 (전체)             │
│                                         │
│  👥 직원 관리                           │
│    └─ 직원 목록/권한                   │
│                                         │
│  ⚙️ 시스템 설정                         │
│    └─ 전체 시스템 설정                 │
│                                         │
└─────────────────────────────────────────┘
```

### 📋 메뉴별 권한 요약

| 메뉴 | 영업담당 | 관리자 |
|------|----------|--------|
| 대시보드 | 개인 KPI | 전사 KPI |
| 거래처 관리 | 담당거래처만 | 전체거래처 |
| 실적보고서 작성 | ✅ | ❌ |
| 실적보고서 확인 | 본인만 | 전체 |
| 보고서 발표 | ❌ | ✅ |
| 데이터 관리 | 본인 다운로드 | 업로드/전체 다운로드 |
| 직원 관리 | ❌ | ✅ |
| 시스템 설정 | 개인 설정 | 전체 설정 |
