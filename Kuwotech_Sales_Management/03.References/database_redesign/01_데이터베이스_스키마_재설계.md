# ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì¬ì„¤ê³„ - KUWOTECH ì˜ì—…ê´€ë¦¬ì‹œìŠ¤í…œ

## ğŸ“‹ ëª©ì°¨
1. [í˜„ì¬ ë¬¸ì œì  ë¶„ì„](#1-í˜„ì¬-ë¬¸ì œì -ë¶„ì„)
2. [ì‚¬ì´ë“œë©”ë‰´ë³„ ë°ì´í„° ì‚¬ìš© ë¶„ì„](#2-ì‚¬ì´ë“œë©”ë‰´ë³„-ë°ì´í„°-ì‚¬ìš©-ë¶„ì„)
3. [ë¡œê·¸ì¸ë³„ ë°ì´í„° ì‚¬ìš© ë¶„ì„](#3-ë¡œê·¸ì¸ë³„-ë°ì´í„°-ì‚¬ìš©-ë¶„ì„)
4. [ìƒˆë¡œìš´ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#4-ìƒˆë¡œìš´-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
5. [ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš](#5-ë§ˆì´ê·¸ë ˆì´ì…˜-ê³„íš)

---

## 1. í˜„ì¬ ë¬¸ì œì  ë¶„ì„

### 1-1. í˜„ì¬ ìŠ¤í‚¤ë§ˆ êµ¬ì¡°

```javascript
// í˜„ì¬ IndexedDB ìŠ¤í† ì–´ (5ê°œ)
KuwotechSalesDB
â”œâ”€â”€ companies      // ê±°ë˜ì²˜ ì •ë³´ (18ê°œ í•„ë“œ)
â”œâ”€â”€ employees      // ì§ì› ì •ë³´
â”œâ”€â”€ reports        // ë³´ê³ ì„œ ì •ë³´
â”œâ”€â”€ changeHistory  // ë³€ê²½ ì´ë ¥
â””â”€â”€ backups        // ë°±ì—… ì •ë³´
```

### 1-2. ë°œê²¬ëœ ë¬¸ì œì 

#### âŒ ë¬¸ì œ 1: ë¶ˆí•„ìš”í•œ í•„ë“œ í˜¼ì¬
- `companies` ìŠ¤í† ì–´ì— 19ê°œ í•„ë“œê°€ ìˆì§€ë§Œ, ì‹¤ì œ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í•„ë“œ ì¡´ì¬
- ERP ê´€ë ¨ í•„ë“œì™€ ë‚´ë¶€ ì‹œìŠ¤í…œ í•„ë“œê°€ í˜¼ì¬
- ìë™ ì—…ë°ì´íŠ¸ í•„ë“œì™€ ìˆ˜ë™ ì…ë ¥ í•„ë“œê°€ ëª…í™•íˆ êµ¬ë¶„ë˜ì§€ ì•ŠìŒ

#### âŒ ë¬¸ì œ 2: ì¤‘ë³µ ë°ì´í„° êµ¬ì¡°
- ì—‘ì…€ ì‹œíŠ¸ì™€ IndexedDB êµ¬ì¡°ê°€ ë¶ˆì¼ì¹˜
- ê°™ì€ ì •ë³´ê°€ ì—¬ëŸ¬ ê³³ì— ì €ì¥ë¨
- ë°ì´í„° ë™ê¸°í™” ë³µì¡ë„ ì¦ê°€

#### âŒ ë¬¸ì œ 3: ê¶Œí•œ ê´€ë¦¬ ë¶ˆëª…í™•
- ì–´ë–¤ í•„ë“œë¥¼ ëˆ„ê°€ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ”ì§€ ìŠ¤í‚¤ë§ˆì— ëª…ì‹œë˜ì§€ ì•ŠìŒ
- ì˜ì—…ë‹´ë‹¹ê³¼ ê´€ë¦¬ìì˜ ì ‘ê·¼ ê¶Œí•œì´ ì½”ë“œì—ë§Œ ì¡´ì¬

#### âŒ ë¬¸ì œ 4: ë³´ê³ ì„œ ë°ì´í„° êµ¬ì¡° ë¯¸ë¹„
- ì°¸ê³ ë¬¸ì„œì—ì„œëŠ” ê¸ˆì£¼ë³´ê³ ì„œ ì‹œìŠ¤í…œì´ ìƒì„¸í•˜ê²Œ ì •ì˜ë˜ì–´ ìˆìŒ
- í˜„ì¬ ìŠ¤í‚¤ë§ˆì—ì„œëŠ” ë‹¨ìˆœ `reports` ìŠ¤í† ì–´ë§Œ ì¡´ì¬
- ëª©í‘œìˆ˜ê¸ˆ, ëª©í‘œë§¤ì¶œ, ì˜ì—…í™œë™ ë“±ì˜ ì„¸ë¶€ êµ¬ì¡° ì—†ìŒ

---

## 2. ì‚¬ì´ë“œë©”ë‰´ë³„ ë°ì´í„° ì‚¬ìš© ë¶„ì„

### 2-1. ì˜ì—…ë‹´ë‹¹ ëª¨ë“œ (6ê°œ ë©”ë‰´)

#### ğŸ“Š ëŒ€ì‹œë³´ë“œ
**ì‚¬ìš© ë°ì´í„°:**
- âœ… companies (ë³¸ì¸ ë‹´ë‹¹ë§Œ)
- âœ… employees (ë³¸ì¸ ì •ë³´)
- âœ… reports (ë³¸ì¸ ì‘ì„±)

**í•„ìš” í•„ë“œ:**
```javascript
// companiesì—ì„œ ì‚¬ìš©
{
  keyValue,
  finalCompanyName,
  internalManager,      // í•„í„°ë§ìš©
  businessStatus,
  salesProduct,
  accumulatedSales,     // KPI ê³„ì‚°
  accumulatedCollection,// KPI ê³„ì‚°
  accountsReceivable,   // KPI ê³„ì‚°
  lastPaymentDate
}

// employeesì—ì„œ ì‚¬ìš©
{
  name,
  role,
  hireDate            // í˜„ì¬ì›”ìˆ˜ ê³„ì‚°
}
```

**ë¶ˆí•„ìš” í•„ë“œ:**
- companyCode (ERP ì „ìš©)
- externalManager (í˜„ì¬ ë¯¸ì‚¬ìš©)
- remarks (íŠ¹ì´ì‚¬í•­ì€ businessActivityì— í†µí•©)

---

#### ğŸ“Š ë‹´ë‹¹ê±°ë˜ì²˜ ê´€ë¦¬
**ì‚¬ìš© ë°ì´í„°:**
- âœ… companies (ë³¸ì¸ ë‹´ë‹¹ë§Œ - CRUD)
- âŒ reports (ì¡°íšŒë§Œ)

**í•„ìš” í•„ë“œ:**
```javascript
// companies - ì „ì²´ 19ê°œ í•„ë“œ
{
  keyValue,                  // PK
  companyNameERP,            // ERP ê±°ë˜ì²˜ëª… (ì½ê¸° ì „ìš©)
  finalCompanyName,          // ìµœì¢…ê±°ë˜ì²˜ëª… (ìˆ˜ì • ê°€ëŠ¥)
  representative,            // ëŒ€í‘œìëª… (ìˆ˜ì • ê°€ëŠ¥)
  internalManager,           // ë‚´ë¶€ë‹´ë‹¹ì (ìˆ˜ì • ê°€ëŠ¥)
  businessStatus,            // ê±°ë˜ìƒíƒœ (ìˆ˜ì • ê°€ëŠ¥)
  salesProduct,              // íŒë§¤ì œí’ˆ (ìë™ ì—…ë°ì´íŠ¸)
  accumulatedSales,          // ëˆ„ì ë§¤ì¶œ (ìë™ ì—…ë°ì´íŠ¸)
  accumulatedCollection,     // ëˆ„ì ìˆ˜ê¸ˆ (ìë™ ì—…ë°ì´íŠ¸)
  accountsReceivable,        // ì™¸ìƒë§¤ì¶œê¸ˆ (ì½ê¸° ì „ìš©)
  lastPaymentDate,           // ë§ˆì§€ë§‰ê²°ì œì¼ (ìë™ ì—…ë°ì´íŠ¸)
  lastPaymentAmount,         // ë§ˆì§€ë§‰ê²°ì œê¸ˆì•¡ (ìë™ ì—…ë°ì´íŠ¸)
  businessActivity,          // ì˜ì—…í™œë™ë‚´ìš© (ìˆ˜ì • ê°€ëŠ¥)
  createdAt,
  updatedAt,
  updatedBy
}
```

**ê¶Œí•œ êµ¬ë¶„ í•„ìš”:**
- ì½ê¸° ì „ìš©: companyNameERP, accountsReceivable
- ìˆ˜ì • ê°€ëŠ¥: finalCompanyName, representative, internalManager, businessStatus, businessActivity
- ìë™ ì—…ë°ì´íŠ¸: salesProduct, accumulated*, lastPayment*

---

#### ğŸ“ ì‹¤ì ë³´ê³ ì„œ ì‘ì„±
**ì‚¬ìš© ë°ì´í„°:**
- âœ… companies (ê±°ë˜ì²˜ ì„ íƒìš©)
- âœ… reports (ì‘ì„±)

**í•„ìš” í•„ë“œ:**
```javascript
// reports - ê¸ˆì£¼ë³´ê³ ì„œ êµ¬ì¡°
{
  reportId,                  // PK (ìë™ìƒì„±)
  reportType,                // ë³´ê³ ì„œ ìœ í˜• (ì£¼ê°„/ì›”ê°„/ì—°ê°„)
  submittedBy,               // ì‘ì„±ì
  submittedDate,             // ì œì¶œì¼
  companyId,                 // ê±°ë˜ì²˜ ID (keyValue)
  
  // ëª©í‘œìˆ˜ê¸ˆê¸ˆì•¡ (ì„ íƒ)
  targetCollection: {
    amount: number,
    currency: 'KRW'
  },
  
  // ëª©í‘œë§¤ì¶œì•¡ (ì„ íƒ, ë³µìˆ˜)
  targetSales: [{
    product: string,
    amount: number,
    vatIncluded: boolean
  }],
  
  // ì˜ì—…í™œë™(íŠ¹ì´ì‚¬í•­) (ì„ íƒ)
  activity: {
    content: string,        // ì‘ì„± ë‚´ìš©
    status: string,         // ì‹¤í–‰/ë¯¸ì‹¤í–‰
    executedBy: string      // ì‹¤í–‰ì
  },
  
  // ê´€ë¦¬ì í™•ì¸ (ë³´ê³ ì„œ í™•ì¸ ì‹œ ì±„ì›Œì§)
  confirmation: {
    finalCollection: number,    // ìµœì¢…ìˆ˜ê¸ˆê¸ˆì•¡
    finalSales: number,         // ìµœì¢…ë§¤ì¶œê¸ˆì•¡
    activityComment: string,    // ê´€ë¦¬ì ì¶”ê°€ ì½”ë©˜íŠ¸
    confirmedBy: string,
    confirmedDate: date
  },
  
  status,                    // ë¯¸í™•ì¸/í™•ì¸
  createdAt,
  updatedAt
}
```

---

#### âœ… ì‹¤ì ë³´ê³ ì„œ í™•ì¸
**ì‚¬ìš© ë°ì´í„°:**
- âœ… reports (ë³¸ì¸ ì‘ì„±, ì½ê¸° ì „ìš©)
- âœ… companies (ê´€ë ¨ ê±°ë˜ì²˜ ì •ë³´)

**í•„ìš” í•„ë“œ:**
- reportsì˜ ëª¨ë“  í•„ë“œ (ì½ê¸° ì „ìš©)

---

#### ğŸ“¥ ë°ì´í„° ê´€ë¦¬
**ì‚¬ìš© ë°ì´í„°:**
- âœ… companies (ë³¸ì¸ ë‹´ë‹¹, ë‹¤ìš´ë¡œë“œ)
- âœ… reports (ë³¸ì¸ ì‘ì„±, ë‹¤ìš´ë¡œë“œ)
- âœ… employees (ë³¸ì¸ ì •ë³´)

**ë‹¤ìš´ë¡œë“œ í•„ìš” ë°ì´í„°:**
```javascript
// 3ê°€ì§€ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
1. ê¸°ë³¸ì •ë³´_[ë‹´ë‹¹ìëª…].xlsx
   - companies (ë³¸ì¸ ë‹´ë‹¹ í•„í„°ë§)
   
2. ë°©ë¬¸ë³´ê³ ì„œ_[ë‹´ë‹¹ìëª…].xlsx
   - reports (ë³¸ì¸ ì‘ì„± í•„í„°ë§)
   
3. ì˜ì—…ì‹¤ì _[ë‹´ë‹¹ìëª…].xlsx
   - KPI ê³„ì‚° ê²°ê³¼
```

---

#### âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì •
**ì‚¬ìš© ë°ì´í„°:**
- âœ… employees (ë³¸ì¸ ì •ë³´ ìˆ˜ì •)

**í•„ìš” í•„ë“œ:**
```javascript
{
  name,
  email,
  phone,
  department,
  role,
  hireDate
}
```

---

### 2-2. ê´€ë¦¬ì ëª¨ë“œ (7ê°œ ë©”ë‰´)

#### ğŸ  ëŒ€ì‹œë³´ë“œ
**ì‚¬ìš© ë°ì´í„°:**
- âœ… companies (ì „ì²´)
- âœ… employees (ì „ì²´)
- âœ… reports (ì „ì²´)

**í•„ìš” í•„ë“œ:**
- ì „ì‚¬ KPI ê³„ì‚°ìš© - companiesì˜ ëª¨ë“  í•„ë“œ

---

#### ğŸ“Š ì „ì²´ê±°ë˜ì²˜ ê´€ë¦¬
**ì‚¬ìš© ë°ì´í„°:**
- âœ… companies (ì „ì²´ CRUD)
- âœ… employees (ë‹´ë‹¹ì ëª©ë¡)

**í•„ìš” í•„ë“œ:**
- companiesì˜ ëª¨ë“  í•„ë“œ
- employeesì˜ name, role, department

**ê¶Œí•œ íŠ¹ì´ì‚¬í•­:**
- companyNameERP ìˆ˜ì • ê°€ëŠ¥
- accountsReceivable ìˆ˜ì • ê°€ëŠ¥ (ì›”ë§ ì¼ê´„ ì—…ë°ì´íŠ¸)

---

#### âœ… ì‹¤ì ë³´ê³ ì„œ í™•ì¸
**ì‚¬ìš© ë°ì´í„°:**
- âœ… reports (ì „ì²´, ìŠ¹ì¸/ë°˜ë ¤)
- âœ… companies (ê´€ë ¨ ê±°ë˜ì²˜)
- âœ… employees (ì‘ì„±ì ì •ë³´)

**í•„ìš” í•„ë“œ:**
```javascript
// reports - í™•ì¸ í”„ë¡œì„¸ìŠ¤
{
  reportId,
  reportType,
  submittedBy,
  submittedDate,
  companyId,
  targetCollection,
  targetSales,
  activity,
  
  // ê´€ë¦¬ì í™•ì¸ (ì…ë ¥)
  confirmation: {
    finalCollection: number,      // ì…ë ¥
    finalSales: number,           // ì…ë ¥
    activityComment: string,      // ì…ë ¥ (ì‹¤í–‰ ì‹œ 15ì ì´ìƒ)
    activityStatus: string,       // ì‹¤í–‰/ë¯¸ì‹¤í–‰ ì„ íƒ
    confirmedBy: string,          // ìë™
    confirmedDate: date           // ìë™
  },
  
  status,              // ë¯¸í™•ì¸ â†’ í™•ì¸ (ìë™)
  processedBy,         // ê´€ë¦¬ì ID (ìë™)
  processedDate        // ì²˜ë¦¬ì¼ (ìë™)
}
```

**ìë™ ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°:**
- ë³´ê³ ì„œ í™•ì¸ ì™„ë£Œ ì‹œ â†’ companies ì—…ë°ì´íŠ¸
  - salesProduct += ì‹ ê·œì œí’ˆ
  - lastPaymentDate = confirmedDate
  - lastPaymentAmount = finalSales
  - accumulatedCollection += finalCollection
  - accumulatedSales += finalSales (ë¶€ê°€ì„¸ ì²˜ë¦¬)
  - businessActivity += confirmation.activityComment

---

#### ğŸ“ˆ ë³´ê³ ì„œ ë°œí‘œ
**ì‚¬ìš© ë°ì´í„°:**
- âœ… reports (ì „ì²´, í†µê³„)
- âœ… companies (ë§¤ì¶œ ê´€ë ¨)
- âœ… employees (ë‹´ë‹¹ìë³„ í†µê³„)

**í•„ìš” í•„ë“œ:**
- reportsì˜ ì£¼ìš” ê¸ˆì•¡ í•„ë“œ
- companiesì˜ ëˆ„ì  ê¸ˆì•¡
- employeesì˜ ë‹´ë‹¹ì ì •ë³´

---

#### ğŸ“¥ ë°ì´í„° ê´€ë¦¬ â­
**ì‚¬ìš© ë°ì´í„°:**
- âœ… companies (ì „ì²´, ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ)
- âœ… reports (ì „ì²´, ë‹¤ìš´ë¡œë“œ)
- âœ… employees (ì „ì²´, ë‹¤ìš´ë¡œë“œ)
- âœ… changeHistory (ì „ì²´, ë‹¤ìš´ë¡œë“œ)
- âœ… backups (ë°±ì—… ìƒì„±)

**í•µì‹¬ ê¸°ëŠ¥:**
1. ì—‘ì…€ ì—…ë¡œë“œ (ê°•ì •í™˜ ì „ìš©)
   - ê¸°ì¡´ ë°ì´í„° â†’ ë°±ì—…
   - ìƒˆ ë°ì´í„° â†’ companies ìŠ¤í† ì–´
   
2. ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
   - ì˜ì—…ê´€ë¦¬ê¸°ì´ˆìë£Œ_ë°±ì—…_[ë‚ ì§œ].xlsx
   - ì‹œíŠ¸: ê¸°ë³¸ì •ë³´, ë°©ë¬¸ë³´ê³ ì„œ_ì „ì²´, ì§ì›ì •ë³´, ë³€ê²½ì´ë ¥

---

#### ğŸ‘¥ ì§ì› ê´€ë¦¬
**ì‚¬ìš© ë°ì´í„°:**
- âœ… employees (ì „ì²´ CRUD)

**í•„ìš” í•„ë“œ:**
```javascript
{
  id,                  // PK (ìë™)
  name,
  email,
  phone,
  department,
  role,                // ì˜ì—…ë‹´ë‹¹/ê´€ë¦¬ì
  hireDate,
  status,              // ì¬ì§/í‡´ì‚¬
  createdAt,
  updatedAt
}
```

---

#### âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì •
**ì‚¬ìš© ë°ì´í„°:**
- âœ… systemSettings (ì‹ ê·œ ìŠ¤í† ì–´ í•„ìš”)

**í•„ìš” í•„ë“œ:**
```javascript
{
  key: string,         // PK
  value: any,
  description: string,
  updatedAt: date,
  updatedBy: string
}
```

**ì„¤ì • í•­ëª©:**
- ìë™ ë°±ì—… ì‹œê°„
- ë°±ì—… ë³´ê´€ ê¸°ê°„
- KPI ìºì‹œ TTL
- í…Œë§ˆ ì„¤ì •
- ì•Œë¦¼ ì„¤ì •

---

## 3. ë¡œê·¸ì¸ë³„ ë°ì´í„° ì‚¬ìš© ë¶„ì„

### 3-1. ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤

```
Stage 1: íšŒì‚¬ í™•ì¸ (kjh/1234)
  â†“
Stage 2: ì—‘ì…€ ì¸ì¦ (ì„ íƒ)
  - ì—‘ì…€ ì—…ë¡œë“œ â†’ companies, employees ì €ì¥
  â†“
Stage 3: ë¶€ì„œ ì„ íƒ
  - employees ìŠ¤í† ì–´ì—ì„œ ë¶€ì„œ ëª©ë¡ ì¡°íšŒ
  â†“
Stage 4: ì‚¬ìš©ì ì •ë³´ ì…ë ¥
  - ì´ë¦„, ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
  â†“
Stage 4.5: ë¹„ë°€ë²ˆí˜¸ í™•ì¸
  - employees ìŠ¤í† ì–´ì—ì„œ ê²€ì¦
  â†“
Stage 5: ìµœì¢… í™•ì¸
  - ì—­í• (ì˜ì—…ë‹´ë‹¹/ê´€ë¦¬ì) í™•ì¸
  - sessionStorageì— ì €ì¥
  â†“
ì˜ì—…ë‹´ë‹¹ ëª¨ë“œ or ê´€ë¦¬ì ëª¨ë“œ ì§„ì…
```

**ë¡œê·¸ì¸ ì‹œ í•„ìš” ë°ì´í„°:**
- âœ… employees (ì „ì²´)
  - ë¶€ì„œ ëª©ë¡
  - ì‚¬ìš©ì ê²€ì¦
  - ì—­í•  í™•ì¸

---

### 3-2. ì„¸ì…˜ ë°ì´í„°

```javascript
// sessionStorage ì €ì¥ ì •ë³´
{
  userId: string,          // ì§ì› ID
  userName: string,        // ì´ë¦„
  role: string,            // ì—­í•  (sales/admin)
  department: string,      // ë¶€ì„œ
  hireDate: string,        // ì…ì‚¬ì¼
  loginTime: timestamp,    // ë¡œê·¸ì¸ ì‹œê°„
  lastActivity: timestamp  // ë§ˆì§€ë§‰ í™œë™
}
```

---

## 4. ìƒˆë¡œìš´ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### 4-1. ìŠ¤í‚¤ë§ˆ ê°œìš”

```javascript
KuwotechSalesDB v4
â”œâ”€â”€ companies           // ê±°ë˜ì²˜ ì •ë³´ (16ê°œ í•„ë“œ) â¬‡ï¸ ì¶•ì†Œ
â”œâ”€â”€ employees           // ì§ì› ì •ë³´ (10ê°œ í•„ë“œ)
â”œâ”€â”€ reports             // ë³´ê³ ì„œ ì •ë³´ (15ê°œ í•„ë“œ) â¬†ï¸ í™•ì¥
â”œâ”€â”€ changeHistory       // ë³€ê²½ ì´ë ¥ (8ê°œ í•„ë“œ)
â”œâ”€â”€ backups             // ë°±ì—… ì •ë³´ (6ê°œ í•„ë“œ)
â””â”€â”€ systemSettings      // ì‹œìŠ¤í…œ ì„¤ì • (5ê°œ í•„ë“œ) âœ¨ ì‹ ê·œ
```

---

### 4-2. companies ìŠ¤í† ì–´ (ê±°ë˜ì²˜ ì •ë³´)

```javascript
{
  // ===== Primary Key =====
  keyValue: string,              // KEY VALUE (ë³€ê²½ ë¶ˆê°€)
  
  // ===== ê¸°ë³¸ ì •ë³´ (ERP ì—°ë™) =====
  companyNameERP: string,        // ê±°ë˜ì²˜ëª…(ERP) - ì½ê¸° ì „ìš©
  finalCompanyName: string,      // ìµœì¢…ê±°ë˜ì²˜ëª… - ìˆ˜ì • ê°€ëŠ¥
  representative: string,        // ëŒ€í‘œìëª…
  
  // ===== ë‹´ë‹¹ ì •ë³´ =====
  internalManager: string,       // ë‚´ë¶€ë‹´ë‹¹ì (ì˜ì—…ì‚¬ì›)
  department: string,            // ë‹´ë‹¹ë¶€ì„œ
  
  // ===== ê±°ë˜ ìƒíƒœ =====
  businessStatus: string,        // ê±°ë˜ìƒíƒœ (í™œì„±/ë¹„í™œì„±/ë¶ˆìš©/ì¶”ê°€í™•ì¸)
  
  // ===== íŒë§¤ ì •ë³´ (ìë™ ì—…ë°ì´íŠ¸) =====
  salesProduct: string,          // íŒë§¤ì œí’ˆ (ì½¤ë§ˆ êµ¬ë¶„)
  accumulatedSales: number,      // ëˆ„ì ë§¤ì¶œê¸ˆì•¡ (ìë™)
  accumulatedCollection: number, // ëˆ„ì ìˆ˜ê¸ˆê¸ˆì•¡ (ìë™)
  accountsReceivable: number,    // ì™¸ìƒë§¤ì¶œê¸ˆ(ì”ì•¡) - ê´€ë¦¬ìë§Œ ìˆ˜ì •
  
  // ===== ê²°ì œ ì •ë³´ (ìë™ ì—…ë°ì´íŠ¸) =====
  lastPaymentDate: string,       // ë§ˆì§€ë§‰ê²°ì œì¼ (YYYY-MM-DD)
  lastPaymentAmount: number,     // ë§ˆì§€ë§‰ê²°ì œê¸ˆì•¡
  
  // ===== ì˜ì—… í™œë™ (ëˆ„ì  ê¸°ë¡) =====
  businessActivity: string,      // ì˜ì—…í™œë™ë‚´ìš© (íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨)
  
  // ===== ë©”íƒ€ ì •ë³´ =====
  createdAt: string,             // ìƒì„±ì¼ (ISO 8601)
  updatedAt: string,             // ìˆ˜ì •ì¼ (ISO 8601)
  updatedBy: string              // ìµœì¢… ìˆ˜ì •ì
}
```

**ì¸ë±ìŠ¤:**
- companyNameERP
- finalCompanyName
- internalManager (ì¤‘ìš”)
- businessStatus
- department
- accumulatedSales
- lastPaymentDate

**ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤:**
| í•„ë“œ | ì˜ì—…ë‹´ë‹¹ | ê´€ë¦¬ì | ìë™ì—…ë°ì´íŠ¸ |
|------|----------|--------|--------------|
| keyValue | âŒ | âŒ | - |
| companyNameERP | ì½ê¸° | ìˆ˜ì • | - |
| finalCompanyName | ìˆ˜ì • | ìˆ˜ì • | - |
| representative | ìˆ˜ì • | ìˆ˜ì • | - |
| internalManager | ìˆ˜ì • | ìˆ˜ì • | - |
| department | ìˆ˜ì • | ìˆ˜ì • | - |
| businessStatus | ìˆ˜ì • | ìˆ˜ì • | - |
| salesProduct | ì½ê¸° | ì½ê¸° | âœ… |
| accumulatedSales | ì½ê¸° | ì½ê¸° | âœ… |
| accumulatedCollection | ì½ê¸° | ì½ê¸° | âœ… |
| accountsReceivable | ì½ê¸° | ìˆ˜ì • | - |
| lastPaymentDate | ì½ê¸° | ì½ê¸° | âœ… |
| lastPaymentAmount | ì½ê¸° | ì½ê¸° | âœ… |
| businessActivity | ìˆ˜ì • | ì½ê¸° | âœ… |

---

### 4-3. employees ìŠ¤í† ì–´ (ì§ì› ì •ë³´)

```javascript
{
  // ===== Primary Key =====
  id: number,                    // ìë™ ì¦ê°€
  
  // ===== ê¸°ë³¸ ì •ë³´ =====
  name: string,                  // ì´ë¦„
  email: string,                 // ì´ë©”ì¼ (ì„ íƒ)
  phone: string,                 // ì „í™”ë²ˆí˜¸ (ì„ íƒ)
  
  // ===== ì†Œì† ì •ë³´ =====
  department: string,            // ë¶€ì„œ
  role: string,                  // ì—­í•  (sales/admin)
  
  // ===== ê·¼ë¬´ ì •ë³´ =====
  hireDate: string,              // ì…ì‚¬ì¼ (YYYY-MM-DD)
  status: string,                // ì¬ì§ ìƒíƒœ (active/inactive)
  
  // ===== ë©”íƒ€ ì •ë³´ =====
  createdAt: string,             // ìƒì„±ì¼
  updatedAt: string              // ìˆ˜ì •ì¼
}
```

**ì¸ë±ìŠ¤:**
- name
- role
- department
- hireDate
- status

---

### 4-4. reports ìŠ¤í† ì–´ (ë³´ê³ ì„œ ì •ë³´) â­ ì¤‘ìš” ë³€ê²½

```javascript
{
  // ===== Primary Key =====
  reportId: number,              // ìë™ ì¦ê°€
  
  // ===== ê¸°ë³¸ ì •ë³´ =====
  reportType: string,            // ë³´ê³ ì„œ ìœ í˜• (weekly/monthly/yearly)
  submittedBy: string,           // ì‘ì„±ì (ì§ì› ID)
  submittedDate: string,         // ì œì¶œì¼ (YYYY-MM-DD)
  companyId: string,             // ê±°ë˜ì²˜ ID (keyValue)
  
  // ===== ëª©í‘œìˆ˜ê¸ˆê¸ˆì•¡ (ì„ íƒ) =====
  targetCollection: {
    amount: number,              // ëª©í‘œ ê¸ˆì•¡
    currency: string             // í†µí™” (KRW)
  },
  
  // ===== ëª©í‘œë§¤ì¶œì•¡ (ì„ íƒ, ë³µìˆ˜) =====
  targetSales: [{
    product: string,             // íŒë§¤ ì œí’ˆ
    amount: number,              // ëª©í‘œ ê¸ˆì•¡
    vatIncluded: boolean         // ë¶€ê°€ì„¸ í¬í•¨ ì—¬ë¶€
  }],
  
  // ===== ì˜ì—…í™œë™(íŠ¹ì´ì‚¬í•­) (ì„ íƒ) =====
  activity: {
    content: string,             // ì‘ì„± ë‚´ìš© (ì œí•œ ì—†ìŒ)
    type: string,                // í™œë™ ìœ í˜• (ì „í™”/ë°©ë¬¸/ë¬¸ì„œ/ê¸°íƒ€)
    details: object,             // ìœ í˜•ë³„ ìƒì„¸ ì •ë³´
    status: string,              // ì‹¤í–‰/ë¯¸ì‹¤í–‰ (í™•ì¸ ì‹œ ì±„ì›Œì§)
    executedBy: string           // ì‹¤í–‰ì (ë³¸ì¸/ëŒ€ë¦¬)
  },
  
  // ===== ê´€ë¦¬ì í™•ì¸ (ë³´ê³ ì„œ í™•ì¸ ì‹œ) =====
  confirmation: {
    finalCollection: number,     // ìµœì¢…ìˆ˜ê¸ˆê¸ˆì•¡
    finalSales: number,          // ìµœì¢…ë§¤ì¶œê¸ˆì•¡
    activityComment: string,     // ê´€ë¦¬ì ì¶”ê°€ ì½”ë©˜íŠ¸
    activityStatus: string,      // ì‹¤í–‰/ë¯¸ì‹¤í–‰
    confirmedBy: string,         // í™•ì¸ì ID
    confirmedDate: string        // í™•ì¸ì¼
  },
  
  // ===== ìƒíƒœ ì •ë³´ =====
  status: string,                // ë¯¸í™•ì¸/í™•ì¸
  processedBy: string,           // ì²˜ë¦¬ì ID
  processedDate: string,         // ì²˜ë¦¬ì¼
  
  // ===== ë©”íƒ€ ì •ë³´ =====
  createdAt: string,             // ìƒì„±ì¼
  updatedAt: string              // ìˆ˜ì •ì¼
}
```

**ì¸ë±ìŠ¤:**
- reportType
- submittedBy (ì¤‘ìš”)
- companyId
- status (ì¤‘ìš”)
- submittedDate
- processedDate

---

### 4-5. changeHistory ìŠ¤í† ì–´ (ë³€ê²½ ì´ë ¥)

```javascript
{
  // ===== Primary Key =====
  id: number,                    // ìë™ ì¦ê°€
  
  // ===== ë³€ê²½ ëŒ€ìƒ =====
  tableName: string,             // ìŠ¤í† ì–´ëª… (companies/reports/employees)
  recordId: string,              // ë ˆì½”ë“œ ID
  
  // ===== ë³€ê²½ ì •ë³´ =====
  operation: string,             // CREATE/UPDATE/DELETE
  fieldName: string,             // ë³€ê²½ëœ í•„ë“œëª…
  oldValue: any,                 // ë³€ê²½ ì „ ê°’
  newValue: any,                 // ë³€ê²½ í›„ ê°’
  
  // ===== ë³€ê²½ ì£¼ì²´ =====
  userId: string,                // ë³€ê²½ì ID
  userName: string,              // ë³€ê²½ì ì´ë¦„
  
  // ===== ë©”íƒ€ ì •ë³´ =====
  timestamp: string,             // ë³€ê²½ ì‹œê°„ (ISO 8601)
  ipAddress: string,             // IP ì£¼ì†Œ (ì„ íƒ)
  userAgent: string              // ì‚¬ìš©ì ì—ì´ì „íŠ¸ (ì„ íƒ)
}
```

**ì¸ë±ìŠ¤:**
- tableName
- recordId
- operation
- userId
- timestamp (ì¤‘ìš”)

---

### 4-6. backups ìŠ¤í† ì–´ (ë°±ì—… ì •ë³´)

```javascript
{
  // ===== Primary Key =====
  backupId: number,              // ìë™ ì¦ê°€
  
  // ===== ë°±ì—… ì •ë³´ =====
  backupType: string,            // daily/weekly/monthly/manual
  fileName: string,              // ë°±ì—… íŒŒì¼ëª…
  fileSize: number,              // íŒŒì¼ í¬ê¸° (bytes)
  
  // ===== ë©”íƒ€ ì •ë³´ =====
  createdBy: string,             // ìƒì„±ì ID
  createdAt: string,             // ìƒì„±ì¼
  expiresAt: string              // ë§Œë£Œì¼ (ìë™ ì‚­ì œ)
}
```

**ì¸ë±ìŠ¤:**
- backupType
- createdBy
- createdAt
- expiresAt

---

### 4-7. systemSettings ìŠ¤í† ì–´ (ì‹œìŠ¤í…œ ì„¤ì •) âœ¨ ì‹ ê·œ

```javascript
{
  // ===== Primary Key =====
  key: string,                   // ì„¤ì • í‚¤
  
  // ===== ì„¤ì • ê°’ =====
  value: any,                    // ì„¤ì • ê°’ (JSON)
  description: string,           // ì„¤ëª…
  
  // ===== ë©”íƒ€ ì •ë³´ =====
  updatedAt: string,             // ìˆ˜ì •ì¼
  updatedBy: string              // ìˆ˜ì •ì
}
```

**ê¸°ë³¸ ì„¤ì •:**
```javascript
{
  key: 'autoBackup',
  value: { enabled: true, schedule: '0 0 * * *', retention: 30 },
  description: 'ìë™ ë°±ì—… ì„¤ì •'
},
{
  key: 'kpiCache',
  value: { ttl: 300000 },  // 5ë¶„
  description: 'KPI ìºì‹œ ì„¤ì •'
},
{
  key: 'theme',
  value: { mode: 'light', accent: 'blue' },
  description: 'í…Œë§ˆ ì„¤ì •'
}
```

---

## 5. ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš

### 5-1. ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ë‹¨ê³„

#### Step 1: í˜„ì¬ ë°ì´í„° ë°±ì—…
```javascript
// 1. ì „ì²´ ë°ì´í„° ë°±ì—…
const backup = await backupAllData();

// 2. ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ
downloadBackup(backup, 'ë§ˆì´ê·¸ë ˆì´ì…˜_ì „_ë°±ì—….xlsx');
```

#### Step 2: ìƒˆ ìŠ¤í‚¤ë§ˆ ì ìš©
```javascript
// 1. ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „ ì—…ë°ì´íŠ¸ (v3 â†’ v4)
const DB_SCHEMA = {
  name: 'KuwotechSalesDB',
  version: 4,  // â¬†ï¸ ì¦ê°€
  stores: [
    // ìƒˆë¡œìš´ ìŠ¤í‚¤ë§ˆ ì •ì˜
  ]
};

// 2. ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
await migrateToV4();
```

#### Step 3: ë°ì´í„° ë³€í™˜
```javascript
// companies ìŠ¤í† ì–´
async function migrateCompanies() {
  const oldData = await getAllFrom('companies');
  
  for (const company of oldData) {
    const newCompany = {
      // í•„ë“œ ë§¤í•‘
      keyValue: company.keyValue,
      companyNameERP: company.companyNameERP,
      finalCompanyName: company.finalCompanyName,
      representative: company.representative,
      internalManager: company.internalManager,
      department: company.department || 'ë¯¸ì§€ì •',
      businessStatus: company.businessStatus,
      salesProduct: company.salesProduct || '',
      accumulatedSales: company.accumulatedSales || 0,
      accumulatedCollection: company.accumulatedCollection || 0,
      accountsReceivable: company.accountsReceivable || 0,
      lastPaymentDate: company.lastPaymentDate || '',
      lastPaymentAmount: company.lastPaymentAmount || 0,
      businessActivity: company.businessActivity || '',
      createdAt: company.createdAt || new Date().toISOString(),
      updatedAt: new Date().toISOString(),
      updatedBy: 'SYSTEM'
    };
    
    // ë¶ˆí•„ìš”í•œ í•„ë“œ ì œê±°
    // - companyCode
    // - externalManager
    // - remarks
    
    await saveToNew('companies', newCompany);
  }
}

// reports ìŠ¤í† ì–´
async function migrateReports() {
  const oldData = await getAllFrom('reports');
  
  for (const report of oldData) {
    const newReport = {
      reportId: report.reportId,
      reportType: report.reportType,
      submittedBy: report.submittedBy,
      submittedDate: report.submittedDate,
      companyId: report.companyId,
      
      // ìƒˆë¡œìš´ êµ¬ì¡°ë¡œ ë³€í™˜
      targetCollection: {
        amount: report.targetCollectionAmount || 0,
        currency: 'KRW'
      },
      
      targetSales: [{
        product: report.targetProducts || '',
        amount: report.targetSalesAmount || 0,
        vatIncluded: true
      }],
      
      activity: {
        content: report.activityNotes || '',
        type: 'ê¸°íƒ€',
        details: {},
        status: '',
        executedBy: ''
      },
      
      confirmation: {
        finalCollection: 0,
        finalSales: 0,
        activityComment: report.adminComment || '',
        activityStatus: '',
        confirmedBy: report.processedBy || '',
        confirmedDate: report.processedDate || ''
      },
      
      status: report.status,
      processedBy: report.processedBy,
      processedDate: report.processedDate,
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString()
    };
    
    await saveToNew('reports', newReport);
  }
}
```

#### Step 4: ê²€ì¦
```javascript
// 1. ë ˆì½”ë“œ ìˆ˜ í™•ì¸
const oldCount = await countOldRecords();
const newCount = await countNewRecords();
console.log('ë§ˆì´ê·¸ë ˆì´ì…˜ ê²°ê³¼:', { oldCount, newCount });

// 2. ìƒ˜í”Œ ë°ì´í„° í™•ì¸
const samples = await getSampleRecords(10);
validateSamples(samples);

// 3. ì¸ë±ìŠ¤ í™•ì¸
const indexes = await checkIndexes();
console.log('ì¸ë±ìŠ¤ ìƒì„± ì™„ë£Œ:', indexes);
```

#### Step 5: ì •ë¦¬
```javascript
// 1. ì´ì „ ë²„ì „ ë°ì´í„° ë°±ì—… (ì„ íƒ)
await archiveOldVersion();

// 2. ìºì‹œ ì´ˆê¸°í™”
await clearAllCaches();

// 3. ì‹œìŠ¤í…œ ì¬ì‹œì‘
window.location.reload();
```

---

### 5-2. ë¡¤ë°± ê³„íš

ë§Œì•½ ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ì‹¤íŒ¨í•˜ë©´:

```javascript
async function rollback() {
  // 1. ìƒˆ ë°ì´í„°ë² ì´ìŠ¤ ì‚­ì œ
  await deleteDatabase('KuwotechSalesDB');
  
  // 2. ë°±ì—… íŒŒì¼ ë³µì›
  await restoreFromBackup('ë§ˆì´ê·¸ë ˆì´ì…˜_ì „_ë°±ì—….xlsx');
  
  // 3. ì´ì „ ë²„ì „ìœ¼ë¡œ ì½”ë“œ ë˜ëŒë¦¬ê¸°
  // git checkout [ì´ì „ ì»¤ë°‹]
  
  // 4. ì‹œìŠ¤í…œ ì¬ì‹œì‘
  window.location.reload();
}
```

---

## 6. êµ¬í˜„ ìš°ì„ ìˆœìœ„

### ğŸ”´ 1ë‹¨ê³„: í•µì‹¬ ìŠ¤í‚¤ë§ˆ ë³€ê²½ (1ì£¼)
1. companies ìŠ¤í† ì–´ í•„ë“œ ì •ë¦¬
2. reports ìŠ¤í† ì–´ êµ¬ì¡° ì¬ì„¤ê³„
3. ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

### ğŸŸ¡ 2ë‹¨ê³„: ì‹ ê·œ ê¸°ëŠ¥ ì¶”ê°€ (2ì£¼)
1. systemSettings ìŠ¤í† ì–´ ì¶”ê°€
2. ê¸ˆì£¼ë³´ê³ ì„œ ì‹œìŠ¤í…œ êµ¬í˜„
3. ìë™ ì—…ë°ì´íŠ¸ ë¡œì§ êµ¬í˜„

### ğŸŸ¢ 3ë‹¨ê³„: ìµœì í™” (1ì£¼)
1. ì¸ë±ìŠ¤ ìµœì í™”
2. ìºì‹œ ì „ëµ ìˆ˜ë¦½
3. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

---

## 7. ìš”ì•½

### ì£¼ìš” ë³€ê²½ì‚¬í•­

#### âœ… companies ìŠ¤í† ì–´
- 19ê°œ â†’ 16ê°œ í•„ë“œë¡œ ì¶•ì†Œ
- ë¶ˆí•„ìš” í•„ë“œ ì œê±°: companyCode, externalManager, remarks
- ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤ ëª…í™•í™”

#### âœ… reports ìŠ¤í† ì–´
- ë‹¨ìˆœ êµ¬ì¡° â†’ ìƒì„¸ êµ¬ì¡°ë¡œ í™•ì¥
- ê¸ˆì£¼ë³´ê³ ì„œ ì‹œìŠ¤í…œ ë°˜ì˜
- ìë™ ì—…ë°ì´íŠ¸ í•„ë“œ ì¶”ê°€

#### âœ… systemSettings ìŠ¤í† ì–´ (ì‹ ê·œ)
- ì‹œìŠ¤í…œ ì„¤ì • ì¤‘ì•™ ê´€ë¦¬
- ìë™ ë°±ì—… ì„¤ì •
- í…Œë§ˆ ì„¤ì •

---

## ë‹¤ìŒ ëŒ€í™”ì°½ì—ì„œ í•  ì¼

```
F:\7.VScode\Running VS Code\KUWOTECH\Kuwotech_Sales_Management\03.References\ë°±ì—”ë“œ_í´ë”_ì‘ì„±_ì‹¤í–‰_ê°€ì´ë“œ.md ì— ë”°ë¼ ì´í›„ë¶€í„° í™•ì¸í•˜ì—¬ ë‹¤ìŒëŒ€í™”ì‹œì‘
```

---

**ì‘ì„±ì¼**: 2025-10-04  
**ì‘ì„±ì**: Daniel.K  
**ë¬¸ì„œ ë²„ì „**: 1.0  
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ì™„ë£Œ í›„
