# 실적보고서 시스템 설계 문서

**프로젝트**: KUWOTECH 영업관리시스템
**작성일**: 2025-10-07
**작성자**: 시스템 분석가
**문서 버전**: 3.0 (MySQL 버전으로 전면 개정)
**목적**: 실적보고서 작성/확인 시스템의 데이터베이스 구조 개선 및 UI 설계

---

## 📋 목차

1. [시스템 개요](#1-시스템-개요)
2. [데이터베이스 설계 (Railway MySQL)](#2-데이터베이스-설계-railway-mysql)
3. [영업담당모드 UI 설계](#3-영업담당모드-ui-설계)
4. [관리자모드 UI 설계](#4-관리자모드-ui-설계)
5. [공통 디자인 시스템](#5-공통-디자인-시스템)
6. [단계별 구현 계획](#6-단계별-구현-계획)

---

## 1. 시스템 개요

### 1-1. 실적보고서 시스템 구조

```
실적보고서 시스템 (실제 구현 범위)
├── 영업담당모드 (2개 메뉴)
│   ├── 📝 실적보고서 작성
│   └── ✅ 실적보고서 확인
│
└── 관리자모드 (2개 메뉴)
    ├── ✅ 실적보고서 확인
    └── 🎯 보고서 발표
```

**제외된 메뉴 (미구현)**:
- 담당거래처 관리
- 내 실적 현황
- 전체거래처 관리
- 전체 실적 현황

### 1-2. 보고서 작성 및 집계 개념

```
보고서 작성 방식
├── 실제 작성: 주간보고서만 (매주 작성)
│   └── reportType = 'weekly'
│
├── 월간 실적: 주간보고서 자동 누적 (작성 안함)
│   └── 4~5주치 주간보고서 합산 = 월간 실적
│
└── 연간 실적: 월간 실적 자동 누적 (작성 안함)
    └── 12개월치 월간 실적 합산 = 연간 실적
```

**핵심 개념**:
- 사용자는 **주간보고서만 작성**
- 월간/연간 실적은 **집계 시점에 동적 계산**
- reportType 필드는 'weekly'만 사용
- 'monthly', 'annual'은 조회/필터용 개념

### 1-3. 동적 컨텍스트 기반 목표 표시 시스템

모든 보고서 화면 상단에 **사용자가 현재 보고 있는 범위**에 따라 월간/연간 목표 및 실적이 동적으로 표시됩니다.

#### A. 영업담당모드 - 실적보고서 작성

```
[거래처 선택 전 or 전체 보기]
┌─────────────────────────────────────────┐
│ 📊 내 전체 실적 (김영업)                 │
│ 월간 목표: 20,000,000원 | 실적: 18,500,000원 (92.5%) │
│ 연간 목표: 240,000,000원 | 실적: 150,000,000원 (62.5%) │
└─────────────────────────────────────────┘

[거래처: A치과 선택 후]
┌─────────────────────────────────────────┐
│ 📊 A치과 실적                            │
│ 월간 목표: 3,000,000원 | 실적: 2,800,000원 (93.3%) │
│ 연간 목표: 36,000,000원 | 실적: 22,000,000원 (61.1%) │
└─────────────────────────────────────────┘
```

#### B. 영업담당모드 - 실적보고서 확인

```
[필터: 전체]
→ 본인의 모든 거래처 합산 월간/연간 실적

[필터: 거래처 A치과]
→ A치과에 대한 월간/연간 실적만
```

#### C. 관리자모드 - 실적보고서 확인

```
[개인별 확인: 김영업 선택]
┌─────────────────────────────────────────┐
│ 📊 김영업 실적                           │
│ 월간 목표: 20,000,000원 | 실적: 18,500,000원 (92.5%) │
│ 연간 목표: 240,000,000원 | 실적: 150,000,000원 (62.5%) │
└─────────────────────────────────────────┘

[부서별 확인: 영업1팀 선택]
┌─────────────────────────────────────────┐
│ 📊 영업1팀 실적                          │
│ 월간 목표: 100,000,000원 | 실적: 92,000,000원 (92%) │
│ 연간 목표: 1,200,000,000원 | 실적: 800,000,000원 (66.7%) │
└─────────────────────────────────────────┘

[전체 확인]
┌─────────────────────────────────────────┐
│ 📊 전체 회사 실적                        │
│ 월간 목표: 300,000,000원 | 실적: 280,000,000원 (93.3%) │
│ 연간 목표: 3,600,000,000원 | 실적: 2,400,000,000원 (66.7%) │
└─────────────────────────────────────────┘
```

#### D. 관리자모드 - 보고서 발표

```
[📊 담당자별 현황 탭]
→ 회사 전체 월간/연간 목표 및 실적

[🏢 부서별 분석 탭]
→ 각 부서별 월간/연간 목표 및 실적

[👤 담당자별 상세 탭 - 김영업 클릭 시]
→ 김영업 개인의 월간/연간 목표 및 실적
```

### 1-4. 데이터 흐름도

```
[영업담당] 주간 실적보고서 작성
        ↓
    reports 테이블 저장
    (reportType='weekly', status='unconfirmed')
        ↓
[영업담당/관리자] 실적보고서 확인
        ↓
    항목별 최종값 입력
    ├── 목표수금금액 → 최종수금금액
    ├── 목표매출금액 → 최종매출금액
    └── 영업활동 → 추가내용 + 실행여부
        ↓
    reports.confirmation 필드 업데이트
    (status='confirmed')
        ↓
    자동 트리거 발동
        ↓
    companies 테이블 자동 업데이트
    ├── salesProduct (판매제품 추가)
    ├── lastPaymentDate (마지막결제일)
    ├── lastPaymentAmount (마지막결제금액)
    ├── accumulatedCollection (누적수금 합산)
    ├── accumulatedSales (누적매출 합산 - 부가세 처리)
    └── businessActivity (영업활동 기록 추가)
        ↓
    change_history 기록
```

---

## 2. 데이터베이스 설계 (Railway MySQL)

### 2-1. 데이터베이스 선택 근거

**Railway 배포 환경**:
- 클라이언트: IndexedDB (오프라인 캐시용)
- 서버: **MySQL** (Railway 제공, 기존 인프라 활용)
- 동기화: 서버 DB가 Primary, IndexedDB는 캐시

**MySQL 사용 이유**:
1. Railway 기존 MySQL 인프라 유지
2. JSON 필드 네이티브 지원 (MySQL 5.7+)
3. 트리거 지원 (자동 업데이트 로직 구현 가능)
4. 트랜잭션 보장
5. 기존 companies, regions, departments 테이블 보존
6. 무료 플랜: 512MB 스토리지

**MySQL vs PostgreSQL 기능 비교**:
- JSON 타입: MySQL `JSON` = PostgreSQL `JSONB` (기능 동일)
- 배열 타입: MySQL에서는 JSON 배열 사용 (기능 동일)
- 트리거: MySQL 직접 작성 = PostgreSQL 함수 분리 (기능 동일)
- **결론**: 모든 설계 기능 100% 구현 가능

### 2-2. 테이블 구조 설계

#### 2-2-1. companies (거래처 테이블)

**기존 테이블에 필드 추가 방식**:

```sql
-- 기존 companies 테이블에 실적보고서용 필드 추가
ALTER TABLE companies
-- 목표 관리 필드 추가
ADD COLUMN monthly_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '거래처별 월간 수금 목표',
ADD COLUMN monthly_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '거래처별 월간 매출 목표',
ADD COLUMN annual_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '거래처별 연간 수금 목표',
ADD COLUMN annual_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '거래처별 연간 매출 목표',

-- 자동 업데이트 필드 추가 (보고서 확인 시 자동 갱신)
ADD COLUMN sales_product JSON COMMENT '판매제품 목록 (JSON 배열)',
ADD COLUMN last_payment_date TIMESTAMP NULL COMMENT '마지막 결제일',
ADD COLUMN last_payment_amount DECIMAL(15,2) DEFAULT 0 COMMENT '마지막 총결제금액',
ADD COLUMN accumulated_collection DECIMAL(15,2) DEFAULT 0 COMMENT '누적 수금금액',
ADD COLUMN accumulated_sales DECIMAL(15,2) DEFAULT 0 COMMENT '누적 매출금액 (부가세 제외)',
ADD COLUMN business_activity TEXT COMMENT '영업활동 기록';
```

**참고**: 기존 companies 테이블 구조 확인 필요. `keyValue`, `companyName`, `customerRegion` 등 기존 필드는 유지하고 위 필드만 추가.

#### 2-2-2. employees (직원 테이블)

**기존 테이블 확인 후 필드 추가**:

```sql
-- employees 테이블에 목표 필드 추가 (기존 테이블이 있다면 ALTER, 없다면 CREATE)
-- 기존 테이블 확인 필요

-- 없는 경우 생성:
CREATE TABLE IF NOT EXISTS employees (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '직원 ID',
    employee_name VARCHAR(100) NOT NULL COMMENT '직원명',
    employee_id VARCHAR(50) UNIQUE NOT NULL COMMENT '사번',
    department_id INT COMMENT '부서 ID',

    role VARCHAR(20) NOT NULL COMMENT '권한 (sales/manager/admin)',

    -- 목표 관리
    monthly_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '개인 월간 수금 목표',
    monthly_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '개인 월간 매출 목표',
    annual_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '개인 연간 수금 목표',
    annual_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '개인 연간 매출 목표',

    -- 계정 정보
    email VARCHAR(200) COMMENT '이메일',
    phone VARCHAR(20) COMMENT '전화번호',
    is_active BOOLEAN DEFAULT TRUE COMMENT '활성 상태',

    -- 메타데이터
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '생성일시',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일시',

    INDEX idx_employees_dept (department_id),
    INDEX idx_employees_role (role),
    FOREIGN KEY (department_id) REFERENCES departments(id) ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='직원 테이블';

-- 있는 경우 필드 추가:
ALTER TABLE employees
ADD COLUMN monthly_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '개인 월간 수금 목표',
ADD COLUMN monthly_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '개인 월간 매출 목표',
ADD COLUMN annual_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '개인 연간 수금 목표',
ADD COLUMN annual_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '개인 연간 매출 목표';
```

#### 2-2-3. departments (부서 테이블)

**기존 departments 테이블에 목표 필드 추가**:

```sql
-- departments 테이블에 목표 필드 추가
ALTER TABLE departments
ADD COLUMN monthly_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '부서 월간 수금 목표',
ADD COLUMN monthly_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '부서 월간 매출 목표',
ADD COLUMN annual_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '부서 연간 수금 목표',
ADD COLUMN annual_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '부서 연간 매출 목표';
```

#### 2-2-4. company_goals (전체 회사 목표 테이블)

```sql
CREATE TABLE IF NOT EXISTS company_goals (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '회사 목표 ID',
    year INT NOT NULL COMMENT '년도 (2025)',

    -- 전체 회사 목표
    monthly_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '회사 월간 수금 목표',
    monthly_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '회사 월간 매출 목표',
    annual_collection_goal DECIMAL(15,2) DEFAULT 0 COMMENT '회사 연간 수금 목표',
    annual_sales_goal DECIMAL(15,2) DEFAULT 0 COMMENT '회사 연간 매출 목표',

    -- 메타데이터
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '생성일시',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일시',

    UNIQUE KEY uk_year (year)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='전체 회사 목표';
```

#### 2-2-5. reports (실적보고서 테이블) - 핵심

```sql
CREATE TABLE IF NOT EXISTS reports (
    -- 기본 정보
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '보고서 ID',
    report_type VARCHAR(20) DEFAULT 'weekly' COMMENT '보고서 유형 (항상 weekly)',

    -- 작성자 정보
    submitted_by INT NOT NULL COMMENT '작성자 ID',
    submitted_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '제출일시',

    -- 거래처 정보
    company_id INT NOT NULL COMMENT '거래처 ID',

    -- 보고서 내용 (JSON) - 선택적 항목
    target_collection JSON COMMENT '목표수금금액 { "amount": 1000000, "currency": "KRW" }',
    target_sales JSON COMMENT '목표매출금액 [{ "product": "임플란트", "amount": 2000000, "vatIncluded": true }]',
    activity JSON COMMENT '영업활동 { "content": "...", "type": "phone|visit|document|other", "details": {...} }',

    -- 확인 정보 (JSON)
    confirmation JSON COMMENT '확인정보 { "finalCollection": ..., "finalSales": ..., "activityComment": ..., "activityStatus": "executed|not_executed" }',

    -- 상태
    status VARCHAR(20) DEFAULT 'unconfirmed' COMMENT '상태 (unconfirmed/confirmed)',

    -- 처리자 정보
    processed_by INT COMMENT '처리자 ID',
    processed_date TIMESTAMP NULL COMMENT '처리일시',

    -- 관리자 의견
    admin_comment TEXT COMMENT '관리자 의견',

    -- 메타데이터
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '생성일시',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일시',

    INDEX idx_reports_company (company_id),
    INDEX idx_reports_submitted_by (submitted_by),
    INDEX idx_reports_status (status),
    INDEX idx_reports_date (submitted_date),

    FOREIGN KEY (company_id) REFERENCES companies(id) ON DELETE CASCADE,
    FOREIGN KEY (submitted_by) REFERENCES employees(id) ON DELETE CASCADE,
    FOREIGN KEY (processed_by) REFERENCES employees(id) ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='실적보고서';
```

**reports.target_collection 예시**:
```json
{
  "amount": 1000000,
  "currency": "KRW"
}
```

**reports.target_sales 예시**:
```json
[
  {
    "product": "임플란트",
    "amount": 2000000,
    "vatIncluded": true
  },
  {
    "product": "크라운",
    "amount": 500000,
    "vatIncluded": false
  }
]
```

**reports.activity 예시**:
```json
{
  "content": "신제품 소개 예정",
  "type": "visit",
  "details": {
    "visit": {
      "date": "2025-10-20",
      "time": "14:00",
      "location": "A치과 본점",
      "contact": "원장님",
      "purpose": "신제품 소개 및 견적 상담",
      "executedBy": "self",
      "proxy": null
    }
  },
  "status": "",
  "executedBy": "self"
}
```

**reports.confirmation 예시**:
```json
{
  "finalCollection": 950000,
  "finalSales": 1950000,
  "activityComment": "신제품 소개 완료, 견적서 전달 완료. 다음주 재방문 예정.",
  "activityStatus": "executed",
  "confirmedBy": 1,
  "confirmedDate": "2025-10-14T15:30:00Z"
}
```

#### 2-2-6. change_history (변경이력 테이블)

```sql
CREATE TABLE IF NOT EXISTS change_history (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '이력 ID',
    table_name VARCHAR(50) NOT NULL COMMENT '테이블명',
    record_id INT NOT NULL COMMENT '레코드 ID',
    operation VARCHAR(20) NOT NULL COMMENT '작업 (INSERT/UPDATE/DELETE)',
    changed_by INT COMMENT '변경자 ID',
    changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '변경일시',
    old_value JSON COMMENT '이전 값',
    new_value JSON COMMENT '새로운 값',

    INDEX idx_history_table (table_name, record_id),
    INDEX idx_history_date (changed_at),

    FOREIGN KEY (changed_by) REFERENCES employees(id) ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='변경이력';
```

### 2-3. 자동 업데이트 트리거 (MySQL)

보고서 확인 완료 시 companies 테이블 자동 업데이트

```sql
-- 트리거 정의 (MySQL은 함수 분리 없이 직접 작성)
DELIMITER $$

CREATE TRIGGER trigger_update_company_on_confirmation
AFTER UPDATE ON reports
FOR EACH ROW
BEGIN
    DECLARE final_sales_amount DECIMAL(15,2);
    DECLARE vat_included BOOLEAN;
    DECLARE product_name VARCHAR(200);

    -- confirmation이 있고, status가 'confirmed'로 변경된 경우만 실행
    IF NEW.status = 'confirmed' AND OLD.status != 'confirmed' AND NEW.confirmation IS NOT NULL THEN

        -- 1. 판매제품 추가 (target_sales에서 추출)
        IF NEW.target_sales IS NOT NULL THEN
            -- JSON 배열의 첫 번째 제품명 추출
            SET product_name = JSON_UNQUOTE(JSON_EXTRACT(NEW.target_sales, '$[0].product'));

            -- 기존 sales_product가 NULL이면 빈 배열로 초기화
            IF (SELECT sales_product FROM companies WHERE id = NEW.company_id) IS NULL THEN
                UPDATE companies
                SET sales_product = JSON_ARRAY(product_name)
                WHERE id = NEW.company_id;
            ELSE
                -- 제품명 추가
                UPDATE companies
                SET sales_product = JSON_ARRAY_APPEND(
                    COALESCE(sales_product, JSON_ARRAY()),
                    '$',
                    product_name
                )
                WHERE id = NEW.company_id;
            END IF;
        END IF;

        -- 2. 마지막 결제일 갱신
        UPDATE companies
        SET last_payment_date = NEW.processed_date
        WHERE id = NEW.company_id;

        -- 3. 마지막 총결제금액 갱신
        SET final_sales_amount = CAST(JSON_UNQUOTE(JSON_EXTRACT(NEW.confirmation, '$.finalSales')) AS DECIMAL(15,2));

        UPDATE companies
        SET last_payment_amount = final_sales_amount
        WHERE id = NEW.company_id;

        -- 4. 누적 수금금액 합산
        UPDATE companies
        SET accumulated_collection = accumulated_collection +
            COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(NEW.confirmation, '$.finalCollection')) AS DECIMAL(15,2)), 0)
        WHERE id = NEW.company_id;

        -- 5. 누적 매출금액 합산 (부가세 처리)
        SET final_sales_amount = CAST(JSON_UNQUOTE(JSON_EXTRACT(NEW.confirmation, '$.finalSales')) AS DECIMAL(15,2));

        -- target_sales의 첫 번째 항목에서 vatIncluded 확인
        SET vat_included = CAST(JSON_UNQUOTE(JSON_EXTRACT(NEW.target_sales, '$[0].vatIncluded')) AS UNSIGNED);

        IF vat_included = 1 THEN
            SET final_sales_amount = final_sales_amount / 1.1;
        END IF;

        UPDATE companies
        SET accumulated_sales = accumulated_sales + final_sales_amount
        WHERE id = NEW.company_id;

        -- 6. 영업활동 추가
        UPDATE companies
        SET business_activity = CONCAT(
            COALESCE(business_activity, ''),
            '\n[', DATE(NEW.processed_date), '] ',
            JSON_UNQUOTE(JSON_EXTRACT(NEW.activity, '$.content')),
            '\n', JSON_UNQUOTE(JSON_EXTRACT(NEW.confirmation, '$.activityComment')),
            ' [상태: ', JSON_UNQUOTE(JSON_EXTRACT(NEW.confirmation, '$.activityStatus')), ']'
        )
        WHERE id = NEW.company_id;

    END IF;
END$$

DELIMITER ;
```

### 2-4. 동적 집계 쿼리 (월간/연간 실적 계산)

#### A. 특정 담당자의 월간 실적 집계

```sql
-- 김영업(employee_id=1)의 2025년 10월 실적
SELECT
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalCollection')) AS DECIMAL(15,2)), 0)) AS monthly_collection,
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalSales')) AS DECIMAL(15,2)), 0)) AS monthly_sales
FROM reports r
WHERE r.submitted_by = 1
  AND r.status = 'confirmed'
  AND YEAR(r.submitted_date) = 2025
  AND MONTH(r.submitted_date) = 10;
```

#### B. 특정 거래처의 월간 실적 집계

```sql
-- A치과(company_id=1)의 2025년 10월 실적
SELECT
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalCollection')) AS DECIMAL(15,2)), 0)) AS monthly_collection,
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalSales')) AS DECIMAL(15,2)), 0)) AS monthly_sales
FROM reports r
WHERE r.company_id = 1
  AND r.status = 'confirmed'
  AND YEAR(r.submitted_date) = 2025
  AND MONTH(r.submitted_date) = 10;
```

#### C. 특정 부서의 월간 실적 집계

```sql
-- 영업1팀(department_id=1)의 2025년 10월 실적
SELECT
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalCollection')) AS DECIMAL(15,2)), 0)) AS monthly_collection,
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalSales')) AS DECIMAL(15,2)), 0)) AS monthly_sales
FROM reports r
JOIN employees e ON r.submitted_by = e.id
WHERE e.department_id = 1
  AND r.status = 'confirmed'
  AND YEAR(r.submitted_date) = 2025
  AND MONTH(r.submitted_date) = 10;
```

#### D. 전체 회사의 월간 실적 집계

```sql
-- 2025년 10월 전체 실적
SELECT
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalCollection')) AS DECIMAL(15,2)), 0)) AS monthly_collection,
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalSales')) AS DECIMAL(15,2)), 0)) AS monthly_sales
FROM reports r
WHERE r.status = 'confirmed'
  AND YEAR(r.submitted_date) = 2025
  AND MONTH(r.submitted_date) = 10;
```

#### E. 연간 실적 계산 (월간 → 연간)

```sql
-- 김영업의 2025년 연간 실적
SELECT
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalCollection')) AS DECIMAL(15,2)), 0)) AS annual_collection,
    SUM(COALESCE(CAST(JSON_UNQUOTE(JSON_EXTRACT(r.confirmation, '$.finalSales')) AS DECIMAL(15,2)), 0)) AS annual_sales
FROM reports r
WHERE r.submitted_by = 1
  AND r.status = 'confirmed'
  AND YEAR(r.submitted_date) = 2025;
```

### 2-5. Railway 배포 시 초기 데이터

```sql
-- 1. 부서에 목표 업데이트 (기존 부서 테이블 활용)
UPDATE departments
SET
    monthly_collection_goal = 100000000,
    monthly_sales_goal = 200000000,
    annual_collection_goal = 1200000000,
    annual_sales_goal = 2400000000
WHERE department_code = 'SALES_1';

UPDATE departments
SET
    monthly_collection_goal = 80000000,
    monthly_sales_goal = 150000000,
    annual_collection_goal = 960000000,
    annual_sales_goal = 1800000000
WHERE department_code = 'SALES_2';

-- 2. 직원 목표 설정 (employees 테이블이 있다면 UPDATE, 없다면 INSERT)
-- 예시: employees 테이블에 직원이 있다고 가정하고 UPDATE
UPDATE employees
SET
    monthly_collection_goal = 20000000,
    monthly_sales_goal = 40000000,
    annual_collection_goal = 240000000,
    annual_sales_goal = 480000000
WHERE employee_id = 'EMP001';  -- 실제 사번으로 대체

-- 3. 전체 회사 목표
INSERT INTO company_goals (year, monthly_collection_goal, monthly_sales_goal, annual_collection_goal, annual_sales_goal)
VALUES (2025, 300000000, 600000000, 3600000000, 7200000000)
ON DUPLICATE KEY UPDATE
    monthly_collection_goal = VALUES(monthly_collection_goal),
    monthly_sales_goal = VALUES(monthly_sales_goal),
    annual_collection_goal = VALUES(annual_collection_goal),
    annual_sales_goal = VALUES(annual_sales_goal);

-- 4. 거래처 목표 설정 (기존 companies 테이블 활용)
UPDATE companies
SET
    monthly_collection_goal = 3000000,
    monthly_sales_goal = 6000000,
    annual_collection_goal = 36000000,
    annual_sales_goal = 72000000
WHERE keyValue = 'KEY001';  -- 실제 거래처 키값으로 대체
```

---

## 3. 영업담당모드 UI 설계

### 3-1. 실적보고서 작성 화면

#### 전체 레이아웃 구조 (동적 목표 표시 포함)

```
┌──────────────────────────────────────────────────────────┐
│  📝 실적보고서 작성                          [최소화] [X] │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  [동적 컨텍스트 목표 표시 영역] ⭐                       │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 📊 내 전체 실적 (김영업)              [2025년 10월]│  │
│  ├────────────────────────────────────────────────────┤  │
│  │ 💰 월간 수금: 목표 20,000,000원 | 실적 18,500,000원│  │
│  │              달성률 92.5% ████████████████░░░░     │  │
│  │ 📊 월간 매출: 목표 40,000,000원 | 실적 38,000,000원│  │
│  │              달성률 95.0% ████████████████████░    │  │
│  │                                                     │  │
│  │ 💰 연간 수금: 목표 240,000,000원 | 실적 150,000,000원│ │
│  │              달성률 62.5% ████████████░░░░░░░░░░  │  │
│  │ 📊 연간 매출: 목표 480,000,000원 | 실적 350,000,000원│ │
│  │              달성률 72.9% ██████████████░░░░░░░░  │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  [헤더 영역]                                             │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 📅 작성일: 2025-10-07 (자동)                       │  │
│  │ 보고서 유형: 주간보고서 (고정)                      │  │
│  │ 거래처: [▼ A치과 (KEY001)           ] [검색 🔍]  │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  ⚠️ 거래처 선택 시 위의 목표 표시가 변경됩니다!          │
│                                                          │
│  [본문 영역 - 선택적 항목들]                             │
│  ┌────────────────────────────────────────────────────┐  │
│  │ ☐ 💰 목표수금금액                                  │  │
│  │   └─ [접기/펼치기 영역]                            │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  ┌────────────────────────────────────────────────────┐  │
│  │ ☐ 📊 목표매출액                                    │  │
│  │   └─ [접기/펼치기 영역]                            │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  ┌────────────────────────────────────────────────────┐  │
│  │ ☐ 📝 영업활동(특이사항)                            │  │
│  │   └─ [접기/펼치기 영역]                            │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  [푸터 영역]                                             │
│  ┌────────────────────────────────────────────────────┐  │
│  │                  [전체 재작성]  [취소]  [저장]     │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

**동적 목표 표시 로직**:
```javascript
// 거래처 선택 전 (전체)
GET /api/goals/employee/{employeeId}/monthly  // 본인 전체 월간 실적
GET /api/goals/employee/{employeeId}/annual   // 본인 전체 연간 실적

// 거래처 선택 후 (A치과)
GET /api/goals/company/{companyId}/monthly    // A치과 월간 실적
GET /api/goals/company/{companyId}/annual     // A치과 연간 실적
```

#### 접기/펼치기 섹션 상세 설계

**1. 목표수금금액 섹션**
```
┌──────────────────────────────────────────────────────┐
│ ☐ 💰 목표수금금액                              [▼]   │
├──────────────────────────────────────────────────────┤
│                                                      │
│   목표수금금액 (원): [______________________]        │
│   (자동 천단위 콤마)                                  │
│                                                      │
└──────────────────────────────────────────────────────┘
```

**2. 목표매출액 섹션**
```
┌──────────────────────────────────────────────────────┐
│ ☐ 📊 목표매출액                                [▼]   │
├──────────────────────────────────────────────────────┤
│                                                      │
│   [제품 항목 1]                                      │
│   ┌────────────────────────────────────────────────┐  │
│   │ 판매제품: [▼ 회사 전체 제품 목록에서 선택    ]│  │
│   │ 목표매출금액 (원): [_______________]           │  │
│   │ 부가세: [▼ 포함 / 제외 ]                       │  │
│   │                               [제품 삭제]     │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
│   [제품 항목 2]                                      │
│   ┌────────────────────────────────────────────────┐  │
│   │ 판매제품: [▼ 회사 전체 제품 목록에서 선택    ]│  │
│   │ 목표매출금액 (원): [_______________]           │  │
│   │ 부가세: [▼ 포함 / 제외 ]                       │  │
│   │                               [제품 삭제]     │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
│   [➕ 제품 추가]                                     │
│                                                      │
└──────────────────────────────────────────────────────┘
```

**3. 영업활동(특이사항) 섹션**
```
┌──────────────────────────────────────────────────────┐
│ ☐ 📝 영업활동(특이사항)                        [▼]   │
├──────────────────────────────────────────────────────┤
│                                                      │
│   활동 유형: [▼ 선택하세요          ]                │
│      • 전화통화 예정                                  │
│      • 방문예정                                       │
│      • 문서전달                                       │
│      • 기타                                           │
│                                                      │
│   [활동 유형 선택 시 아래에 세부 입력 폼 표시]       │
│                                                      │
└──────────────────────────────────────────────────────┘
```

**3-1. 전화통화 예정 세부 입력 폼**
```
┌──────────────────────────────────────────────────────┐
│ 📞 전화통화 예정                                      │
├──────────────────────────────────────────────────────┤
│                                                      │
│   날짜: [2025-10-07 ▼]    시간: [14:00 ▼]          │
│   대상자: [_______________]                          │
│                                                      │
│   목적:                                              │
│   ┌────────────────────────────────────────────────┐  │
│   │ (자유 입력, 글자수 제한 없음)                  │  │
│   │                                                │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
│   실행자: ⦿ 본인    ○ 대리 실행                      │
│                                                      │
│   [대리 실행 선택 시 표시]                            │
│   ┌────────────────────────────────────────────────┐  │
│   │ 대리 실행자 (딜러/대리점명): [______________] │  │
│   │ 전화번호: [_______________]                    │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
└──────────────────────────────────────────────────────┘
```

**3-2. 방문예정 세부 입력 폼**
```
┌──────────────────────────────────────────────────────┐
│ 🚗 방문예정                                           │
├──────────────────────────────────────────────────────┤
│                                                      │
│   날짜: [2025-10-07 ▼]                              │
│   장소: [_______________]                            │
│   대상자(미팅): [_______________]                    │
│                                                      │
│   목적:                                              │
│   ┌────────────────────────────────────────────────┐  │
│   │ (자유 입력, 글자수 제한 없음)                  │  │
│   │                                                │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
│   실행자: ⦿ 본인    ○ 대리 실행                      │
│                                                      │
│   [대리 실행 선택 시 표시]                            │
│   ┌────────────────────────────────────────────────┐  │
│   │ 대리 실행자 (딜러/대리점명): [______________] │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
└──────────────────────────────────────────────────────┘
```

**3-3. 문서전달 세부 입력 폼**
```
┌──────────────────────────────────────────────────────┐
│ 📄 문서전달                                           │
├──────────────────────────────────────────────────────┤
│                                                      │
│   날짜: [2025-10-07 ▼]                              │
│   전달방법: [▼ 방문 / 이메일 ]                       │
│   전달문서: [_______________]                        │
│                                                      │
│   전달문서 내용:                                      │
│   ┌────────────────────────────────────────────────┐  │
│   │ (자유 입력, 글자수 제한 없음)                  │  │
│   │                                                │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
│   실행자: ⦿ 본인    ○ 대리 실행                      │
│                                                      │
│   [대리 실행 선택 시 표시]                            │
│   ┌────────────────────────────────────────────────┐  │
│   │ 대리 실행자 (딜러/대리점명): [______________] │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
└──────────────────────────────────────────────────────┘
```

**3-4. 기타 활동 세부 입력 폼**
```
┌──────────────────────────────────────────────────────┐
│ 📝 기타 영업활동                                      │
├──────────────────────────────────────────────────────┤
│                                                      │
│   활동 내용:                                         │
│   ┌────────────────────────────────────────────────┐  │
│   │ (자유 입력, 글자수 제한 없음)                  │  │
│   │                                                │  │
│   │                                                │  │
│   └────────────────────────────────────────────────┘  │
│                                                      │
└──────────────────────────────────────────────────────┘
```

#### 디자인 시스템 적용

**글래스모피즘 효과**:
- `glass-card`: 반투명 배경 + 블러 효과
- `glass-3d-element`: 3D 변환 + 호버 효과
- `glass-input`: 입력 필드 투명 스타일

**인터랙션 패턴**:
```javascript
// 체크박스 클릭 → 섹션 활성화
checkbox.addEventListener('change', (e) => {
    const content = e.target.closest('.form-section').querySelector('.section-content');
    if (e.target.checked) {
        content.style.display = 'block';
        content.querySelectorAll('input, select, textarea').forEach(el => el.disabled = false);
    } else {
        content.style.display = 'none';
        content.querySelectorAll('input, select, textarea').forEach(el => el.disabled = true);
    }
});

// 접기/펼치기 버튼 클릭
toggleBtn.addEventListener('click', () => {
    const content = section.querySelector('.section-content');
    const isOpen = content.style.display !== 'none';
    content.style.display = isOpen ? 'none' : 'block';
    toggleBtn.textContent = isOpen ? '▼' : '▲';
    toggleBtn.classList.toggle('open');
});
```

#### 거래처 선택 시 동적 목표 변경

```javascript
async function updateGoalDisplay(companyId = null) {
    const employeeId = state.currentUser.id;

    if (!companyId) {
        // 전체 실적
        const monthlyGoal = await apiManager.get(`/api/goals/employee/${employeeId}/monthly`);
        const annualGoal = await apiManager.get(`/api/goals/employee/${employeeId}/annual`);

        displayGoals({
            title: '내 전체 실적',
            monthly: monthlyGoal,
            annual: annualGoal
        });
    } else {
        // 특정 거래처 실적
        const monthlyGoal = await apiManager.get(`/api/goals/company/${companyId}/monthly`);
        const annualGoal = await apiManager.get(`/api/goals/company/${companyId}/annual`);

        displayGoals({
            title: `${companyName} 실적`,
            monthly: monthlyGoal,
            annual: annualGoal
        });
    }
}
```

### 3-2. 실적보고서 확인 화면

#### 전체 레이아웃 구조

```
┌──────────────────────────────────────────────────────────┐
│  📋 내 실적보고서 확인                       [➕ 새 보고서]│
├──────────────────────────────────────────────────────────┤
│                                                          │
│  [요약 카드]                                             │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │
│  │ 📊 전체  │ │ ⏳ 미확인 │ │ ✅ 완료  │ │ 📅 이번달│   │
│  │   15     │ │    3     │ │   12     │ │    8     │   │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘   │
│                                                          │
│  [검색 필터]                                             │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 🔍 검색 필터                                       │  │
│  ├────────────────────────────────────────────────────┤  │
│  │ 상태: [▼ 전체 ] 거래처: [▼ 전체       ]         │  │
│  │ 시작: [________] 종료: [________]                  │  │
│  │                          [🔄 초기화] [🔍 검색]   │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  [보고서 테이블]                                         │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 📋 제출한 보고서 목록                 총 15건      │  │
│  ├────┬─────┬──────┬──────┬──────┬──────┬────┬────┤  │
│  │ No │제출일│거래처│목표수금│목표매출│영업활동│상태│작업│  │
│  ├────┼─────┼──────┼──────┼──────┼──────┼────┼────┤  │
│  │ 1  │10-07│A치과│3,000,000│6,000,000│방문│⏳│👁️📝✕│  │
│  │ 2  │10-06│B병원│2,500,000│5,000,000│전화│✅│👁️ │  │
│  │ 3  │10-05│C의원│2,000,000│4,000,000│문서│✅│👁️ │  │
│  └────┴─────┴──────┴──────┴──────┴──────┴────┴────┘  │
│                                                          │
│                    [◀ 이전] 1 / 2 [다음 ▶]              │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

#### UI 흐름도

```
[사이드메뉴: 실적보고서 확인 클릭]
        ↓
[메인 화면: 목록 표시]
  ├─ 요약 카드 표시 (전체/미확인/완료/이번달)
  ├─ 필터 섹션 (상태, 거래처, 날짜 범위)
  └─ 보고서 테이블 (페이지네이션)
        ↓
[필터 적용]
  ├─ 상태 필터: 전체/미확인/확인완료
  ├─ 거래처 필터: 드롭다운 선택
  └─ 날짜 범위 필터: 시작일~종료일
        ↓
[보고서 행 작업 버튼]
  ├─ 👁️ 상세보기: 보고서 내용 확인
  ├─ 📝 수정: 보고서 수정 (미확인 상태만)
  └─ ✕ 삭제: 보고서 삭제 (미확인 상태만)
```

#### 요약 카드 계산 로직

```javascript
function updateSummaryCards() {
    const totalCount = state.reports.length;
    const unconfirmedCount = state.reports.filter(r => r.status === 'unconfirmed').length;
    const confirmedCount = state.reports.filter(r => r.status === 'confirmed').length;

    const thisMonth = new Date().getMonth() + 1;
    const thisMonthCount = state.reports.filter(r => {
        const reportMonth = new Date(r.submitted_date).getMonth() + 1;
        return reportMonth === thisMonth;
    }).length;

    elements.totalReports.textContent = totalCount;
    elements.unconfirmedReports.textContent = unconfirmedCount;
    elements.confirmedReports.textContent = confirmedCount;
    elements.thisMonthReports.textContent = thisMonthCount;
}
```

#### 필터링 로직

```javascript
function applyFilters() {
    let filtered = [...state.reports];

    // 상태 필터
    if (state.filters.status) {
        filtered = filtered.filter(r => r.status === state.filters.status);
    }

    // 거래처 필터
    if (state.filters.company) {
        filtered = filtered.filter(r => r.company_name === state.filters.company);
    }

    // 날짜 범위 필터
    if (state.filters.startDate) {
        filtered = filtered.filter(r =>
            new Date(r.submitted_date) >= new Date(state.filters.startDate)
        );
    }
    if (state.filters.endDate) {
        filtered = filtered.filter(r =>
            new Date(r.submitted_date) <= new Date(state.filters.endDate)
        );
    }

    state.filteredReports = filtered;
    state.currentPage = 1;
    renderReportTable();
}
```

#### 테이블 렌더링

```javascript
function renderReportTable() {
    const tbody = elements.reportTableBody;
    const startIndex = (state.currentPage - 1) * state.itemsPerPage;
    const endIndex = startIndex + state.itemsPerPage;
    const pageReports = state.filteredReports.slice(startIndex, endIndex);

    if (pageReports.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="10" class="empty-message">
                    <div class="empty-state">
                        <div class="empty-icon">📭</div>
                        <div class="empty-text">제출한 보고서가 없습니다</div>
                    </div>
                </td>
            </tr>
        `;
        return;
    }

    tbody.innerHTML = pageReports.map((report, index) => `
        <tr>
            <td>${startIndex + index + 1}</td>
            <td>${formatDate(report.submitted_date)}</td>
            <td>${report.company_name || '-'}</td>
            <td>${formatTargetCollection(report.target_collection)}</td>
            <td>${formatTargetSales(report.target_sales)}</td>
            <td>${formatActivity(report.activity)}</td>
            <td>
                <span class="status-badge status-${report.status}">
                    ${report.status === 'unconfirmed' ? '⏳ 미확인' : '✅ 완료'}
                </span>
            </td>
            <td>${report.processed_by || '-'}</td>
            <td>${report.processed_date ? formatDate(report.processed_date) : '-'}</td>
            <td>
                <div class="action-buttons">
                    <button class="btn-icon" onclick="viewReport(${report.id})" title="상세보기">
                        👁️
                    </button>
                    ${report.status === 'unconfirmed' ? `
                        <button class="btn-icon" onclick="editReport(${report.id})" title="수정">
                            📝
                        </button>
                        <button class="btn-icon" onclick="deleteReport(${report.id})" title="삭제">
                            ✕
                        </button>
                    ` : ''}
                </div>
            </td>
        </tr>
    `).join('');
}
```

#### 페이지네이션

```javascript
function updatePagination() {
    const totalPages = Math.ceil(state.filteredReports.length / state.itemsPerPage);

    elements.btnPrev.disabled = state.currentPage === 1;
    elements.btnNext.disabled = state.currentPage === totalPages || totalPages === 0;
    elements.pageInfo.textContent = `${state.currentPage} / ${totalPages || 1}`;
}

elements.btnPrev.addEventListener('click', () => {
    if (state.currentPage > 1) {
        state.currentPage--;
        renderReportTable();
        updatePagination();
    }
});

elements.btnNext.addEventListener('click', () => {
    const totalPages = Math.ceil(state.filteredReports.length / state.itemsPerPage);
    if (state.currentPage < totalPages) {
        state.currentPage++;
        renderReportTable();
        updatePagination();
    }
});
```

**핵심 기능**:
- 실시간 요약 통계 (전체/미확인/완료/이번달)
- 다중 필터링 (상태, 거래처, 날짜 범위)
- 페이지네이션 (10건씩 표시)
- 상태별 액션 버튼 (미확인: 보기/수정/삭제, 완료: 보기만)
- JSON 필드 포맷팅 (target_collection, target_sales, activity)

### 3-3. 보고서 상세 확인 프로세스

#### 1단계: 보고서 상세보기 화면

```
┌──────────────────────────────────────────────────────────┐
│  📊 보고서 상세 보기                    [X] 닫기         │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  거래처: A치과 (KEY001)                                  │
│  작성일: 2025-10-07 14:30:25                             │
│  담당자: 김영업                                          │
│  상태: 🔴 미확인                                         │
│                                                          │
│  ─────────────────────────────────────────────           │
│                                                          │
│  💰 목표수금금액                                          │
│     목표: 1,000,000원                                    │
│     실적: -                                              │
│     잔액: 1,000,000원                                    │
│                                                          │
│  📊 목표매출액                                            │
│     제품: 임플란트                                       │
│     목표: 2,000,000원 (부가세 포함)                      │
│     실적: -                                              │
│     잔액: 2,000,000원                                    │
│                                                          │
│  📝 영업활동                                              │
│     유형: 방문예정                                       │
│     날짜: 2025-10-20                                     │
│     장소: A치과 본점                                     │
│     대상자: 원장님                                       │
│     목적: 신제품 소개 및 견적 상담                       │
│                                                          │
│                              [확인하러 가기]              │
└──────────────────────────────────────────────────────────┘
```

#### 2단계: 목표수금금액 확인 폼

```
┌──────────────────────────────────────────────────────────┐
│  ✅ 보고서 확인 - A치과                                   │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  📅 작성일: 2025-10-07                                   │
│  👤 영업담당: 김영업                                     │
│                                                          │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 💰 목표수금금액 확인                                │  │
│  ├────────────────────────────────────────────────────┤  │
│  │                                                     │  │
│  │  목표수금금액: 1,000,000 원                         │  │
│  │                                                     │  │
│  │  최종수금금액: [_______________] 원 (입력 필수)     │  │
│  │  (자동 천단위 콤마)                                 │  │
│  │                                                     │  │
│  │  잔액: [자동계산 표시]                              │  │
│  │                                                     │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│                          [확인]     [다음항목 →]         │
└──────────────────────────────────────────────────────────┘
```

**처리 로직**:
```javascript
// 최종수금금액 확인 시
누적수금금액 += 최종수금금액
잔액 = 목표수금금액 - 최종수금금액

// 잔액 > 0: 다음 보고서에 계속 표시
// 잔액 = 0: 완료 처리
```

#### 3단계: 목표매출금액 확인 폼

```
┌──────────────────────────────────────────────────────────┐
│  ✅ 보고서 확인 - A치과                                   │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 📊 목표매출액 확인                                  │  │
│  ├────────────────────────────────────────────────────┤  │
│  │                                                     │  │
│  │  제품: 임플란트                                     │  │
│  │  목표매출금액: 1,100,000 원 (부가세 포함)           │  │
│  │                                                     │  │
│  │  최종매출금액: [_______________] 원 (입력 필수)     │  │
│  │  (자동 천단위 콤마)                                 │  │
│  │                                                     │  │
│  │  잔액: [자동계산 표시]                              │  │
│  │                                                     │  │
│  │  ─────────────────────────────────                  │  │
│  │                                                     │  │
│  │  제품: 크라운                                       │  │
│  │  목표매출금액: 500,000 원 (부가세 제외)             │  │
│  │                                                     │  │
│  │  최종매출금액: [_______________] 원 (입력 필수)     │  │
│  │  (자동 천단위 콤마)                                 │  │
│  │                                                     │  │
│  │  잔액: [자동계산 표시]                              │  │
│  │                                                     │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│                          [확인]     [다음항목 →]         │
└──────────────────────────────────────────────────────────┘
```

**처리 로직**:
```javascript
// 최종매출금액 확인 시 (부가세 처리)
if (부가세포함) {
  누적매출금액 += (최종매출금액 ÷ 1.1)
} else {
  누적매출금액 += 최종매출금액
}

// 자동 업데이트
판매제품 = 기존 + "," + 신규제품
마지막결제일 = 보고서 확인 날짜
마지막총결재금액 = 최종매출금액
```

#### 4단계: 영업활동 확인 폼 ⭐

```
┌──────────────────────────────────────────────────────────┐
│  ✅ 보고서 확인 - A치과                                   │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 📝 영업활동(특이사항) 확인                          │  │
│  ├────────────────────────────────────────────────────┤  │
│  │                                                     │  │
│  │  【원본 내용】                                      │  │
│  │  ┌─────────────────────────────────────────────┐   │  │
│  │  │ 유형: 방문예정                               │   │  │
│  │  │ 날짜: 2025-10-20                             │   │  │
│  │  │ 장소: A치과 본점                             │   │  │
│  │  │ 대상자: 원장님                               │   │  │
│  │  │ 목적: 신제품 소개 및 견적 상담               │   │  │
│  │  └─────────────────────────────────────────────┘   │  │
│  │                                                     │  │
│  │  【추가 내용】 ⭐                                   │  │
│  │  ┌─────────────────────────────────────────────┐   │  │
│  │  │                                              │   │  │
│  │  │ (자유 입력)                                  │   │  │
│  │  │                                              │   │  │
│  │  └─────────────────────────────────────────────┘   │  │
│  │                                                     │  │
│  │  상태: (●) 실행  ( ) 미실행                        │  │
│  │                                                     │  │
│  │  ⚠️ 실행 선택 시 추가 내용 15자 이상 필수입니다    │  │
│  │  현재 글자수: [0자]                                 │  │
│  │                                                     │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│                          [확인]     [완료]               │
└──────────────────────────────────────────────────────────┘
```

**처리 규칙**:
```javascript
// 실행 선택 시
if (상태 === '실행' && 추가내용.length < 15) {
  alert('실행 선택 시 추가 내용을 15자 이상 입력해야 합니다.');
  return false;
}

// 미실행 선택 시
// 추가 내용 길이 무관

// 최종 저장
영업활동 = 원본내용 + "\n\n【확인 내용】\n" + 추가내용 + "\n상태: " + (실행/미실행);
```

#### 확인 프로세스 흐름도

```
[보고서 목록에서 "확인" 버튼 클릭]
        ↓
[1단계: 보고서 상세보기]
  - 목표수금, 목표매출, 영업활동 내용 표시
  - [확인하러 가기] 버튼 클릭
        ↓
[2단계: 목표수금금액 확인]
  - 최종수금금액 입력
  - [확인] → 다음 단계로 이동
  - [다음항목 →] → 이 항목 건너뛰고 다음으로
        ↓
[3단계: 목표매출금액 확인]
  - 제품별로 최종매출금액 입력
  - 부가세 포함/제외 자동 처리
  - [확인] → 다음 단계로 이동
        ↓
[4단계: 영업활동 확인]
  - 원본 내용 표시
  - 추가 내용 입력 (실행 시 15자 이상 필수)
  - 상태 선택 (실행/미실행)
  - [확인] → 모든 확인 완료
        ↓
[확인 완료]
  - 보고서 상태: 미확인 → 확인완료
  - 자동 업데이트: 판매제품, 마지막결제일, 누적금액 등
  - 목록 화면으로 돌아가기
```

#### 실적관리 목록 화면

```
┌──────────────────────────────────────────────────────────┐
│  📊 실적관리                                             │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  필터: [●전체] [○미확인]                                │
│                                                          │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 날짜      거래처    내용              상태         │  │
│  ├────────────────────────────────────────────────────┤  │
│  │ 10-07    A치과    목표수금:1,000,000  🔴미확인    │  │
│  │ 10-07    B치과    목표매출:2,000,000  ✅확인      │  │
│  │ 10-07    C치과    영업활동:신제품소개 🔴미확인    │  │
│  │ 10-06    D병원    목표수금:500,000   ✅확인      │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  [이전] 1 2 3 4 5 [다음]                                │
└──────────────────────────────────────────────────────────┘
```

---

## 4. 관리자모드 UI 설계

### 4-1. 실적보고서 확인 화면 (관리자)

#### 전체 레이아웃 구조

```
┌──────────────────────────────────────────────────────────┐
│  📋 실적보고서 확인 (관리자)                  [🎬 보고서 발표]│
├──────────────────────────────────────────────────────────┤
│                                                          │
│  [요약 카드]                                             │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │
│  │ 📊 전체  │ │ ⏳ 미확인 │ │ ✅ 완료  │ │ 📅 오늘  │   │
│  │   45     │ │   12     │ │   33     │ │    5     │   │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘   │
│                                                          │
│  [검색 필터]                                             │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 🔍 검색 필터                                       │  │
│  ├────────────────────────────────────────────────────┤  │
│  │ 상태: [▼ 전체 ] 담당자: [▼ 전체 ]                │  │
│  │ 거래처: [▼ 전체 ] 시작: [________] 종료: [______]│  │
│  │                          [🔄 초기화] [🔍 검색]   │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  [보고서 테이블]                                         │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 📋 전체 보고서 목록                   총 45건      │  │
│  ├───┬────┬────┬────┬────┬────┬────┬───┬────┬────┬──┤  │
│  │No │제출일│담당자│거래처│목표수금│목표매출│영업활동│상태│확인자│확인일│작업│  │
│  ├───┼────┼────┼────┼────┼────┼────┼───┼────┼────┼──┤  │
│  │1  │10-07│김영업│A치과│3M│6M│방문│⏳│-│-│👁️✓✕│  │
│  │2  │10-07│이영업│B병원│2.5M│5M│전화│✅│관리자│10-07│👁️│  │
│  │3  │10-06│박영업│C의원│2M│4M│문서│✅│관리자│10-06│👁️│  │
│  └───┴────┴────┴────┴────┴────┴────┴───┴────┴────┴──┘  │
│                                                          │
│                    [◀ 이전] 1 / 5 [다음 ▶]              │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

#### 영업담당모드와의 차이점

| 기능 | 영업담당모드 | 관리자모드 |
|------|------------|----------|
| 데이터 범위 | 본인 보고서만 | 전체 직원 보고서 |
| 필터 옵션 | 상태, 거래처, 날짜 | 상태, **담당자**, 거래처, 날짜 |
| 작업 버튼 | 보기, 수정, 삭제 | 보기, **승인**, **반려** |
| 승인/반려 권한 | 없음 | **있음** |
| 통계 카드 | 전체/미확인/완료/이번달 | 전체/미확인/완료/**오늘** |

#### 관리자 전용 기능

**1. 담당자 필터**
```javascript
async function loadEmployees() {
    const response = await apiManager.getEmployees();
    if (response && Array.isArray(response)) {
        state.employees = response.filter(emp => emp.role === 'sales');

        const filterEmployee = elements.filterEmployee;
        filterEmployee.innerHTML = '<option value="">전체</option>';
        state.employees.forEach(emp => {
            filterEmployee.innerHTML += `
                <option value="${emp.id}">${emp.name}</option>
            `;
        });
    }
}
```

**2. 승인/반려 처리**
```javascript
// 승인 처리
window.approveReport = async function(reportId) {
    if (!confirm('이 보고서를 승인하시겠습니까?')) return;

    try {
        const response = await apiManager.updateReportStatus(reportId, {
            status: 'confirmed',
            processed_by: state.currentUser.name,
            processed_date: new Date().toISOString()
        });

        if (response && response.success !== false) {
            alert('보고서가 승인되었습니다.');
            await loadReports();
            applyFilters();
        } else {
            throw new Error('승인 처리 실패');
        }
    } catch (error) {
        console.error('보고서 승인 실패:', error);
        alert('보고서 승인에 실패했습니다.');
    }
};

// 반려 처리
window.rejectReport = async function(reportId) {
    const reason = prompt('반려 사유를 입력하세요:');
    if (!reason) return;

    try {
        const response = await apiManager.updateReportStatus(reportId, {
            status: 'unconfirmed',  // 다시 미확인 상태로
            rejection_reason: reason,
            processed_by: state.currentUser.name,
            processed_date: new Date().toISOString()
        });

        if (response && response.success !== false) {
            alert('보고서가 반려되었습니다.');
            await loadReports();
            applyFilters();
        } else {
            throw new Error('반려 처리 실패');
        }
    } catch (error) {
        console.error('보고서 반려 실패:', error);
        alert('보고서 반려에 실패했습니다.');
    }
};
```

**3. 전체 보고서 조회**
```javascript
// 관리자는 employee_id 필터 없이 전체 보고서 로드
async function loadReports() {
    try {
        const response = await apiManager.getReports();  // 파라미터 없음
        if (response && Array.isArray(response)) {
            state.reports = response;
            // 최신순 정렬
            state.reports.sort((a, b) =>
                new Date(b.submitted_date) - new Date(a.submitted_date)
            );
            state.filteredReports = [...state.reports];
            updateSummaryCards();
            applyFilters();
        }
    } catch (error) {
        console.error('보고서 로드 실패:', error);
        alert('보고서를 불러오는데 실패했습니다.');
    }
}
```

**4. 관리자 테이블 렌더링**
```javascript
function renderReportTable() {
    const tbody = elements.reportTableBody;
    const startIndex = (state.currentPage - 1) * state.itemsPerPage;
    const endIndex = startIndex + state.itemsPerPage;
    const pageReports = state.filteredReports.slice(startIndex, endIndex);

    if (pageReports.length === 0) {
        tbody.innerHTML = `
            <tr id="emptyRow">
                <td colspan="11" class="empty-message">
                    <div class="empty-state">
                        <div class="empty-icon">📭</div>
                        <div class="empty-text">제출된 보고서가 없습니다</div>
                    </div>
                </td>
            </tr>
        `;
        return;
    }

    tbody.innerHTML = pageReports.map((report, index) => `
        <tr>
            <td>${startIndex + index + 1}</td>
            <td>${formatDate(report.submitted_date)}</td>
            <td>${report.employee_name || '-'}</td>
            <td>${report.company_name || '-'}</td>
            <td>${formatTargetCollection(report.target_collection)}</td>
            <td>${formatTargetSales(report.target_sales)}</td>
            <td>${formatActivity(report.activity)}</td>
            <td>
                <span class="status-badge status-${report.status}">
                    ${report.status === 'unconfirmed' ? '⏳ 미확인' : '✅ 완료'}
                </span>
            </td>
            <td>${report.processed_by || '-'}</td>
            <td>${report.processed_date ? formatDate(report.processed_date) : '-'}</td>
            <td>
                <div class="action-buttons">
                    <button class="btn-icon" onclick="viewReport(${report.id})" title="상세보기">
                        👁️
                    </button>
                    ${report.status === 'unconfirmed' ? `
                        <button class="btn-icon" onclick="approveReport(${report.id})" title="승인"
                                style="color: var(--color-success);">
                            ✓
                        </button>
                        <button class="btn-icon" onclick="rejectReport(${report.id})" title="반려"
                                style="color: var(--color-error);">
                            ✕
                        </button>
                    ` : ''}
                </div>
            </td>
        </tr>
    `).join('');

    elements.emptyRow = document.getElementById('emptyRow');
    updatePagination();
}
```

#### 관리자 의견 추가 기능

**관리자 실적관리 화면 (의견 추가 기능 포함)**
```
┌──────────────────────────────────────────────────────────┐
│  📊 실적관리 (관리자)                                    │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  필터: [●전체] [○미확인]   영업담당: [▼전체]          │
│                                                          │
│  ┌────────────────────────────────────────────────────┐  │
│  │날짜   거래처  담당자  부서     내용         상태   │  │
│  ├────────────────────────────────────────────────────┤  │
│  │10-07  A치과  김영업  영업1팀  목표수금:1M  🔴미확인│  │
│  │10-07  B치과  박영업  영업2팀  목표매출:2M  ✅확인  │  │
│  │10-07  C치과  이영업  영업1팀  영업활동:... 🔴미확인│  │
│  │10-06  D병원  최영업  영업3팀  목표수금:5K  ✅확인  │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  💬 관리자 의견 추가:                                    │
│  ┌────────────────────────────────────────────────────┐  │
│  │                                                     │  │
│  │  (자유 입력)                                        │  │
│  │                                                     │  │
│  └────────────────────────────────────────────────────┘  │
│                                           [의견 저장]    │
└──────────────────────────────────────────────────────────┘
```

**관리자 보고서 상세 확인 화면 (의견 추가 기능)**
```
┌──────────────────────────────────────────────────────────┐
│  📊 보고서 상세 보기 (관리자)            [X] 닫기        │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  거래처: A치과 (KEY001)                                  │
│  작성일: 2025-10-07 14:30:25                             │
│  담당자: 김영업 (영업1팀)                                │
│  상태: 🔴 미확인                                         │
│                                                          │
│  ─────────────────────────────────────────────           │
│                                                          │
│  💰 목표수금금액                                          │
│     목표: 1,000,000원                                    │
│     실적: -                                              │
│     잔액: 1,000,000원                                    │
│                                                          │
│  📊 목표매출액                                            │
│     제품: 임플란트                                       │
│     목표: 2,000,000원 (부가세 포함)                      │
│     실적: -                                              │
│     잔액: 2,000,000원                                    │
│                                                          │
│  📝 영업활동                                              │
│     유형: 방문예정                                       │
│     날짜: 2025-10-20                                     │
│     장소: A치과 본점                                     │
│     대상자: 원장님                                       │
│     목적: 신제품 소개 및 견적 상담                       │
│                                                          │
│  ─────────────────────────────────────────────           │
│                                                          │
│  💬 관리자 의견                                           │
│  ┌────────────────────────────────────────────────────┐  │
│  │                                                     │  │
│  │  (자유 입력)                                        │  │
│  │                                                     │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│                  [의견 저장]         [확인하러 가기]      │
└──────────────────────────────────────────────────────────┘
```

**관리자 의견 저장 로직**
```javascript
// 관리자 의견 저장
async function saveAdminComment(reportId, comment) {
    if (!comment.trim()) {
        alert('의견을 입력해주세요.');
        return;
    }

    try {
        const response = await apiManager.updateReport(reportId, {
            admin_comment: comment,
            admin_comment_date: new Date().toISOString(),
            admin_name: state.currentUser.name
        });

        if (response && response.success !== false) {
            alert('관리자 의견이 저장되었습니다.');
            await loadReports();
            applyFilters();
        } else {
            throw new Error('의견 저장 실패');
        }
    } catch (error) {
        console.error('관리자 의견 저장 실패:', error);
        alert('의견 저장에 실패했습니다.');
    }
}
```

**관리자와 영업담당의 차이점**
| 항목 | 영업담당 | 관리자 |
|------|---------|--------|
| 데이터 범위 | 본인 보고서만 | 전체 직원 보고서 |
| 필터 옵션 | 상태, 거래처, 날짜 | 상태, **부서, 담당자**, 거래처, 날짜 |
| 의견 추가 | ❌ 불가능 | ✅ 가능 |
| 승인/반려 | ❌ 없음 | ✅ 있음 |
| 확인 프로세스 | 단계별 확인 (목표수금 → 목표매출 → 영업활동) | 동일 + 의견 추가 |

### 4-2. 보고서 발표 (대시보드)

#### 필터 옵션

**기간별 필터**
```
┌──────────────────────────────────────────────────┐
│  🎯 보고서 발표                                   │
├──────────────────────────────────────────────────┤
│                                                  │
│  기간별 필터:                                    │
│  ├── 주간: [●금주] [○전주]                      │
│  ├── 월간: [▼2025년 10월]                       │
│  └── 연간: [▼2025년]                            │
│                                                  │
│  그룹별 필터:                                    │
│  ├── 부서별: [▼전체부서] [▼영업1팀] [▼영업2팀] │
│  └── 담당자별: [▼전체] [▼김영업] [▼박영업]     │
│                                                  │
│                      [🔄 초기화] [📊 조회]      │
└──────────────────────────────────────────────────┘
```

#### 대시보드 레이아웃 구조

```
┌──────────────────────────────────────────────────────────┐
│  📊 보고서 발표 대시보드                 [📋 보고서 확인] │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  [필터 영역]                                             │
│  기간: [●금주] [○전주] [○월간] [○연간]                 │
│  부서: [▼전체부서]  담당자: [▼전체]                     │
│                                                          │
│  ─────────────────────────────────────────────           │
│                                                          │
│  [전체 요약 카드]                                        │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │
│  │ 📊 목표  │ │ ✅ 달성  │ │ 💰 매출  │ │ 📈 증감  │   │
│  │  수금    │ │  수금    │ │  실적    │ │   률     │   │
│  │  50M     │ │  45M     │ │  80M     │ │  +15%    │   │
│  │  (90%)   │ │          │ │          │ │          │   │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘   │
│                                                          │
│  ─────────────────────────────────────────────           │
│                                                          │
│  [부서별 실적 발표]                                      │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 📊 부서별 실적 (2025년 10월 4주차)                │  │
│  ├────────────────────────────────────────────────────┤  │
│  │                                                     │  │
│  │  ┌─────────────────────────────────────────────┐   │  │
│  │  │ 영업1팀 실적                                 │   │  │
│  │  │ ├── 목표수금: 20,000,000원                   │   │  │
│  │  │ ├── 실적수금: 18,500,000원 (92.5%)           │   │  │
│  │  │ ├── 목표매출: 50,000,000원                   │   │  │
│  │  │ └── 실적매출: 45,000,000원 (90%)             │   │  │
│  │  └─────────────────────────────────────────────┘   │  │
│  │                                                     │  │
│  │  ┌─────────────────────────────────────────────┐   │  │
│  │  │ 영업2팀 실적                                 │   │  │
│  │  │ ├── 목표수금: 15,000,000원                   │   │  │
│  │  │ ├── 실적수금: 16,000,000원 (106.7%)          │   │  │
│  │  │ ├── 목표매출: 40,000,000원                   │   │  │
│  │  │ └── 실적매출: 42,000,000원 (105%)            │   │  │
│  │  └─────────────────────────────────────────────┘   │  │
│  │                                                     │  │
│  │                              [📈 차트 보기]        │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  ─────────────────────────────────────────────           │
│                                                          │
│  [담당자별 비교 (주간)]                                  │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 👥 담당자별 실적 비교 (금주 vs 전주)              │  │
│  ├────────────────────────────────────────────────────┤  │
│  │                                                     │  │
│  │  담당자    금주수금    전주수금    증감율          │  │
│  │  ────────────────────────────────────────          │  │
│  │  김영업    5,000,000   4,500,000   +11.1%         │  │
│  │  박영업    4,800,000   5,200,000   -7.7%          │  │
│  │  이영업    6,200,000   5,800,000   +6.9%          │  │
│  │  최영업    3,500,000   3,500,000   0.0%           │  │
│  │  ────────────────────────────────────────          │  │
│  │  합계     19,500,000  19,000,000   +2.6%          │  │
│  │                                                     │  │
│  │                              [상세보기]            │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

#### 차트 보기 기능

**부서별 실적 차트**
```
┌──────────────────────────────────────────────────────────┐
│  📈 부서별 실적 차트                     [X] 닫기         │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  기간: 2025년 10월 4주차                                 │
│                                                          │
│  [막대 그래프]                                            │
│  ┌────────────────────────────────────────────────────┐  │
│  │                                                     │  │
│  │  100% ┤                                            │  │
│  │   90% ┤  ████████ (90%)                            │  │
│  │   80% ┤  ████████                                  │  │
│  │   70% ┤  ████████                ██████████ (105%)│  │
│  │   60% ┤  ████████                ██████████       │  │
│  │   50% ┤  ████████                ██████████       │  │
│  │   40% ┤  ████████                ██████████       │  │
│  │   30% ┤  ████████                ██████████       │  │
│  │   20% ┤  ████████                ██████████       │  │
│  │   10% ┤  ████████                ██████████       │  │
│  │    0% └──────────────────────────────────────     │  │
│  │          영업1팀                 영업2팀           │  │
│  │                                                     │  │
│  │  범례: ████ 수금 달성률   ████ 매출 달성률        │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│                      [CSV 내보내기] [인쇄]               │
└──────────────────────────────────────────────────────────┘
```

**담당자별 실적 상세보기**
```
┌──────────────────────────────────────────────────────────┐
│  👤 담당자별 실적 상세                   [X] 닫기         │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  담당자: 김영업 (영업1팀)                                │
│  기간: 2025년 10월 금주                                  │
│                                                          │
│  ─────────────────────────────────────────────           │
│                                                          │
│  💰 수금 실적                                             │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 목표: 5,000,000원                                   │  │
│  │ 실적: 5,000,000원                                   │  │
│  │ 달성률: 100% ████████████████████████              │  │
│  │ 전주 대비: +11.1% (증가)                            │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  📊 매출 실적                                             │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 목표: 10,000,000원                                  │  │
│  │ 실적: 9,500,000원                                   │  │
│  │ 달성률: 95% ███████████████████░░                  │  │
│  │ 전주 대비: +8.5% (증가)                             │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│  📝 영업활동                                              │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 거래처 방문: 3건                                    │  │
│  │ 전화 상담: 5건                                      │  │
│  │ 문서 전달: 2건                                      │  │
│  │ 신규 거래처: 1개                                    │  │
│  └────────────────────────────────────────────────────┘  │
│                                                          │
│                      [보고서 보기] [인쇄]                │
└──────────────────────────────────────────────────────────┘
```

#### 대시보드 데이터 로직

**기간별 데이터 조회**
```javascript
// 주간 데이터 조회
async function getWeeklyData(weekType = 'current') {
    const today = new Date();
    let startDate, endDate;

    if (weekType === 'current') {
        // 금주: 월요일 ~ 일요일
        startDate = getMonday(today);
        endDate = getSunday(today);
    } else {
        // 전주
        const lastWeek = new Date(today);
        lastWeek.setDate(lastWeek.getDate() - 7);
        startDate = getMonday(lastWeek);
        endDate = getSunday(lastWeek);
    }

    return await apiManager.getReports({
        startDate: startDate.toISOString(),
        endDate: endDate.toISOString()
    });
}

// 월간 데이터 조회
async function getMonthlyData(year, month) {
    const startDate = new Date(year, month - 1, 1);
    const endDate = new Date(year, month, 0);

    return await apiManager.getReports({
        startDate: startDate.toISOString(),
        endDate: endDate.toISOString()
    });
}

// 연간 데이터 조회
async function getAnnualData(year) {
    const startDate = new Date(year, 0, 1);
    const endDate = new Date(year, 11, 31);

    return await apiManager.getReports({
        startDate: startDate.toISOString(),
        endDate: endDate.toISOString()
    });
}
```

**부서별 실적 집계**
```javascript
function aggregateByDepartment(reports) {
    const departments = {};

    reports.forEach(report => {
        const dept = report.department || '미분류';

        if (!departments[dept]) {
            departments[dept] = {
                name: dept,
                targetCollection: 0,
                actualCollection: 0,
                targetSales: 0,
                actualSales: 0,
                reportCount: 0
            };
        }

        departments[dept].targetCollection += report.target_collection || 0;
        departments[dept].actualCollection += report.actual_collection || 0;
        departments[dept].targetSales += report.target_sales || 0;
        departments[dept].actualSales += report.actual_sales || 0;
        departments[dept].reportCount += 1;
    });

    return Object.values(departments).map(dept => ({
        ...dept,
        collectionRate: (dept.actualCollection / dept.targetCollection * 100).toFixed(1),
        salesRate: (dept.actualSales / dept.targetSales * 100).toFixed(1)
    }));
}
```

**담당자별 비교 (주간)**
```javascript
function compareEmployees(currentWeek, lastWeek) {
    const comparison = [];
    const employees = [...new Set([...currentWeek.map(r => r.employee_name), ...lastWeek.map(r => r.employee_name)])];

    employees.forEach(empName => {
        const currentReports = currentWeek.filter(r => r.employee_name === empName);
        const lastReports = lastWeek.filter(r => r.employee_name === empName);

        const currentTotal = currentReports.reduce((sum, r) => sum + (r.actual_collection || 0), 0);
        const lastTotal = lastReports.reduce((sum, r) => sum + (r.actual_collection || 0), 0);

        const changeRate = lastTotal > 0 ? ((currentTotal - lastTotal) / lastTotal * 100).toFixed(1) : 0;

        comparison.push({
            name: empName,
            currentWeek: currentTotal,
            lastWeek: lastTotal,
            changeRate: changeRate,
            changeType: changeRate > 0 ? 'increase' : changeRate < 0 ? 'decrease' : 'same'
        });
    });

    return comparison.sort((a, b) => b.currentWeek - a.currentWeek);
}
```

**대시보드 렌더링**
```javascript
// 대시보드 초기화
async function initDashboard() {
    // 필터 초기값 설정
    state.dashboardFilter = {
        period: 'weekly',  // weekly, monthly, annual
        weekType: 'current',  // current, last
        year: new Date().getFullYear(),
        month: new Date().getMonth() + 1,
        department: null,
        employee: null
    };

    // 데이터 로드
    await loadDashboardData();
    renderDashboard();
}

// 대시보드 데이터 로드
async function loadDashboardData() {
    let reports;

    switch (state.dashboardFilter.period) {
        case 'weekly':
            reports = await getWeeklyData(state.dashboardFilter.weekType);
            break;
        case 'monthly':
            reports = await getMonthlyData(
                state.dashboardFilter.year,
                state.dashboardFilter.month
            );
            break;
        case 'annual':
            reports = await getAnnualData(state.dashboardFilter.year);
            break;
    }

    // 필터 적용
    if (state.dashboardFilter.department) {
        reports = reports.filter(r => r.department === state.dashboardFilter.department);
    }
    if (state.dashboardFilter.employee) {
        reports = reports.filter(r => r.employee_name === state.dashboardFilter.employee);
    }

    state.dashboardData = {
        reports: reports,
        byDepartment: aggregateByDepartment(reports),
        summary: calculateSummary(reports)
    };

    // 주간인 경우 전주 데이터도 로드
    if (state.dashboardFilter.period === 'weekly') {
        const lastWeekReports = await getWeeklyData('last');
        state.dashboardData.comparison = compareEmployees(reports, lastWeekReports);
    }
}

// 대시보드 렌더링
function renderDashboard() {
    // 요약 카드 렌더링
    renderSummaryCards();

    // 부서별 실적 렌더링
    renderDepartmentPerformance();

    // 담당자별 비교 렌더링 (주간만)
    if (state.dashboardFilter.period === 'weekly') {
        renderEmployeeComparison();
    }
}

// 요약 카드 렌더링
function renderSummaryCards() {
    const summary = state.dashboardData.summary;

    elements.summaryCards.innerHTML = `
        <div class="summary-card">
            <div class="card-icon">📊</div>
            <div class="card-title">목표 수금</div>
            <div class="card-value">${formatMoney(summary.targetCollection)}</div>
            <div class="card-rate">${summary.collectionRate}%</div>
        </div>
        <div class="summary-card">
            <div class="card-icon">✅</div>
            <div class="card-title">달성 수금</div>
            <div class="card-value">${formatMoney(summary.actualCollection)}</div>
        </div>
        <div class="summary-card">
            <div class="card-icon">💰</div>
            <div class="card-title">매출 실적</div>
            <div class="card-value">${formatMoney(summary.actualSales)}</div>
        </div>
        <div class="summary-card">
            <div class="card-icon">📈</div>
            <div class="card-title">증감률</div>
            <div class="card-value">${summary.changeRate > 0 ? '+' : ''}${summary.changeRate}%</div>
        </div>
    `;
}

// 부서별 실적 렌더링
function renderDepartmentPerformance() {
    const departments = state.dashboardData.byDepartment;

    const html = departments.map(dept => `
        <div class="department-card">
            <h3>${dept.name} 실적</h3>
            <div class="performance-item">
                <span>목표수금:</span>
                <span>${formatMoney(dept.targetCollection)}</span>
            </div>
            <div class="performance-item">
                <span>실적수금:</span>
                <span>${formatMoney(dept.actualCollection)} (${dept.collectionRate}%)</span>
            </div>
            <div class="performance-item">
                <span>목표매출:</span>
                <span>${formatMoney(dept.targetSales)}</span>
            </div>
            <div class="performance-item">
                <span>실적매출:</span>
                <span>${formatMoney(dept.actualSales)} (${dept.salesRate}%)</span>
            </div>
        </div>
    `).join('');

    elements.departmentPerformance.innerHTML = html;
}

// 담당자별 비교 렌더링
function renderEmployeeComparison() {
    const comparison = state.dashboardData.comparison;

    const html = comparison.map((emp, index) => `
        <tr>
            <td>${emp.name}</td>
            <td>${formatMoney(emp.currentWeek)}</td>
            <td>${formatMoney(emp.lastWeek)}</td>
            <td class="change-${emp.changeType}">
                ${emp.changeRate > 0 ? '+' : ''}${emp.changeRate}%
            </td>
        </tr>
    `).join('');

    elements.employeeComparison.innerHTML = html;
}
```
    if (state.selectedEmployees.size === 0) {
        alert('발표 대상을 선택하세요.');
        return;
    }

    await createSlides();

    elements.presentationContainer.style.display = 'flex';
    state.currentSlideIndex = 0;
    showSlide(0);
    startAutoPlay();
}

// 슬라이드 표시
function showSlide(index) {
    if (index < 0 || index >= state.presentationSlides.length) return;

    state.currentSlideIndex = index;
    const slide = state.presentationSlides[index];

    elements.presentationContent.innerHTML = slide.content;
    elements.currentSlide.textContent = index + 1;
    elements.totalSlides.textContent = state.presentationSlides.length;

    updateProgressBar();
}

// 자동 재생
function startAutoPlay() {
    if (state.autoPlayInterval) {
        clearInterval(state.autoPlayInterval);
    }

    state.autoPlayInterval = setInterval(() => {
        nextSlide();
    }, state.slideTime * 1000);

    state.isPlaying = true;
    elements.togglePlayBtn.querySelector('span').textContent = '⏸';
}

function stopAutoPlay() {
    if (state.autoPlayInterval) {
        clearInterval(state.autoPlayInterval);
        state.autoPlayInterval = null;
    }
    state.isPlaying = false;
    elements.togglePlayBtn.querySelector('span').textContent = '▶';
}

// 슬라이드 네비게이션
function nextSlide() {
    if (state.currentSlideIndex < state.presentationSlides.length - 1) {
        showSlide(state.currentSlideIndex + 1);
    } else {
        // 마지막 슬라이드에서 자동 재생 중지
        stopAutoPlay();
        alert('발표가 종료되었습니다.');
    }
}

function prevSlide() {
    if (state.currentSlideIndex > 0) {
        showSlide(state.currentSlideIndex - 1);
    }
}

// 전체화면
function toggleFullscreen() {
    if (!document.fullscreenElement) {
        elements.presentationContainer.requestFullscreen();
        elements.fullscreenBtn.querySelector('span').textContent = '⛶';
    } else {
        document.exitFullscreen();
        elements.fullscreenBtn.querySelector('span').textContent = '⛶';
    }
}

// 진행 바 업데이트
function updateProgressBar() {
    const progress = ((state.currentSlideIndex + 1) / state.presentationSlides.length) * 100;
    elements.progressBar.style.width = `${progress}%`;
}
```

#### 직원 선택 UI

```javascript
function renderEmployeeGrid() {
    const grid = elements.employeeGrid;

    const salesEmployees = state.employees.filter(emp => emp.role === 'sales');

    if (salesEmployees.length === 0) {
        grid.innerHTML = '<div class="empty-message">영업 직원이 없습니다.</div>';
        return;
    }

    grid.innerHTML = salesEmployees.map(emp => {
        // 통계 계산
        const myCompanies = state.companies.filter(c =>
            c.internal_manager === emp.name && c.business_status !== '불용'
        );
        const myReports = state.reports.filter(r => r.employee_id === emp.id);
        const confirmedReports = myReports.filter(r => r.status === 'confirmed');
        const totalSales = myCompanies.reduce((sum, c) =>
            sum + (c.accumulated_sales || 0), 0
        );

        return `
            <div class="employee-card glass-card glass-3d-element ${state.selectedEmployees.has(emp.id) ? 'selected' : ''}"
                 onclick="toggleEmployeeSelection(${emp.id})">
                <div class="employee-checkbox">
                    <input type="checkbox"
                           ${state.selectedEmployees.has(emp.id) ? 'checked' : ''}
                           onclick="event.stopPropagation();">
                </div>
                <div class="employee-name">${emp.name}</div>
                <div class="employee-stats">
                    <div class="stat-item">
                        <span class="stat-label">거래처</span>
                        <span class="stat-value">${myCompanies.length}개</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">보고서</span>
                        <span class="stat-value">${myReports.length}건</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">확인</span>
                        <span class="stat-value">${confirmedReports.length}건</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">매출</span>
                        <span class="stat-value">${formatCurrency(totalSales)}</span>
                    </div>
                </div>
            </div>
        `;
    }).join('');

    updateSelectedCount();
}

// 직원 선택 토글
window.toggleEmployeeSelection = function(employeeId) {
    if (state.selectedEmployees.has(employeeId)) {
        state.selectedEmployees.delete(employeeId);
    } else {
        state.selectedEmployees.add(employeeId);
    }
    renderEmployeeGrid();
};
```

**핵심 기능**:
- 기간별 필터 (주간: 금주/전주, 월간, 연간)
- 부서별 필터 및 담당자별 필터
- 실시간 요약 카드 (목표수금, 달성수금, 매출실적, 증감률)
- 부서별 실적 발표 (수금/매출 달성률)
- 담당자별 비교 (주간 전주 대비)
- 차트 보기 (막대 그래프, 비교 분석)
- CSV 내보내기 및 인쇄 기능

---

## 5. 공통 디자인 시스템

### 5-1. 글래스모피즘 디자인 (Glassmorphism)

#### 핵심 원칙

**글래스모피즘 효과란?**
- 반투명 배경 (투명도 5-20%)
- 배경 블러 효과 (backdrop-filter: blur)
- 미세한 테두리 (border: 1px solid rgba(white, 0.1-0.2))
- 3D 변환 효과 (transform: translateZ)
- 레이어 깊이감 (z-index 기반 계층)

#### CSS 아키텍처

**스타일시트 로딩 순서** (반드시 이 순서를 지켜야 함):
```html
<!-- 1. 루트 변수 정의 -->
<link rel="stylesheet" href="../../07.styles/00_root.css">

<!-- 2. CSS 변수 정의 -->
<link rel="stylesheet" href="../../07.styles/01_variables.css">

<!-- 3. 공통 스타일 -->
<link rel="stylesheet" href="../../07.styles/02_common.css">

<!-- 4. 글래스모피즘 효과 -->
<link rel="stylesheet" href="../../07.styles/03_glassmorphism.css">

<!-- 5. 테마 색상 -->
<link rel="stylesheet" href="../../07.styles/07_theme_colors.css">

<!-- 6. 컴포넌트 스타일 -->
<link rel="stylesheet" href="../../07.styles/04_components.css">

<!-- 시스템 로더 (자동 적용) -->
<script type="module" src="../../01.common/17_system_loader.js"></script>
<script type="module" src="../../01.common/18_glassmorphism_auto_apply.js"></script>
```

#### 글래스모피즘 CSS 변수

```css
/* 03_glassmorphism.css */

:root {
    /* 글래스 배경 */
    --glass-bg: rgba(255, 255, 255, 0.05);
    --glass-bg-light: rgba(255, 255, 255, 0.08);
    --glass-bg-heavy: rgba(255, 255, 255, 0.12);

    /* 블러 효과 */
    --glass-blur: blur(10px);
    --glass-blur-heavy: blur(20px);

    /* 테두리 */
    --glass-border: rgba(255, 255, 255, 0.1);
    --glass-border-light: rgba(255, 255, 255, 0.15);

    /* 그림자 */
    --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    --glass-shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.2);

    /* 3D 효과 */
    --glass-transform: translateZ(20px);
    --glass-hover-transform: translateZ(40px) rotateX(2deg);
}
```

#### 글래스모피즘 클래스

**1. 기본 카드 (glass-card)**
```css
.glass-card {
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    -webkit-backdrop-filter: var(--glass-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--glass-shadow);
}
```

**2. 3D 요소 (glass-3d-element)**
```css
.glass-3d-element {
    transform-style: preserve-3d;
    transform: var(--glass-transform);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.glass-3d-element:hover {
    transform: var(--glass-hover-transform);
    box-shadow: var(--glass-shadow-heavy);
    border-color: var(--glass-border-light);
}
```

**3. 패널 (glass-panel)**
```css
.glass-panel {
    background: var(--glass-bg-light);
    backdrop-filter: var(--glass-blur-heavy);
    -webkit-backdrop-filter: var(--glass-blur-heavy);
    border: 2px solid var(--glass-border-light);
    border-radius: var(--radius-xl);
    padding: var(--spacing-xl);
}
```

**4. 레이어 (glass-layered)**
```css
.glass-layered {
    position: relative;
    z-index: 1;
}

.glass-layered::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.2) 0%,
        rgba(255, 255, 255, 0.05) 100%);
    border-radius: inherit;
    z-index: -1;
}
```

**5. 반짝임 효과 (glass-shimmer)**
```css
.glass-shimmer {
    position: relative;
    overflow: hidden;
}

.glass-shimmer::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg,
        transparent,
        rgba(255, 255, 255, 0.1),
        transparent);
    animation: shimmer 3s infinite;
}

@keyframes shimmer {
    0%, 100% { left: -100%; }
    50% { left: 100%; }
}
```

**6. 입력 필드 (glass-input)**
```css
.glass-input {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(5px);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    color: var(--text-primary);
    font-size: var(--font-md);
    transition: all 0.3s ease;
}

.glass-input:focus {
    background: rgba(255, 255, 255, 0.08);
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
    outline: none;
}

.glass-input::placeholder {
    color: var(--text-tertiary);
}
```

### 5-2. 레이어 시스템

#### 배경 레이어 클래스

```css
/* 레이어 1 (가장 뒤) */
.bg-layer-1 {
    background: rgba(255, 255, 255, 0.02);
    z-index: 1;
}

/* 레이어 2 */
.bg-layer-2 {
    background: rgba(255, 255, 255, 0.05);
    z-index: 2;
}

/* 레이어 3 (가장 앞) */
.bg-layer-3 {
    background: rgba(255, 255, 255, 0.08);
    z-index: 3;
}
```

#### 텍스트 레이어 클래스

```css
.text-on-layer-1 {
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.text-on-layer-2 {
    color: rgba(255, 255, 255, 0.95);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
}

.text-on-layer-3 {
    color: rgba(255, 255, 255, 1);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}
```

#### 3D 뷰포트

```css
.viewport-3d {
    perspective: 1500px;
    perspective-origin: 50% 50%;
    transform-style: preserve-3d;
}
```

**사용 예시**:
```html
<body class="viewport-3d">
    <header class="bg-layer-1 glass-panel glass-layered glass-shimmer">
        <h1 class="text-on-layer-1">헤더 제목</h1>
    </header>

    <section class="glass-card glass-3d-element">
        <p>컨텐츠</p>
    </section>
</body>
```

### 5-3. 컴포넌트 라이브러리

#### 1. 버튼 (glass-button)

```css
.glass-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md) var(--spacing-xl);
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    color: var(--text-primary);
    font-size: var(--font-md);
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    transform: translateZ(10px);
}

.glass-button:hover:not(:disabled) {
    background: var(--glass-bg-light);
    border-color: var(--glass-border-light);
    transform: translateZ(20px) scale(1.02);
    box-shadow: var(--glass-shadow);
}

.glass-button:active:not(:disabled) {
    transform: translateZ(5px) scale(0.98);
}

.glass-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* 버튼 변형 */
.glass-button.primary {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
}

.glass-button.primary:hover:not(:disabled) {
    background: var(--color-primary-dark);
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
}

.glass-button.secondary {
    background: var(--glass-bg-light);
    color: var(--text-primary);
}

.glass-button.danger {
    background: var(--color-error);
    color: white;
    border-color: var(--color-error);
}
```

**사용 예시**:
```html
<button class="glass-button primary">
    <span class="btn-icon">💾</span>
    <span>저장</span>
</button>

<button class="glass-button secondary">
    <span class="btn-icon">🔄</span>
    <span>새로고침</span>
</button>
```

#### 2. 상태 배지 (status-badge)

```css
.status-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-full);
    font-size: var(--font-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.status-unconfirmed {
    background: rgba(255, 152, 0, 0.1);
    color: var(--color-warning);
    border: 1px solid rgba(255, 152, 0, 0.3);
}

.status-confirmed {
    background: rgba(76, 175, 80, 0.1);
    color: var(--color-success);
    border: 1px solid rgba(76, 175, 80, 0.3);
}

.status-rejected {
    background: rgba(244, 67, 54, 0.1);
    color: var(--color-error);
    border: 1px solid rgba(244, 67, 54, 0.3);
}
```

#### 3. 카드 (summary-card)

```css
.summary-card {
    padding: var(--spacing-xl);
    text-align: center;
    position: relative;
    overflow: hidden;
}

.summary-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg,
        var(--color-primary) 0%,
        var(--color-secondary) 100%);
}

.card-icon {
    font-size: 2.5rem;
    margin-bottom: var(--spacing-md);
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
}

.summary-card h3 {
    font-size: var(--font-sm);
    color: var(--text-secondary);
    margin: 0 0 var(--spacing-md) 0;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.summary-card .count {
    font-size: var(--font-4xl);
    font-weight: 700;
    color: var(--color-primary);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
```

#### 4. 테이블 (data-table)

```css
.data-table {
    width: 100%;
    border-collapse: collapse;
}

.data-table th {
    background: var(--glass-bg-light);
    padding: var(--spacing-md);
    text-align: left;
    font-size: var(--font-sm);
    font-weight: 600;
    color: var(--text-secondary);
    border-bottom: 2px solid var(--glass-border);
    white-space: nowrap;
    position: sticky;
    top: 0;
    z-index: 10;
    backdrop-filter: var(--glass-blur);
}

.data-table td {
    padding: var(--spacing-md);
    font-size: var(--font-sm);
    color: var(--text-primary);
    border-bottom: 1px solid var(--glass-border);
}

.data-table tbody tr {
    transition: all 0.2s ease;
}

.data-table tbody tr:hover {
    background: var(--glass-bg-light);
    transform: translateX(2px);
}

.data-table tbody tr:nth-child(even) {
    background: rgba(255, 255, 255, 0.02);
}
```

#### 5. 모달 (presentation-modal)

```css
.presentation-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.95);
    backdrop-filter: blur(20px);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.presentation-controls {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 60px;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 var(--spacing-xl);
    z-index: 10000;
}

.control-btn {
    width: 44px;
    height: 44px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    color: white;
    font-size: var(--font-xl);
    cursor: pointer;
    transition: all 0.2s ease;
}

.control-btn:hover {
    background: var(--glass-bg-light);
    transform: scale(1.1);
}
```

### 5-4. 반응형 디자인

#### 브레이크포인트

```css
/* 모바일 */
@media (max-width: 768px) {
    .container {
        padding: var(--spacing-md);
    }

    .summary-cards {
        grid-template-columns: repeat(2, 1fr);
    }

    .filter-grid {
        grid-template-columns: 1fr;
    }

    .data-table {
        min-width: 800px; /* 가로 스크롤 활성화 */
    }

    .table-container {
        overflow-x: auto;
    }

    .form-row {
        grid-template-columns: 1fr;
    }

    /* 버튼 풀너비 */
    .glass-button {
        width: 100%;
        justify-content: center;
    }
}

/* 태블릿 */
@media (min-width: 769px) and (max-width: 1024px) {
    .summary-cards {
        grid-template-columns: repeat(2, 1fr);
    }

    .filter-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* 데스크톱 */
@media (min-width: 1025px) {
    .summary-cards {
        grid-template-columns: repeat(4, 1fr);
    }

    .filter-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
}
```

### 5-5. 애니메이션

#### 페이드 인

```css
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.fade-in {
    animation: fadeIn 0.3s ease-out;
}
```

#### 슬라이드 다운

```css
@keyframes slideDown {
    from {
        opacity: 0;
        max-height: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        max-height: 1000px;
        transform: translateY(0);
    }
}

.slide-down {
    animation: slideDown 0.3s ease-out;
}
```

#### 스케일 업

```css
@keyframes scaleUp {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.scale-up {
    animation: scaleUp 0.2s ease-out;
}
```

### 5-6. 색상 시스템

#### 테마 색상

```css
:root {
    /* Primary (Green) */
    --color-primary: #4CAF50;
    --color-primary-light: #66BB6A;
    --color-primary-dark: #43A047;

    /* Secondary (Blue) */
    --color-secondary: #2196F3;
    --color-secondary-light: #42A5F5;
    --color-secondary-dark: #1976D2;

    /* Success */
    --color-success: #4CAF50;
    --color-success-bg: rgba(76, 175, 80, 0.1);

    /* Warning */
    --color-warning: #FF9800;
    --color-warning-bg: rgba(255, 152, 0, 0.1);

    /* Error */
    --color-error: #F44336;
    --color-error-bg: rgba(244, 67, 54, 0.1);

    /* Info */
    --color-info: #2196F3;
    --color-info-bg: rgba(33, 150, 243, 0.1);

    /* Text */
    --text-primary: rgba(255, 255, 255, 0.95);
    --text-secondary: rgba(255, 255, 255, 0.75);
    --text-tertiary: rgba(255, 255, 255, 0.5);

    /* Background */
    --bg-primary: #0A1929;
    --bg-secondary: #132F4C;
}
```

#### 모드별 테마

```css
/* 영업담당모드 (Sales Mode) */
.theme-sales {
    --color-primary: #4CAF50; /* 녹색 */
    --bg-gradient: linear-gradient(135deg, #1E3A8A 0%, #3B82F6 100%);
}

/* 관리자모드 (Admin Mode) */
.theme-admin {
    --color-primary: #F59E0B; /* 주황색 */
    --bg-gradient: linear-gradient(135deg, #7C2D12 0%, #EA580C 100%);
}
```

### 5-7. 타이포그래피

```css
:root {
    /* Font Sizes */
    --font-xs: 0.75rem;      /* 12px */
    --font-sm: 0.875rem;     /* 14px */
    --font-md: 1rem;         /* 16px */
    --font-lg: 1.125rem;     /* 18px */
    --font-xl: 1.25rem;      /* 20px */
    --font-2xl: 1.5rem;      /* 24px */
    --font-3xl: 1.875rem;    /* 30px */
    --font-4xl: 2.25rem;     /* 36px */

    /* Font Weights */
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;

    /* Line Heights */
    --line-height-tight: 1.25;
    --line-height-normal: 1.5;
    --line-height-relaxed: 1.75;
}
```

### 5-8. 간격 시스템 (Spacing)

```css
:root {
    --spacing-xs: 0.25rem;   /* 4px */
    --spacing-sm: 0.5rem;    /* 8px */
    --spacing-md: 1rem;      /* 16px */
    --spacing-lg: 1.5rem;    /* 24px */
    --spacing-xl: 2rem;      /* 32px */
    --spacing-2xl: 3rem;     /* 48px */
    --spacing-3xl: 4rem;     /* 64px */
    --spacing-4xl: 6rem;     /* 96px */
}
```

### 5-9. 모서리 반경 (Border Radius)

```css
:root {
    --radius-sm: 0.25rem;    /* 4px */
    --radius-md: 0.5rem;     /* 8px */
    --radius-lg: 1rem;       /* 16px */
    --radius-xl: 1.5rem;     /* 24px */
    --radius-full: 9999px;   /* 완전한 원형 */
}
```

---

## 6. 단계별 구현 계획

### 6-1. 1단계: Railway MySQL DB 구축 (1주)

**작업 내용**:
- Railway MySQL 데이터베이스 연결 확인
- 기존 테이블(companies, departments, employees)에 필드 추가
- 새 테이블 생성 (reports, company_goals, change_history)
- 트리거 작성 및 등록
- 초기 데이터 입력 (부서 목표, 직원 목표, 회사 목표, 거래처 목표)
- DB 연결 테스트

**검증 기준**:
- 모든 테이블 생성/수정 완료
- 트리거 정상 작동 확인
- 샘플 데이터 조회 성공

### 6-2. 2단계: 백엔드 API 개발 (2주)

**작업 내용**:
- Node.js + Express 서버 구축 (기존 서버 활용)
- API 엔드포인트 개발
  ```
  POST   /api/reports                    # 보고서 작성
  GET    /api/reports                    # 보고서 목록 조회
  GET    /api/reports/:id                # 보고서 상세 조회
  PUT    /api/reports/:id/confirm        # 보고서 확인

  GET    /api/goals/employee/:id/monthly  # 담당자 월간 실적
  GET    /api/goals/employee/:id/annual   # 담당자 연간 실적
  GET    /api/goals/company/:id/monthly   # 거래처 월간 실적
  GET    /api/goals/department/:id/monthly # 부서 월간 실적
  GET    /api/goals/total/monthly         # 전체 월간 실적

  GET    /api/companies                  # 거래처 목록
  GET    /api/employees                  # 직원 목록
  ```
- Railway 배포 및 테스트

**검증 기준**:
- 모든 API 엔드포인트 정상 작동
- Railway 배포 성공
- Postman 테스트 통과

### 6-3. 3단계: 프론트엔드 UI 개발 (3주)

**작업 내용**:
- 영업담당모드
  - 실적보고서 작성 화면 (동적 목표 표시 포함)
  - 실적보고서 확인 화면 (동적 목표 표시 포함)
- 관리자모드
  - 실적보고서 확인 화면 (동적 목표 표시, 슬라이드 패널)
  - 보고서 발표 화면 (서브메뉴 구조, 3개 탭)
- 글래스모피즘 디자인 적용
- Chart.js 차트 구현

**검증 기준**:
- 모든 화면 UI 완성
- 동적 목표 표시 정상 작동
- 반응형 디자인 적용

### 6-4. 4단계: 통합 테스트 및 배포 (1주)

**작업 내용**:
- 전체 기능 통합 테스트
- 버그 수정 및 성능 최적화
- Railway 프로덕션 배포
- 사용자 매뉴얼 작성

**검증 기준**:
- 전체 시나리오 테스트 통과
- 프로덕션 환경 정상 작동
- 매뉴얼 완성

---

## 부록: API 응답 예시

### A. 담당자 월간 실적 API

**요청**:
```
GET /api/goals/employee/1/monthly?year=2025&month=10
```

**응답**:
```json
{
  "employeeId": 1,
  "employeeName": "김영업",
  "year": 2025,
  "month": 10,
  "goals": {
    "monthlyCollectionGoal": 20000000,
    "monthlySalesGoal": 40000000,
    "actualCollection": 18500000,
    "actualSales": 38000000,
    "collectionRate": 92.5,
    "salesRate": 95.0
  },
  "annual": {
    "annualCollectionGoal": 240000000,
    "annualSalesGoal": 480000000,
    "actualCollection": 150000000,
    "actualSales": 350000000,
    "collectionRate": 62.5,
    "salesRate": 72.9
  }
}
```

### B. 거래처 월간 실적 API

**요청**:
```
GET /api/goals/company/1/monthly?year=2025&month=10
```

**응답**:
```json
{
  "companyId": 1,
  "companyName": "A치과",
  "keyValue": "KEY001",
  "year": 2025,
  "month": 10,
  "goals": {
    "monthlyCollectionGoal": 3000000,
    "monthlySalesGoal": 6000000,
    "actualCollection": 2800000,
    "actualSales": 5600000,
    "collectionRate": 93.3,
    "salesRate": 93.3
  },
  "annual": {
    "annualCollectionGoal": 36000000,
    "annualSalesGoal": 72000000,
    "actualCollection": 22000000,
    "actualSales": 45000000,
    "collectionRate": 61.1,
    "salesRate": 62.5
  }
}
```

---

**문서 끝**
