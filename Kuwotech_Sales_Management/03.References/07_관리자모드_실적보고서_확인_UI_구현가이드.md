# 관리자모드 - 실적보고서 확인 UI 구현 가이드

**프로젝트**: KUWOTECH 영업관리시스템
**작성일**: 2025-10-08
**대상 화면**: 관리자모드 - 실적보고서 확인
**목적**: 관리자가 영업담당자의 실적보고서를 확인하고 의견을 작성하는 화면 구현 가이드

---

## 📋 목차

1. [화면 레이아웃 구조](#1-화면-레이아웃-구조)
2. [HTML 구조 설계](#2-html-구조-설계)
3. [CSS 스타일링 가이드](#3-css-스타일링-가이드)
4. [JavaScript 인터랙션](#4-javascript-인터랙션)
5. [컴포넌트별 구현](#5-컴포넌트별-구현)
6. [데이터 흐름](#6-데이터-흐름)
7. [반응형 디자인](#7-반응형-디자인)

---

## 1. 화면 레이아웃 구조

### 1-1. 전체 레이아웃 구성도 (3단 레이아웃)

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│  📋 실적보고서 확인 (관리자)                                                                  │
└─────────────────────────────────────────────────────────────────────────────────────────────┘

┌──────────────────┬──────────────────────────────────────┬──────────────────────────────────┐
│                  │                                      │                                  │
│  [사이드메뉴]     │  [보고서 리스트]                      │  [상세 내용 - 읽기모드]           │
│                  │                                      │                                  │
│   20% 너비       │       40% 너비                        │       40% 너비                   │
│                  │                                      │                                  │
├──────────────────┼──────────────────────────────────────┼──────────────────────────────────┤
│                  │                                      │                                  │
│ 📊 금주 제출현황  │  ▼ 금주 실적보고서 (우선 표시)        │  ┌─────────────────────────────┐ │
│                  │  ┌────────────────────────────────┐  │  │ 📝 보고서 기본 정보          │ │
│ ✅ 제출자 (3명)   │  │ [주간] 강민 - 삼성서울병원       │  │  │ - ID, 작성자, 거래처       │ │
│   • 강민         │  │ 제출: 2025-01-15 | 상태: 미실행 │◀─┼──│ - 제출일, 상태            │ │
│   • 김영업       │  │                                  │  │  └─────────────────────────┘ │
│   • 이사원       │  └────────────────────────────────┘  │                                  │
│                  │                                      │  ┌─────────────────────────────┐ │
│ ❌ 미제출자 (2명) │  ▼ 일부완료 보고서                    │  │ 💰 목표수금금액 (읽기전용)   │ │
│   • 박대리       │  ┌────────────────────────────────┐  │  │ - 목표/실적/미이행         │ │
│   • 최과장       │  │ [주간] 김영업 - 강남세브란스     │  │  └─────────────────────────┘ │
│                  │  │ 제출: 2025-01-14 | 상태: 일부완료│  │                                  │
├──────────────────┤  └────────────────────────────────┘  │  ┌─────────────────────────────┐ │
│                  │                                      │  │ 💵 목표매출액 (읽기전용)     │ │
│ 📌 보고서 상태    │  ▼ 미실행 보고서                      │  │ - 목표/실적/미이행         │ │
│                  │  ┌────────────────────────────────┐  │  └─────────────────────────┘ │
│ ⚠️ 일부완료 (5)   │  │ [주간] 이사원 - 서울대병원       │  │                                  │
│   👈 클릭 가능    │  │ 제출: 2025-01-13 | 상태: 미실행 │  │  ┌─────────────────────────────┐ │
│                  │  └────────────────────────────────┘  │  │ 📝 영업활동 (읽기전용)       │ │
│ ❌ 미실행 (3)     │                                      │  │ - 활동 내용 리스트         │ │
│                  │  (총 3건 표시)                        │  └─────────────────────────┘ │
│ ✅ 완료 (12)      │                                      │                                  │
│                  │                                      │  ┌─────────────────────────────┐ │
│                  │                                      │  │ 📝 관리자 의견              │ │
│                  │                                      │  │ ┌─────────────────────────┐ │ │
│                  │                                      │  │ │                         │ │ │
│                  │                                      │  │ │  의견 작성란 (textarea) │ │ │
│                  │                                      │  │ │                         │ │ │
│                  │                                      │  │ └─────────────────────────┘ │ │
│                  │                                      │  │                             │ │
│                  │                                      │  │  [💾 저장]                  │ │
│                  │                                      │  └─────────────────────────────┘ │
│                  │                                      │                                  │
└──────────────────┴──────────────────────────────────────┴──────────────────────────────────┘
```

### 1-2. 화면 영역 비율

```
전체 레이아웃: flex 3단 구조

┌──────────────────┬──────────────────┬──────────────────┐
│ 사이드메뉴        │ 보고서 리스트     │ 상세 내용         │
│ flex: 0 0 20%    │ flex: 0 0 40%    │ flex: 0 0 40%    │
│ min-width: 240px │ min-width: 400px │ min-width: 400px │
│                  │                  │                  │
│ 스크롤 가능       │ 스크롤 가능       │ 스크롤 가능       │
└──────────────────┴──────────────────┴──────────────────┘
```

---

## 2. HTML 구조 설계

### 2-1. 전체 컨테이너 구조

```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>실적보고서 확인 (관리자) - KUWOTECH</title>
    <!-- 스타일시트 -->
    <link rel="stylesheet" href="../../07.styles/00_root.css">
    <link rel="stylesheet" href="../../07.styles/01_variables.css">
    <link rel="stylesheet" href="../../07.styles/02_common.css">
    <link rel="stylesheet" href="../../07.styles/03_glassmorphism.css">
    <link rel="stylesheet" href="../../07.styles/07_theme_colors.css">
</head>
<body class="theme-admin viewport-3d" data-page-type="admin-report-confirm">

    <!-- 페이지 헤더 -->
    <header class="page-header glass-panel">
        <h1>📋 실적보고서 확인 (관리자)</h1>
        <p class="subtitle">영업담당자가 제출한 실적보고서를 확인하고 의견을 작성합니다</p>
    </header>

    <!-- 메인 컨테이너: 3단 레이아웃 -->
    <div class="main-container">

        <!-- 1. 사이드메뉴 (20%) -->
        <aside class="sidebar" id="sidebar">
            <!-- 금주 제출현황 -->
            <section class="sidebar-section">
                <h3 class="sidebar-title">📊 금주 실적보고서 제출현황</h3>

                <!-- 제출자 -->
                <div class="submitters-section">
                    <h4 class="section-subtitle">✅ 제출자 (<span id="submittersCount">0</span>명)</h4>
                    <ul class="submitters-list" id="submittersList">
                        <!-- JavaScript로 동적 생성 -->
                    </ul>
                </div>

                <!-- 미제출자 -->
                <div class="non-submitters-section">
                    <h4 class="section-subtitle">❌ 미제출자 (<span id="nonSubmittersCount">0</span>명)</h4>
                    <ul class="non-submitters-list" id="nonSubmittersList">
                        <!-- JavaScript로 동적 생성 -->
                    </ul>
                </div>
            </section>

            <!-- 보고서 상태 -->
            <section class="sidebar-section">
                <h3 class="sidebar-title">📌 보고서 상태</h3>
                <ul class="status-filter-list">
                    <li class="status-filter-item" data-status="partial">
                        <button class="status-filter-btn">
                            ⚠️ 일부완료 (<span id="partialCount">0</span>)
                        </button>
                    </li>
                    <li class="status-filter-item" data-status="incomplete">
                        <button class="status-filter-btn">
                            ❌ 미실행 (<span id="incompleteCount">0</span>)
                        </button>
                    </li>
                    <li class="status-filter-item" data-status="complete">
                        <button class="status-filter-btn">
                            ✅ 완료 (<span id="completeCount">0</span>)
                        </button>
                    </li>
                </ul>
            </section>
        </aside>

        <!-- 2. 보고서 리스트 (40%) -->
        <main class="report-list-panel" id="reportListPanel">
            <!-- 금주 보고서 섹션 (우선 표시) -->
            <section class="list-section">
                <h3 class="list-section-title">▼ 금주 실적보고서</h3>
                <div class="report-items-container" id="weeklyReportsContainer">
                    <!-- JavaScript로 동적 생성 -->
                </div>
            </section>

            <!-- 구분선 -->
            <hr class="section-divider">

            <!-- 선택된 상태별 보고서 섹션 -->
            <section class="list-section">
                <h3 class="list-section-title" id="filteredSectionTitle">▼ 일부완료 보고서</h3>
                <div class="report-items-container" id="filteredReportsContainer">
                    <!-- JavaScript로 동적 생성 -->
                </div>
                <p class="list-count" id="filteredReportsCount">(총 0건)</p>
            </section>
        </main>

        <!-- 3. 상세 내용 패널 (40%) - 읽기모드 -->
        <aside class="detail-panel" id="detailPanel">
            <!-- 초기 상태 -->
            <div class="detail-placeholder" id="detailPlaceholder">
                <div class="placeholder-icon">📋</div>
                <p class="placeholder-text">보고서를 선택하면<br>상세 내용이 표시됩니다</p>
            </div>

            <!-- 보고서 상세 내용 (숨김 상태로 시작) -->
            <div class="detail-content" id="detailContent" style="display: none;">

                <!-- 보고서 기본 정보 -->
                <section class="detail-section glass-card">
                    <h3 class="detail-section-title">📝 보고서 기본 정보</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">보고서 ID:</span>
                            <span class="info-value" id="detailReportId">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">작성자:</span>
                            <span class="info-value" id="detailSubmitter">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">거래처:</span>
                            <span class="info-value" id="detailCompany">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">제출일:</span>
                            <span class="info-value" id="detailSubmitDate">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">상태:</span>
                            <span class="info-value status-badge" id="detailStatus">-</span>
                        </div>
                    </div>
                </section>

                <!-- 목표수금금액 (읽기전용) -->
                <section class="detail-section glass-card">
                    <h3 class="detail-section-title">💰 목표수금금액</h3>
                    <div class="readonly-content">
                        <div class="readonly-item">
                            <span class="readonly-label">목표:</span>
                            <span class="readonly-value" id="detailCollectionGoal">-</span>
                        </div>
                        <div class="readonly-item">
                            <span class="readonly-label">실적:</span>
                            <span class="readonly-value" id="detailCollectionActual">-</span>
                        </div>
                        <div class="readonly-item">
                            <span class="readonly-label">미이행:</span>
                            <span class="readonly-value error" id="detailCollectionRemaining">-</span>
                        </div>
                    </div>
                </section>

                <!-- 목표매출액 (읽기전용) -->
                <section class="detail-section glass-card">
                    <h3 class="detail-section-title">💵 목표매출액(<span id="detailSalesProduct">-</span>)</h3>
                    <div class="readonly-content">
                        <div class="readonly-item">
                            <span class="readonly-label">목표:</span>
                            <span class="readonly-value" id="detailSalesGoal">-</span>
                        </div>
                        <div class="readonly-item">
                            <span class="readonly-label">실적:</span>
                            <span class="readonly-value" id="detailSalesActual">-</span>
                        </div>
                        <div class="readonly-item">
                            <span class="readonly-label">미이행:</span>
                            <span class="readonly-value error" id="detailSalesRemaining">-</span>
                        </div>
                    </div>
                </section>

                <!-- 영업활동 (읽기전용) -->
                <section class="detail-section glass-card">
                    <h3 class="detail-section-title">📝 영업활동(특이사항)</h3>
                    <div class="activity-list" id="detailActivityList">
                        <!-- JavaScript로 동적 생성 -->
                    </div>
                </section>

                <!-- 관리자 의견 작성 -->
                <section class="detail-section glass-card">
                    <h3 class="detail-section-title">📝 관리자 의견</h3>
                    <div class="comment-input-area">
                        <textarea
                            class="glass-input comment-textarea"
                            id="adminComment"
                            rows="6"
                            placeholder="관리자 의견을 작성하세요..."></textarea>
                        <div class="comment-actions">
                            <button class="glass-button primary" id="saveCommentBtn">
                                💾 저장
                            </button>
                        </div>
                    </div>
                </section>

            </div>
        </aside>

    </div>

    <!-- JavaScript -->
    <script type="module" src="./02_report_confirm.js"></script>

</body>
</html>
```

### 2-2. 보고서 리스트 아이템 구조

```html
<!-- 보고서 아이템 템플릿 -->
<template id="report-item-template">
    <div class="report-item glass-card" data-report-id="">
        <div class="report-item-header">
            <span class="report-type-badge">[주간]</span>
            <span class="report-submitter">강민</span>
            <span class="report-company">삼성서울병원</span>
        </div>
        <div class="report-item-footer">
            <span class="report-submit-date">제출: 2025-01-15</span>
            <span class="report-status-badge">미실행</span>
        </div>
    </div>
</template>
```

---

## 3. CSS 스타일링 가이드

### 3-1. 전체 레이아웃 스타일

```css
/* 페이지 헤더 */
.page-header {
    position: sticky;
    top: 0;
    z-index: 1000;
    padding: var(--spacing-xl);
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    border-radius: var(--radius-lg);
    margin-bottom: var(--spacing-xl);
}

.page-header h1 {
    margin: 0;
    font-size: var(--font-3xl);
    font-weight: 700;
    color: var(--color-primary);
}

.subtitle {
    margin: var(--spacing-sm) 0 0 0;
    font-size: var(--font-md);
    color: var(--text-secondary);
}

/* 메인 컨테이너: 3단 레이아웃 */
.main-container {
    display: flex;
    gap: var(--spacing-lg);
    height: calc(100vh - 200px);
    padding: 0 var(--spacing-lg);
}

/* 1. 사이드바 (20%) */
.sidebar {
    flex: 0 0 20%;
    min-width: 240px;
    max-width: 300px;
    overflow-y: auto;
    padding: var(--spacing-lg);
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    border-radius: var(--radius-lg);
    border: 1px solid var(--glass-border);
}

/* 2. 보고서 리스트 패널 (40%) */
.report-list-panel {
    flex: 0 0 40%;
    overflow-y: auto;
    padding: var(--spacing-lg);
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    border-radius: var(--radius-lg);
    border: 1px solid var(--glass-border);
}

/* 3. 상세 패널 (40%) */
.detail-panel {
    flex: 0 0 40%;
    overflow-y: auto;
    padding: var(--spacing-lg);
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    border-radius: var(--radius-lg);
    border: 1px solid var(--glass-border);
}
```

### 3-2. 사이드바 스타일

```css
/* 사이드바 섹션 */
.sidebar-section {
    margin-bottom: var(--spacing-xl);
    padding-bottom: var(--spacing-lg);
    border-bottom: 1px solid var(--glass-border);
}

.sidebar-section:last-child {
    border-bottom: none;
}

.sidebar-title {
    font-size: var(--font-lg);
    font-weight: 600;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--text-primary);
}

.section-subtitle {
    font-size: var(--font-sm);
    font-weight: 600;
    margin: var(--spacing-md) 0 var(--spacing-sm) 0;
    color: var(--text-secondary);
}

/* 제출자/미제출자 리스트 */
.submitters-list,
.non-submitters-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.submitters-list li,
.non-submitters-list li {
    padding: var(--spacing-xs) var(--spacing-sm);
    margin-bottom: var(--spacing-xs);
    border-radius: var(--radius-sm);
    font-size: var(--font-sm);
    color: var(--text-primary);
}

.submitters-list li::before {
    content: '• ';
    color: var(--color-success);
    font-weight: 700;
}

.non-submitters-list li::before {
    content: '• ';
    color: var(--color-error);
    font-weight: 700;
}

/* 상태 필터 버튼 */
.status-filter-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.status-filter-item {
    margin-bottom: var(--spacing-sm);
}

.status-filter-btn {
    width: 100%;
    padding: var(--spacing-md);
    text-align: left;
    font-size: var(--font-md);
    font-weight: 600;
    border: 2px solid var(--glass-border);
    border-radius: var(--radius-md);
    background: var(--glass-bg-light);
    color: var(--text-primary);
    cursor: pointer;
    transition: all 0.3s ease;
}

.status-filter-btn:hover {
    background: var(--glass-bg-heavy);
    transform: translateX(4px);
    border-color: var(--color-primary);
}

.status-filter-btn.active {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
}
```

### 3-3. 보고서 리스트 스타일

```css
/* 리스트 섹션 */
.list-section {
    margin-bottom: var(--spacing-xl);
}

.list-section-title {
    font-size: var(--font-lg);
    font-weight: 600;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--text-primary);
}

.section-divider {
    border: none;
    border-top: 2px solid var(--glass-border);
    margin: var(--spacing-xl) 0;
}

/* 보고서 아이템 */
.report-items-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.report-item {
    padding: var(--spacing-md);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.3s ease;
    border: 2px solid transparent;
}

.report-item:hover {
    background: var(--glass-bg-light);
    transform: translateX(4px);
    border-color: var(--color-primary);
}

.report-item.selected {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.1));
    border-color: var(--color-primary);
}

.report-item-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

.report-type-badge {
    padding: var(--spacing-xs) var(--spacing-sm);
    background: rgba(99, 102, 241, 0.15);
    color: #7c3aed;
    border-radius: var(--radius-sm);
    font-size: var(--font-xs);
    font-weight: 600;
}

.report-submitter {
    font-weight: 600;
    color: var(--text-primary);
}

.report-company {
    color: var(--text-secondary);
    font-size: var(--font-sm);
}

.report-item-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: var(--font-xs);
}

.report-submit-date {
    color: var(--text-secondary);
}

.report-status-badge {
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--radius-full);
    font-weight: 600;
    font-size: var(--font-xs);
}

.report-status-badge.incomplete {
    background: var(--color-error-bg);
    color: var(--color-error);
}

.report-status-badge.partial {
    background: var(--color-warning-bg);
    color: var(--color-warning);
}

.report-status-badge.complete {
    background: var(--color-success-bg);
    color: var(--color-success);
}

.list-count {
    margin-top: var(--spacing-md);
    font-size: var(--font-sm);
    color: var(--text-secondary);
    text-align: center;
}
```

### 3-4. 상세 패널 스타일

```css
/* 플레이스홀더 */
.detail-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    text-align: center;
}

.placeholder-icon {
    font-size: 64px;
    margin-bottom: var(--spacing-lg);
    opacity: 0.5;
}

.placeholder-text {
    font-size: var(--font-lg);
    color: var(--text-secondary);
    line-height: 1.6;
}

/* 상세 내용 */
.detail-content {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
}

.detail-section {
    padding: var(--spacing-lg);
    border-radius: var(--radius-md);
}

.detail-section-title {
    font-size: var(--font-lg);
    font-weight: 600;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--text-primary);
    padding-bottom: var(--spacing-sm);
    border-bottom: 2px solid var(--glass-border);
}

/* 정보 그리드 */
.info-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--spacing-md);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: var(--font-xs);
    color: var(--text-secondary);
    font-weight: 600;
    text-transform: uppercase;
}

.info-value {
    font-size: var(--font-md);
    color: var(--text-primary);
    font-weight: 600;
}

/* 읽기전용 콘텐츠 */
.readonly-content {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.readonly-item {
    display: flex;
    justify-content: space-between;
    padding: var(--spacing-sm);
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-sm);
}

.readonly-label {
    font-size: var(--font-sm);
    color: var(--text-secondary);
    font-weight: 600;
}

.readonly-value {
    font-size: var(--font-md);
    color: var(--text-primary);
    font-weight: 700;
}

.readonly-value.error {
    color: var(--color-error);
}

/* 활동 리스트 */
.activity-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.activity-item {
    padding: var(--spacing-md);
    background: rgba(255, 255, 255, 0.05);
    border-left: 4px solid var(--color-primary);
    border-radius: var(--radius-sm);
}

.activity-item p {
    margin: 0;
    font-size: var(--font-sm);
    color: var(--text-primary);
    line-height: 1.6;
}

/* 관리자 의견 입력 */
.comment-input-area {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.comment-textarea {
    width: 100%;
    min-height: 120px;
    padding: var(--spacing-md);
    font-size: var(--font-md);
    line-height: 1.6;
    border-radius: var(--radius-md);
    resize: vertical;
}

.comment-actions {
    display: flex;
    justify-content: flex-end;
}

.glass-button {
    padding: var(--spacing-md) var(--spacing-xl);
    font-size: var(--font-md);
    font-weight: 600;
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.3s ease;
}

.glass-button.primary {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    color: white;
}

.glass-button.primary:hover {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
}
```

---

## 4. JavaScript 인터랙션

### 4-1. 데이터 구조

```javascript
// 보고서 데이터 구조
const reportData = {
    reportId: 'R-2025-0115-001',
    reportType: 'weekly',
    submittedBy: '강민',
    companyName: '삼성서울병원',
    submittedDate: '2025-01-15',
    status: 'incomplete', // 'incomplete', 'partial', 'complete'

    // 목표수금금액
    collection: {
        goal: 5000000,
        actual: 3000000,
        remaining: 2000000,
        currency: 'KRW'
    },

    // 목표매출액
    sales: {
        goal: 10000000,
        actual: 8000000,
        remaining: 2000000,
        currency: 'KRW',
        product: '임플란트'
    },

    // 영업활동
    activities: [
        {
            content: '임플란트 신제품 소개',
            executed: true,
            date: '2025-01-14'
        },
        {
            content: '다음 방문 예정: 1/20',
            executed: false,
            date: '2025-01-15'
        }
    ],

    // 관리자 의견
    adminComment: ''
};
```

### 4-2. 주요 함수 구현

```javascript
// 1. 초기화
async function initAdminReportConfirm() {
    try {
        // 데이터 로드
        await loadReportsData();

        // 사이드바 초기화
        initSidebar();

        // 이벤트 리스너 등록
        attachEventListeners();

        // 금주 보고서 표시
        displayWeeklyReports();

    } catch (error) {
        console.error('초기화 에러:', error);
        showError('데이터를 불러오는 중 오류가 발생했습니다.');
    }
}

// 2. 사이드바 초기화
function initSidebar() {
    // 금주 제출현황 업데이트
    updateSubmissionStatus();

    // 보고서 상태별 카운트 업데이트
    updateStatusCounts();
}

// 3. 금주 제출현황 업데이트
function updateSubmissionStatus() {
    const thisWeek = getCurrentWeekRange();
    const weeklyReports = reports.filter(r =>
        isInWeek(r.submittedDate, thisWeek)
    );

    // 제출자
    const submitters = [...new Set(weeklyReports.map(r => r.submittedBy))];
    document.getElementById('submittersCount').textContent = submitters.length;

    const submittersList = document.getElementById('submittersList');
    submittersList.innerHTML = submitters
        .map(name => `<li>${name}</li>`)
        .join('');

    // 미제출자 (전체 직원 - 제출자)
    const allEmployees = await getEmployees();
    const nonSubmitters = allEmployees.filter(emp =>
        !submitters.includes(emp.name)
    );

    document.getElementById('nonSubmittersCount').textContent = nonSubmitters.length;

    const nonSubmittersList = document.getElementById('nonSubmittersList');
    nonSubmittersList.innerHTML = nonSubmitters
        .map(emp => `<li>${emp.name}</li>`)
        .join('');
}

// 4. 상태별 카운트 업데이트
function updateStatusCounts() {
    const counts = {
        incomplete: reports.filter(r => r.status === 'incomplete').length,
        partial: reports.filter(r => r.status === 'partial').length,
        complete: reports.filter(r => r.status === 'complete').length
    };

    document.getElementById('incompleteCount').textContent = counts.incomplete;
    document.getElementById('partialCount').textContent = counts.partial;
    document.getElementById('completeCount').textContent = counts.complete;
}

// 5. 금주 보고서 표시
function displayWeeklyReports() {
    const thisWeek = getCurrentWeekRange();
    const weeklyReports = reports.filter(r =>
        isInWeek(r.submittedDate, thisWeek)
    );

    const container = document.getElementById('weeklyReportsContainer');
    container.innerHTML = weeklyReports
        .map(report => createReportItemHTML(report))
        .join('');
}

// 6. 상태 필터 클릭 핸들러
function handleStatusFilterClick(status) {
    // 활성 상태 업데이트
    document.querySelectorAll('.status-filter-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');

    // 필터링된 보고서 표시
    displayFilteredReports(status);
}

// 7. 필터링된 보고서 표시
function displayFilteredReports(status) {
    const filteredReports = reports.filter(r => r.status === status);

    // 타이틀 업데이트
    const statusTitles = {
        incomplete: '미실행',
        partial: '일부완료',
        complete: '완료'
    };

    document.getElementById('filteredSectionTitle').textContent =
        `▼ ${statusTitles[status]} 보고서`;

    // 리스트 렌더링
    const container = document.getElementById('filteredReportsContainer');
    container.innerHTML = filteredReports
        .map(report => createReportItemHTML(report))
        .join('');

    // 카운트 업데이트
    document.getElementById('filteredReportsCount').textContent =
        `(총 ${filteredReports.length}건)`;
}

// 8. 보고서 아이템 HTML 생성
function createReportItemHTML(report) {
    const statusClasses = {
        incomplete: 'incomplete',
        partial: 'partial',
        complete: 'complete'
    };

    const statusTexts = {
        incomplete: '미실행',
        partial: '일부완료',
        complete: '완료'
    };

    return `
        <div class="report-item glass-card"
             data-report-id="${report.reportId}"
             onclick="handleReportClick('${report.reportId}')">
            <div class="report-item-header">
                <span class="report-type-badge">[주간]</span>
                <span class="report-submitter">${report.submittedBy}</span>
                <span class="report-company">${report.companyName}</span>
            </div>
            <div class="report-item-footer">
                <span class="report-submit-date">제출: ${report.submittedDate}</span>
                <span class="report-status-badge ${statusClasses[report.status]}">
                    ${statusTexts[report.status]}
                </span>
            </div>
        </div>
    `;
}

// 9. 보고서 클릭 핸들러
function handleReportClick(reportId) {
    // 선택 상태 업데이트
    document.querySelectorAll('.report-item').forEach(item => {
        item.classList.remove('selected');
    });
    event.currentTarget.classList.add('selected');

    // 상세 내용 표시
    displayReportDetail(reportId);
}

// 10. 보고서 상세 내용 표시
function displayReportDetail(reportId) {
    const report = reports.find(r => r.reportId === reportId);

    if (!report) {
        console.error('보고서를 찾을 수 없습니다:', reportId);
        return;
    }

    // 플레이스홀더 숨기기
    document.getElementById('detailPlaceholder').style.display = 'none';

    // 상세 콘텐츠 표시
    const detailContent = document.getElementById('detailContent');
    detailContent.style.display = 'block';

    // 기본 정보
    document.getElementById('detailReportId').textContent = report.reportId;
    document.getElementById('detailSubmitter').textContent = report.submittedBy;
    document.getElementById('detailCompany').textContent = report.companyName;
    document.getElementById('detailSubmitDate').textContent = report.submittedDate;

    const statusBadge = document.getElementById('detailStatus');
    const statusTexts = {
        incomplete: '미실행',
        partial: '일부완료',
        complete: '완료'
    };
    statusBadge.textContent = statusTexts[report.status];
    statusBadge.className = `info-value status-badge ${report.status}`;

    // 목표수금금액
    document.getElementById('detailCollectionGoal').textContent =
        `${report.collection.goal.toLocaleString()} ${report.collection.currency}`;
    document.getElementById('detailCollectionActual').textContent =
        `${report.collection.actual.toLocaleString()} ${report.collection.currency}`;
    document.getElementById('detailCollectionRemaining').textContent =
        `${report.collection.remaining.toLocaleString()} ${report.collection.currency}`;

    // 목표매출액
    document.getElementById('detailSalesProduct').textContent = report.sales.product;
    document.getElementById('detailSalesGoal').textContent =
        `${report.sales.goal.toLocaleString()} ${report.sales.currency}`;
    document.getElementById('detailSalesActual').textContent =
        `${report.sales.actual.toLocaleString()} ${report.sales.currency}`;
    document.getElementById('detailSalesRemaining').textContent =
        `${report.sales.remaining.toLocaleString()} ${report.sales.currency}`;

    // 영업활동
    const activityList = document.getElementById('detailActivityList');
    activityList.innerHTML = report.activities
        .map(activity => `
            <div class="activity-item">
                <p>${activity.content}</p>
            </div>
        `)
        .join('');

    // 관리자 의견 (기존 의견이 있다면 표시)
    document.getElementById('adminComment').value = report.adminComment || '';

    // 현재 선택된 보고서 ID 저장
    currentReportId = reportId;
}

// 11. 관리자 의견 저장
async function saveAdminComment() {
    const comment = document.getElementById('adminComment').value.trim();

    if (!comment) {
        alert('의견을 입력해주세요.');
        return;
    }

    try {
        // API 호출
        const response = await fetch(`/api/reports/${currentReportId}/comment`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                comment: comment,
                commentedBy: currentUser.name,
                commentedDate: new Date().toISOString()
            })
        });

        if (!response.ok) {
            throw new Error('저장 실패');
        }

        alert('의견이 저장되었습니다.');

        // 데이터 새로고침
        await loadReportsData();

    } catch (error) {
        console.error('저장 에러:', error);
        alert('의견 저장 중 오류가 발생했습니다.');
    }
}

// 12. 이벤트 리스너 등록
function attachEventListeners() {
    // 상태 필터 버튼
    document.querySelectorAll('.status-filter-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const status = e.target.closest('.status-filter-item').dataset.status;
            handleStatusFilterClick(status);
        });
    });

    // 관리자 의견 저장 버튼
    document.getElementById('saveCommentBtn').addEventListener('click', saveAdminComment);
}

// 13. 유틸리티 함수
function getCurrentWeekRange() {
    const today = new Date();
    const dayOfWeek = today.getDay();
    const monday = new Date(today);
    monday.setDate(today.getDate() - dayOfWeek + (dayOfWeek === 0 ? -6 : 1));

    const sunday = new Date(monday);
    sunday.setDate(monday.getDate() + 6);

    return { start: monday, end: sunday };
}

function isInWeek(dateString, weekRange) {
    const date = new Date(dateString);
    return date >= weekRange.start && date <= weekRange.end;
}

// 초기화 실행
document.addEventListener('DOMContentLoaded', initAdminReportConfirm);
```

---

## 5. 컴포넌트별 구현

### 5-1. 사이드바 컴포넌트

**기능:**
- 금주 제출현황 표시
- 보고서 상태별 필터링

**구현 요점:**
```javascript
// 동적 데이터 바인딩
function updateSidebar(data) {
    // 제출자 목록
    const submitters = getWeeklySubmitters(data);
    renderList('#submittersList', submitters);

    // 미제출자 목록
    const nonSubmitters = getNonSubmitters(data, submitters);
    renderList('#nonSubmittersList', nonSubmitters);

    // 상태별 카운트
    updateStatusCounts(data);
}
```

### 5-2. 보고서 리스트 컴포넌트

**기능:**
- 금주 보고서 우선 표시
- 상태별 필터링
- 보고서 선택 시 상세 패널 업데이트

**구현 요점:**
```javascript
// 리스트 렌더링
function renderReportList(reports, containerId) {
    const container = document.getElementById(containerId);

    // 금주 보고서는 맨 위에 표시
    const weeklyReports = filterWeeklyReports(reports);
    const otherReports = reports.filter(r => !weeklyReports.includes(r));

    container.innerHTML = [
        ...weeklyReports.map(createReportItemHTML),
        ...otherReports.map(createReportItemHTML)
    ].join('');
}
```

### 5-3. 상세 패널 컴포넌트

**기능:**
- 보고서 내용 읽기전용 표시
- 관리자 의견 작성
- 의견 저장

**구현 요점:**
```javascript
// 읽기전용 데이터 표시
function displayReadOnlyData(report) {
    // 목표수금금액
    displaySection('collection', report.collection);

    // 목표매출액
    displaySection('sales', report.sales);

    // 영업활동
    displayActivities(report.activities);
}

// 관리자 의견 저장
async function saveComment(reportId, comment) {
    const result = await api.saveAdminComment(reportId, {
        comment,
        commentedBy: getCurrentUser(),
        commentedDate: new Date()
    });

    return result;
}
```

---

## 6. 데이터 흐름

### 6-1. 데이터 로드 시퀀스

```
1. 페이지 로드
   ↓
2. API 호출: 전체 보고서 데이터 가져오기
   GET /api/admin/reports
   ↓
3. 사이드바 업데이트
   - 금주 제출현황 계산
   - 상태별 카운트 계산
   ↓
4. 금주 보고서 리스트 표시
   ↓
5. 기본 필터 적용 (일부완료 보고서)
   ↓
6. 사용자 대기
```

### 6-2. 보고서 선택 시퀀스

```
1. 사용자가 리스트에서 보고서 클릭
   ↓
2. 선택 상태 업데이트 (시각적 피드백)
   ↓
3. 상세 패널 데이터 바인딩
   - 기본 정보
   - 목표수금금액
   - 목표매출액
   - 영업활동
   - 기존 관리자 의견 (있는 경우)
   ↓
4. 플레이스홀더 숨김 → 상세 콘텐츠 표시
```

### 6-3. 의견 저장 시퀀스

```
1. 관리자가 의견 입력 후 "저장" 클릭
   ↓
2. 입력 유효성 검증
   ↓
3. API 호출: 의견 저장
   POST /api/admin/reports/{reportId}/comment
   {
     comment: "...",
     commentedBy: "관리자명",
     commentedDate: "2025-01-15T10:30:00"
   }
   ↓
4. 성공 시: 알림 + 데이터 새로고침
   실패 시: 에러 메시지 표시
```

### 6-4. API 엔드포인트

```javascript
// 1. 전체 보고서 조회
GET /api/admin/reports
Response: {
    success: true,
    data: [
        {
            reportId: 'R-2025-0115-001',
            reportType: 'weekly',
            submittedBy: '강민',
            companyName: '삼성서울병원',
            submittedDate: '2025-01-15',
            status: 'incomplete',
            collection: {...},
            sales: {...},
            activities: [...],
            adminComment: '...'
        },
        ...
    ]
}

// 2. 관리자 의견 저장
POST /api/admin/reports/{reportId}/comment
Request: {
    comment: '의견 내용',
    commentedBy: '관리자명',
    commentedDate: '2025-01-15T10:30:00'
}
Response: {
    success: true,
    message: '의견이 저장되었습니다.'
}

// 3. 직원 목록 조회 (미제출자 확인용)
GET /api/employees
Response: {
    success: true,
    data: [
        { id: 1, name: '강민', department: '영업1팀' },
        { id: 2, name: '김영업', department: '영업1팀' },
        ...
    ]
}
```

---

## 7. 반응형 디자인

### 7-1. 브레이크포인트

```css
/* 데스크탑: 1200px 이상 (기본) */
.main-container {
    display: flex;
    gap: var(--spacing-lg);
}

.sidebar { flex: 0 0 20%; }
.report-list-panel { flex: 0 0 40%; }
.detail-panel { flex: 0 0 40%; }

/* 태블릿: 768px ~ 1199px */
@media (max-width: 1199px) {
    .main-container {
        flex-direction: column;
    }

    .sidebar,
    .report-list-panel,
    .detail-panel {
        flex: 1 1 auto;
        width: 100%;
        min-width: unset;
    }

    /* 사이드바를 접을 수 있도록 */
    .sidebar {
        max-height: 300px;
        overflow-y: auto;
    }
}

/* 모바일: 767px 이하 */
@media (max-width: 767px) {
    .page-header {
        padding: var(--spacing-md);
    }

    .page-header h1 {
        font-size: var(--font-2xl);
    }

    .info-grid {
        grid-template-columns: 1fr;
    }

    .comment-textarea {
        font-size: var(--font-sm);
    }
}
```

### 7-2. 터치 최적화

```css
/* 터치 타겟 크기 확대 */
@media (hover: none) and (pointer: coarse) {
    .report-item {
        min-height: 60px;
        padding: var(--spacing-lg);
    }

    .status-filter-btn {
        min-height: 48px;
    }

    .glass-button {
        min-height: 44px;
        padding: var(--spacing-md) var(--spacing-xl);
    }
}
```

---

## 8. 접근성 (a11y)

### 8-1. 키보드 네비게이션

```javascript
// 보고서 리스트 키보드 네비게이션
document.addEventListener('keydown', (e) => {
    if (e.target.classList.contains('report-item')) {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            e.target.click();
        }
    }
});
```

### 8-2. ARIA 속성

```html
<!-- 사이드바 -->
<aside class="sidebar"
       role="complementary"
       aria-label="보고서 필터 및 현황">
    <!-- 내용 -->
</aside>

<!-- 리스트 -->
<main class="report-list-panel"
      role="main"
      aria-label="보고서 목록">
    <!-- 내용 -->
</main>

<!-- 상세 패널 -->
<aside class="detail-panel"
       role="complementary"
       aria-label="보고서 상세 내용">
    <!-- 내용 -->
</aside>

<!-- 보고서 아이템 -->
<div class="report-item"
     role="button"
     tabindex="0"
     aria-pressed="false"
     aria-label="강민님의 삼성서울병원 주간보고서, 상태: 미실행">
    <!-- 내용 -->
</div>
```

### 8-3. 포커스 관리

```css
/* 포커스 표시 */
.report-item:focus,
.status-filter-btn:focus,
.glass-button:focus {
    outline: 3px solid var(--color-primary);
    outline-offset: 2px;
}

/* 포커스 시각적 피드백 */
.report-item:focus-visible {
    box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.3);
}
```

---

## 9. 성능 최적화

### 9-1. 가상 스크롤링

```javascript
// 대량 데이터 처리 시 가상 스크롤링 적용
class VirtualScroller {
    constructor(container, items, renderItem) {
        this.container = container;
        this.items = items;
        this.renderItem = renderItem;
        this.visibleRange = { start: 0, end: 20 };

        this.init();
    }

    init() {
        this.container.addEventListener('scroll', this.handleScroll.bind(this));
        this.render();
    }

    handleScroll() {
        const scrollTop = this.container.scrollTop;
        const itemHeight = 80; // 평균 아이템 높이

        const start = Math.floor(scrollTop / itemHeight);
        const end = start + 20;

        if (start !== this.visibleRange.start || end !== this.visibleRange.end) {
            this.visibleRange = { start, end };
            this.render();
        }
    }

    render() {
        const { start, end } = this.visibleRange;
        const visibleItems = this.items.slice(start, end);

        this.container.innerHTML = visibleItems
            .map(item => this.renderItem(item))
            .join('');
    }
}
```

### 9-2. 디바운싱

```javascript
// 검색 입력 디바운싱
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// 사용 예
const searchInput = document.getElementById('searchInput');
searchInput.addEventListener('input', debounce((e) => {
    filterReports(e.target.value);
}, 300));
```

---

## 10. 테스트 시나리오

### 10-1. 기능 테스트

```
1. 사이드바 제출현황
   - [ ] 금주 제출자 목록 정확히 표시
   - [ ] 미제출자 목록 정확히 표시
   - [ ] 카운트 숫자 일치

2. 상태 필터
   - [ ] 일부완료 클릭 → 일부완료 보고서만 표시
   - [ ] 미실행 클릭 → 미실행 보고서만 표시
   - [ ] 완료 클릭 → 완료 보고서만 표시

3. 보고서 리스트
   - [ ] 금주 보고서가 맨 위에 표시
   - [ ] 리스트 아이템 클릭 → 상세 패널 업데이트
   - [ ] 선택된 아이템 시각적 표시

4. 상세 패널
   - [ ] 보고서 정보 정확히 표시
   - [ ] 읽기전용 데이터 올바르게 표시
   - [ ] 관리자 의견 입력 및 저장
   - [ ] 저장 후 데이터 새로고침

5. 반응형
   - [ ] 태블릿에서 레이아웃 정상 작동
   - [ ] 모바일에서 레이아웃 정상 작동
```

### 10-2. 접근성 테스트

```
- [ ] 키보드만으로 모든 기능 사용 가능
- [ ] 스크린 리더로 내용 읽기 가능
- [ ] 포커스 표시 명확
- [ ] ARIA 레이블 적절
```

---

## 11. 참고사항

### 11-1. 주요 기능 요약

| 기능 | 설명 |
|------|------|
| **금주 제출현황** | 이번 주에 보고서를 제출한 직원과 미제출 직원 목록 표시 |
| **상태 필터링** | 일부완료/미실행/완료 상태별로 보고서 필터링 |
| **금주 우선 표시** | 금주 보고서는 리스트 최상단에 별도 표시 |
| **읽기전용 표시** | 영업담당자가 작성/확인한 내용을 변경 불가능하게 표시 |
| **관리자 의견** | 각 보고서에 대한 관리자 의견 작성 및 저장 |

### 11-2. 데이터 흐름 요약

```
영업담당자 보고서 작성/확인
    ↓
reports 테이블에 저장
    ↓
관리자모드에서 조회
    ↓
상태별 필터링
    ↓
보고서 선택 → 상세 내용 표시
    ↓
관리자 의견 작성
    ↓
reports.adminComment 필드 업데이트
```

### 11-3. 추가 고려사항

1. **검색 기능 추가 가능**
   - 거래처명, 작성자명으로 검색
   - 날짜 범위 필터

2. **엑셀 다운로드**
   - 필터링된 보고서 목록 엑셀 다운로드

3. **알림 기능**
   - 미확인 보고서 알림
   - 의견 작성 후 영업담당자에게 알림

4. **통계 대시보드**
   - 주간/월간 제출률 통계
   - 상태별 분포 차트

---

**문서 버전**: 1.0
**최종 수정일**: 2025-10-08
**작성자**: Claude Code
