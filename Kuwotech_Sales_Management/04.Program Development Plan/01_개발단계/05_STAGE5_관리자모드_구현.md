# STAGE 5: 관리자모드 구현 👨‍💼

> **단계**: STAGE 5  
> **작성일**: 2025-09-27  
> **작성자**: Daniel.K  
> **목표**: 관리자용 7개 메뉴 시스템 구현 (보라색 테마)  
> **예상 소요**: 3일

---

## 📋 목차

1. [개요](#1-개요)
2. [폴더 구조](#2-폴더-구조)
3. [공통 레이아웃](#3-공통-레이아웃)
4. [대시보드](#4-대시보드)
5. [전체거래처 관리](#5-전체거래처-관리)
6. [실적보고서 확인](#6-실적보고서-확인)
7. [보고서 발표](#7-보고서-발표)
8. [데이터 관리](#8-데이터-관리)
9. [직원 관리](#9-직원-관리)
10. [시스템 설정](#10-시스템-설정)
11. [테스트 계획](#11-테스트-계획)

---

## 1. 개요

### 1.1 관리자모드 특징

#### 권한 범위
- ✅ **전체 거래처 조회/수정**
- ✅ **모든 보고서 확인/승인**
- ✅ **엑셀 업로드** (강정환만)
- ✅ **직원 관리**
- ✅ **전사 통계 조회**

#### 테마 색상 (보라색)
```css
--primary-color: #8b5cf6;      /* 메인 보라 */
--primary-hover: #7c3aed;      /* 호버 보라 */
--primary-active: #6d28d9;     /* 클릭 보라 */
--accent-color: #a78bfa;       /* 강조 보라 */
--accent-light: #c4b5fd;       /* 밝은 보라 */
```

### 1.2 메뉴 구조 (7개)

```
관리자모드
├── 1. 대시보드 (KPI 11개 + 기여도 모달)
├── 2. 전체거래처 관리
├── 3. 실적보고서 확인 (승인 기능)
├── 4. 보고서 발표
├── 5. 데이터 관리 (엑셀 업로드/다운로드)
├── 6. 직원 관리
└── 7. 시스템 설정
```

### 1.3 KPI 구성 (11개 + 기여도 2개)

| KPI | 설명 | 계산식 |
|-----|------|--------|
| **전체거래처** | 불용 제외 전체 | COUNT(전체) - 불용 |
| **활성거래처** | 활성 + 매출발생 | 활성 + 매출발생 |
| **활성화율** | 활성/전체 비율 | (활성/전체) × 100 |
| **주요제품판매거래처** | 3단계 우선순위 | COUNT(주요제품) |
| **회사배정기준대비 달성율** | 기준: 80개 × 인원 | 실제/목표 × 100 |
| **주요고객처목표달성율** | 목표: 40개 × 인원 | 실제/목표 × 100 |
| **누적매출금액** | 전사 합계 | SUM(매출) |
| **주요제품매출액** | 3개 제품 | SUM(주요매출) |
| **주요제품매출비율** | 주요/전체 비율 | (주요/전체) × 100 |
| **매출집중도** | 거래처당/월 평균 | 매출/거래처/월 |
| **누적수금금액** | 전사 합계 | SUM(수금) |
| **전체매출기여도** | 영업사원별 순위 | 모달 팝업 |
| **주요제품매출기여도** | 영업사원별 순위 | 모달 팝업 |

---

## 2. 폴더 구조

### 파일 위치: `05.Source/04.admin_mode/`

```
04.admin_mode/
├── 00_common/
│   ├── 01_admin_layout.html     # 레이아웃
│   ├── 02_admin_layout.js       # 레이아웃 로직
│   └── 03_admin_theme.css       # 보라색 테마
│
├── 01_dashboard/
│   ├── 01_dashboard.html        # 대시보드
│   └── 02_dashboard.js          # KPI 계산
│
├── 02_all_companies/
│   ├── 01_all_companies.html    # 전체거래처
│   └── 02_all_companies.js      # CRUD
│
├── 03_report_confirm/
│   ├── 01_report_confirm.html   # 보고서 확인
│   └── 02_report_confirm.js     # 승인 로직
│
├── 04_presentation/
│   ├── 01_presentation.html     # 발표
│   └── 02_presentation.js       # 슬라이드
│
├── 05_data_management/
│   ├── 01_data_management.html  # 데이터 관리
│   └── 02_data_management.js    # 업로드/다운
│
├── 06_employee_management/
│   ├── 01_employees.html        # 직원 관리
│   └── 02_employees.js          # 직원 CRUD
│
├── 07_system_settings/
│   ├── 01_settings.html         # 설정
│   └── 02_settings.js           # 설정 로직
│
└── admin_main.html              # 진입점
```

---

## 3. 공통 레이아웃

### 구체적 내용:

#### 3.1 레이아웃 구조
- **헤더**: 로고 + 시계 + 사용자명 + 로그아웃
- **사이드바**: 7개 메뉴 (보라색 그라데이션)
- **콘텐츠**: 동적 로드 영역
- **보라색 테마**: 전체 통일

#### 3.2 주요 기능
- 사용자 인증 확인 (admin only)
- 메뉴 클릭 시 페이지 동적 로드
- 활성 메뉴 표시
- 실시간 시계

### 디자인 규칙:
- 보라색 테마 (#8b5cf6)
- 헤더: 보라색 그라데이션
- 사이드바: 보라색 활성 표시
- #디자인 #보라색테마

### 코드 연결성 규칙:
- `admin_layout.js`가 메뉴 라우팅 제어
- 각 메뉴별 HTML/JS 동적 로드
- #코드 #라우팅

### 내용:
- 테스트 흐름: 로그인 → 관리자 확인 → 메뉴 네비게이션
- 디버깅: 콘솔로 페이지 로드 확인
- #내용 #테스트

### 테스트 계획:
- 권한 확인 (admin only)
- 7개 메뉴 로드 테스트
- #테스트

---

## 4. 대시보드

### 구체적 내용:

#### 4.1 KPI 배치 (3×4 그리드 + 1)
```
[전체거래처] [활성거래처] [활성화율]
[주요제품판매] [회사배정달성] [주요고객달성]
[누적매출] [주요제품매출] [주요제품비율]
[매출집중도] [누적수금] [기여도 모달 2개]
```

#### 4.2 기여도 모달
- **전체매출 기여도**: 영업사원별 순위
- **주요제품매출 기여도**: 영업사원별 순위
- 클릭 시 모달 팝업

### 디자인 규칙:
- KPI 카드: 보라색 테두리
- 호버: 보라색 그림자
- 기여도: 클릭 가능 표시
- #디자인 #KPI

### 코드 연결성 규칙:
- `calculateAdminKPI()` 전사 KPI 계산
- `calculateContributionRanking()` 기여도 계산
- #코드 #KPI계산

### 내용:
- 테스트 흐름: 전사 데이터 로드 → KPI 계산 → 표시
- 디버깅: 5분마다 자동 갱신
- #내용 #대시보드

### 테스트 계획:
- 11개 KPI 정확도 검증
- 기여도 모달 동작 확인
- #테스트

---

## 5. 전체거래처 관리

### 구체적 내용:

#### 5.1 기능
- **전체 거래처 조회** (모든 담당자)
- **필터**: 담당자/상태/검색
- **페이지네이션**: 50개씩
- **엑셀 다운로드**
- **CRUD**: 추가/수정/삭제

#### 5.2 권한
- 모든 거래처 접근 가능
- 담당자 변경 가능

### 디자인 규칙:
- 테이블: 보라색 헤더
- 버튼: 보라색 그라데이션
- #디자인 #테이블

### 코드 연결성 규칙:
- `CompanyCRUD` 전체 접근
- 페이지네이션 처리
- #코드 #CRUD

### 내용:
- 테스트 흐름: 전체 조회 → 필터 → 수정 → 엑셀
- 디버깅: 대용량 데이터 페이징
- #내용 #거래처

### 테스트 계획:
- 1000개 이상 데이터 테스트
- 필터/검색 정확도
- #테스트

---

## 6. 실적보고서 확인

### 구체적 내용:

#### 6.1 보고서 확인 프로세스
1. **목표수금 확인** → 최종수금 입력 → 잔액 자동계산
2. **판매제품 확인** → 거래처 정보 자동 반영
3. **영업활동 확인** → 완료/실행필요 선택
   - 실행필요 시: 15자 이상 추가내용 필수

#### 6.2 자동 업데이트 (6개 컬럼)
- 최종수금금액
- 매출채권잔액
- 실행필요(Y/N)
- 추가내용
- 확인자명
- 확인일시

### 디자인 규칙:
- 대기중: 노란색 배지
- 확인완료: 초록색 배지
- #디자인 #상태표시

### 코드 연결성 규칙:
- `reportCrud.confirm()` 승인 처리
- 6개 컬럼 자동 업데이트
- #코드 #승인

### 내용:
- 테스트 흐름: 보고서 조회 → 3단계 확인 → 승인
- 디버깅: 15자 검증
- #내용 #보고서

### 테스트 계획:
- 승인 후 자동 업데이트 확인
- 15자 미만 차단 테스트
- #테스트

---

## 7. 보고서 발표

### 구체적 내용:

#### 7.1 발표 모드 (3가지)
- **전체 보고서**: 슬라이드 형식
- **영업사원별**: 담당자별 그룹
- **기간별**: 월별/분기별

#### 7.2 프레젠테이션
- 전체화면 모드
- 키보드 네비게이션 (좌/우 화살표)

### 디자인 규칙:
- 프레젠테이션 모드
- 큰 폰트/차트
- #디자인 #발표

### 코드 연결성 규칙:
- 확인 완료 보고서만 표시
- 슬라이드 생성
- #코드 #프레젠테이션

### 내용:
- 테스트 흐름: 모드 선택 → 슬라이드 생성 → 발표
- 디버깅: 전체화면 테스트
- #내용 #발표

### 테스트 계획:
- 3가지 모드 테스트
- 키보드 네비게이션
- #테스트

---

## 8. 데이터 관리

### 구체적 내용:

#### 8.1 엑셀 업로드 (⚠️ 강정환만)
- 경고 메시지 표시
- 기존 데이터 삭제 확인
- 백업 권장

#### 8.2 다운로드
- 전체 데이터 엑셀 다운로드
- 거래처/보고서/이력 포함

#### 8.3 백업 관리
- 수동 백업 생성
- 백업 목록 조회
- 백업 복원

### 디자인 규칙:
- 업로드: 빨간색 경고
- 백업: 초록색 성공
- #디자인 #경고

### 코드 연결성 규칙:
- `syncExcelToDb()` 업로드
- `createBackup()` 백업
- #코드 #백업

### 내용:
- 테스트 흐름: 백업 → 업로드 → 복원
- 디버깅: 권한 확인 (강정환)
- #내용 #데이터

### 테스트 계획:
- 권한 차단 테스트
- 백업/복원 무결성
- #테스트

---

## 9. 직원 관리

### 구체적 내용:

#### 9.1 직원 목록
- 이름/역할/입사일
- 담당거래처 수
- 누적매출 표시

#### 9.2 직원 관리
- 신규 직원 추가
- 역할 변경 (영업/관리자)
- 비활성화 (삭제 대신)

### 디자인 규칙:
- 역할별 색상 구분
- 관리자: 보라색
- 영업: 파란색
- #디자인 #직원

### 코드 연결성 규칙:
- 직원 CRUD
- 권한 관리
- #코드 #직원

### 내용:
- 테스트 흐름: 직원 추가 → 역할 변경 → 통계 확인
- 디버깅: 권한 연동
- #내용 #직원

### 테스트 계획:
- 직원 추가/수정
- 역할별 권한 확인
- #테스트

---

## 10. 시스템 설정

### 구체적 내용:

#### 10.1 설정 탭 (3개)
- **프로필**: 개인정보 수정
- **시스템**: 환경설정
- **알림**: 알림 설정

#### 10.2 주요 설정
- 비밀번호 변경
- 테마 선택 (다크/라이트)
- 알림 on/off

### 디자인 규칙:
- 탭 네비게이션
- 폼 입력 UI
- #디자인 #설정

### 코드 연결성 규칙:
- localStorage 설정 저장
- 실시간 적용
- #코드 #설정

### 내용:
- 테스트 흐름: 설정 변경 → 저장 → 적용 확인
- 디버깅: localStorage
- #내용 #설정

### 테스트 계획:
- 설정 저장/불러오기
- 테마 전환 테스트
- #테스트

---

## 11. 테스트 계획

### 11.1 단위 테스트

```javascript
// 관리자 권한 테스트
test('관리자 권한 확인', () => {
  const user = { role: 'admin', name: '강정환' };
  expect(checkAdminAccess(user)).toBe(true);
});

// KPI 계산 테스트
test('전사 KPI 계산', async () => {
  const kpi = await calculateAdminKPI();
  expect(kpi.totalCompanies).toBeGreaterThan(0);
});
```

### 11.2 통합 테스트

| 테스트 항목 | 예상 결과 | 상태 |
|------------|----------|------|
| 관리자 로그인 | admin 모드 진입 | ⏳ |
| 전체 거래처 조회 | 모든 담당자 데이터 | ⏳ |
| 보고서 승인 | 6개 컬럼 업데이트 | ⏳ |
| 엑셀 업로드 | 강정환만 가능 | ⏳ |
| 기여도 모달 | 순위 표시 | ⏳ |

### 11.3 성능 테스트

- 목표: 1000개 거래처 3초 이내 로드
- 페이지네이션: 50개씩 표시
- KPI 계산: 1초 이내

---

## 📊 진행 상황

### 완료된 작업 ✅
- [x] 폴더 구조 설계
- [x] 보라색 테마 정의
- [x] 메뉴 구조 확정
- [x] KPI 정의 (11개 + 2개)
- [x] 권한 체계 설계

### 진행 중 🔄
- [ ] 공통 레이아웃 구현
- [ ] 대시보드 구현
- [ ] 전체거래처 관리 구현
- [ ] 보고서 확인/승인 구현
- [ ] 보고서 발표 구현
- [ ] 데이터 관리 구현
- [ ] 직원 관리 구현
- [ ] 시스템 설정 구현

### 미진행 ⏳
- [ ] 통합 테스트
- [ ] 성능 최적화
- [ ] 배포 준비

---

## ✅ STAGE 5 완료 조건

### 기능 구현
- [ ] 7개 메뉴 모두 구현
- [ ] 보라색 테마 적용
- [ ] 전체 데이터 접근 확인
- [ ] 보고서 승인 프로세스
- [ ] 엑셀 업로드 권한 (강정환)

### 테스트 통과
- [ ] 단위 테스트 100%
- [ ] 통합 테스트 완료
- [ ] 성능 목표 달성

### 품질 확인
- [ ] 기존 UI와 100% 일치
- [ ] 가독성 확보 (WCAG AA)
- [ ] 크로스 브라우저 호환

---

## 📝 참고사항

### 색상 대비율 (보라색 테마)
| 배경 | 텍스트 | 대비율 | WCAG |
|------|--------|--------|------|
| #000000 | #8b5cf6 | 7.8:1 | AAA |
| #1a1a1a | #8b5cf6 | 7.1:1 | AAA |
| #8b5cf6 | #ffffff | 3.5:1 | AA |

### 영업담당모드와 차별화
| 구분 | 영업담당 | 관리자 |
|------|---------|---------|
| **테마색** | 파란색 (#2563eb) | 보라색 (#8b5cf6) |
| **메뉴 수** | 6개 | 7개 |
| **데이터 범위** | 본인 담당 | 전체 |
| **권한** | 제한적 | 전체 |

---

## 🚀 다음 단계

### STAGE 6: KPI 엔진 구현
- 영업담당 KPI (14개)
- 관리자 KPI (11개)
- 실시간 계산 최적화

---

## 📞 문의사항

**개발자**: Daniel.K  
**이메일**: kinggo0807@hotmail.com  
**소유자**: Kang Jung Hwan  
**작성일**: 2025-09-27

---

**✅ STAGE 5 계획서 작성 완료**

이제 실제 프로그램을 작성하겠습니다.

#관리자모드 #보라색테마 #전체권한